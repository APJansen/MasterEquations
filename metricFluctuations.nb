(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    236964,       5933]
NotebookOptionsPosition[    225798,       5712]
NotebookOutlinePosition[    226200,       5728]
CellTagsIndexPosition[    226157,       5725]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Spherical perturbations", "Title",
 CellChangeTimes->{{3.728648565224827*^9, 
  3.728648568625393*^9}},ExpressionUUID->"e5813202-3d5a-41ae-a402-\
5ba051bea5f8"],

Cell[CellGroupData[{

Cell[TextData[StyleBox[" 2  RG&TC-Code",
 FontWeight->"Bold"]], "Section",
 FontSize->24,
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"16b7694d-4b10-4f4f-a984-10933a13e5e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TrigRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x_.", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]_", "]"}], "2"]}], "+", 
       RowBox[{"x_.", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]_", "]"}], "2"]}]}], "->", "x"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x_.", 
        SuperscriptBox[
         RowBox[{"Cot", "[", "\[Theta]_", "]"}], "2"]}], "+", 
       RowBox[{"y_.", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "\[Theta]_", "]"}], "2"]}]}], ":>", 
      RowBox[{"y", "/;", 
       RowBox[{
        RowBox[{"x", "+", "y"}], "===", "0"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FaSi", ",", 
    RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
  RowBox[{
   RowBox[{"FaSi", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"FaSi", "[", "x_SeriesData", "]"}], ":=", 
   RowBox[{"x", "/.", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "->", 
     RowBox[{"FaSi", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}]}], ";", 
  RowBox[{
   RowBox[{"FaSi", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Factor", "[", 
     RowBox[{"x", "/.", "simpRules"}], "]"}], "/.", "simpRules"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FacSimp", ",", 
    RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
  RowBox[{
   RowBox[{"FacSimp", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"FacSimp", "[", "x_Equal", "]"}], ":=", 
   RowBox[{"Equal", "[", 
    RowBox[{
     RowBox[{"FacSimp", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FacSimp", "[", "x_Rule", "]"}], ":=", 
   RowBox[{"Rule", "[", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"FacSimp", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"FacSimp", "[", "x_SeriesData", "]"}], ":=", 
   RowBox[{"x", "/.", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "->", 
     RowBox[{"FacSimp", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FacSimp", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coll", "[", "x", "]"}], "/.", "simpRules"}], ",", 
        "FormVars", ",", "Factor"}], "]"}], "/.", "simpRules"}], ")"}], "/;", 
    
    RowBox[{
     RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FacSimp", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Factor", "[", 
     RowBox[{"x", "/.", "simpRules"}], "]"}], "/.", "simpRules"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zeroQ", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Normal", "[", "x", "]"}]}], "}"}], "]"}], "]"}], "===", 
    RowBox[{"{", "0", "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonZeroL", "[", "x_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Normal", "[", "x", "]"}], "}"}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"nonZeroN", "[", "x_", "]"}], ":=", 
  RowBox[{"Length", "[", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Normal", "[", "x", "]"}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"indepTerms", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"opt_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"redPlus", "[", 
    RowBox[{"redTimes", "[", 
     RowBox[{
      RowBox[{"nonZeroL", "[", "x", "]"}], ",", "opt"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"redTimes", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"opt_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tmp$", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#1", "]"}], " ", "===", " ", "Times"}], " ", 
          "&"}]}], "]"}]}], ",", " ", "rst$"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"rst$", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{"x", ",", " ", "tmp$"}], "]"}]}], ";", " ", 
     RowBox[{"Union", "[", 
      RowBox[{"rst$", ",", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"numb2", "[", 
           RowBox[{"#", ",", "opt"}], "]"}], "&"}], ",", "tmp$"}], "]"}]}], 
      "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"numb1", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"opt_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"1", "/;", 
    RowBox[{"NumericQ", "[", "x", "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"numb1", "[", 
    RowBox[{
     RowBox[{"x_", "^", "y_."}], ",", 
     RowBox[{"opt_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"1", "/;", 
    RowBox[{"MemberQ", "[", 
     RowBox[{"opt", ",", "x"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"numb1", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"opt_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", "x"}], ";", 
  RowBox[{
   RowBox[{"numb2", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"opt_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Times", "@@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"numb1", "[", 
        RowBox[{"#", ",", "opt"}], "]"}], "&"}], ",", 
      RowBox[{"Level", "[", 
       RowBox[{"x", ",", "1"}], "]"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"redPlus", "[", "x_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tmp$", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "#", "]"}], "===", "Plus"}], "&"}]}], 
         "]"}]}], ",", "rst$", ",", "i$", ",", "negi$"}], "}"}], ",", 
     RowBox[{
      RowBox[{"rst$", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"x", ",", "tmp$"}], "]"}]}], ";", 
      RowBox[{"i$", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i$", "<", 
         RowBox[{"Length", "[", "tmp$", "]"}]}], ",", 
        RowBox[{
         RowBox[{"negi$", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"tmp$", ",", 
            RowBox[{
             RowBox[{"#", "===", 
              RowBox[{"-", 
               RowBox[{"tmp$", "[", 
                RowBox[{"[", "i$", "]"}], "]"}]}]}], "&"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"negi$", "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"tmp$", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{"tmp$", ",", "negi$"}], "]"}]}]}], "]"}], ";", 
         RowBox[{"i$", "=", 
          RowBox[{"i$", "+", "1"}]}]}]}], "]"}], ";", 
      RowBox[{"Union", "[", 
       RowBox[{"tmp$", ",", "rst$"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemSym", "[", "h_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"a_", ",", "a_", ",", "c_", ",", "d_"}], "]"}], "=", "0"}], 
     ";", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "c_"}], "]"}], "=", "0"}], 
     ";", "\n", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"h", "[", 
         RowBox[{"b", ",", "a", ",", "c", ",", "d"}], "]"}]}], "/;", 
       RowBox[{"a", ">", "b"}]}]}], ";", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"h", "[", 
         RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}]}], "/;", 
       RowBox[{"c", ">", "d"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"c", ",", "d", ",", "a", ",", "b"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"a", ">", "c"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "===", "c"}], "&&", 
          RowBox[{"b", ">", "d"}]}], ")"}]}]}]}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"epsilon", "[", "a__", "]"}], ":=", 
   RowBox[{"Signature", "[", 
    RowBox[{"{", "a", "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zeroTensor", "[", "rnk_", "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{"Table", ",", "0", ",", 
     RowBox[{"List", "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"Dim", ",", 
        RowBox[{"{", "rnk", "}"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FuncRepRules", "[", 
   RowBox[{
    RowBox[{"f_", "[", "y__", "]"}], ",", "g_", ",", 
    RowBox[{"ord_", ":", "2"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"FuncRepRules", "[", 
    RowBox[{
     RowBox[{"f", "[", "y", "]"}], ",", "g", ",", "ord"}], "]"}], "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tmp$", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"f", "[", "y", "]"}], "->", "g"}], "}"}]}], ",", 
       RowBox[{"indL", "=", 
        RowBox[{"indexList", "[", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"{", "y", "}"}], "]"}], ",", "ord"}], "]"}]}]}], "}"}], 
     ",", "\n", "       ", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"tmp$", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"indL", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", "f", "]"}], "[",
             "y", "]"}], " ", "->", " ", "\n", "            ", 
           RowBox[{"Expand", "[", 
            RowBox[{"FaSi", "[", 
             RowBox[{"D", "[", 
              RowBox[{"g", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "y", "}"}], ",", 
                   RowBox[{"indL", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}]}], "]"}],
              "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "indL", "]"}]}], "}"}]}], "]"}], ";", 
      "tmp$"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"indexList", "[", 
   RowBox[{"varNo_", ",", "ord_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp$", ",", "indL"}], "}"}], ",", 
    RowBox[{
     RowBox[{"tmp$", "=", 
      RowBox[{"NestList", "[", 
       RowBox[{"RotateRight", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"varNo", "-", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"varNo", "-", "1"}]}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ord", ">", "1"}], ",", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"indL", "=", "tmp$"}], ";", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"tmp$", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"tmp$", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Plus", "[", 
                   RowBox[{
                    RowBox[{"indL", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
                 ",", "indL"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "varNo"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ord", "-", "1"}], "}"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"Union", "[", "tmp$", "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MF", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "x", "]"}], "/;", 
    RowBox[{"Dim", "<", "10"}]}]}], ";", 
  RowBox[{
   RowBox[{"MF", "[", "x_", "]"}], ":=", "x"}], ";", 
  RowBox[{"DeclareForms", "[", 
   RowBox[{"1", ",", 
    RowBox[{"e", "[", "_", "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stPrint", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"y_", ":", "Null"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"y", "===", "Null"}], ",", 
     RowBox[{"StylePrint", "[", 
      RowBox[{"x", ",", " ", 
       RowBox[{"FontSize", "->", "20"}], ",", 
       RowBox[{"FontWeight", "->", "\"\<Bold\>\""}], ",", 
       RowBox[{"FontColor", "->", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", " ", "0", ",", " ", "1"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"StylePrint", "[", 
      RowBox[{"x", ",", " ", 
       RowBox[{"FontSize", "->", "16"}], ",", 
       RowBox[{"FontSlant", "->", "\"\<Italic\>\""}], ",", 
       RowBox[{"FontColor", "->", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", " ", "0", ",", " ", "1"}], "]"}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"timePrint", "[", 
    RowBox[{"x_", ",", "sT_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"x", "<>", "\"\< computed in \>\""}], ",", 
     RowBox[{
      RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}], ",", "\"\< sec\>\""}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"myCoef$", ",", 
    RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
  RowBox[{
   RowBox[{"myCoef$", "[", 
    RowBox[{"x_SeriesData", ",", "y__"}], "]"}], ":=", 
   RowBox[{"x", "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "->", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"#", ",", "y"}], "]"}], "&"}], ",", 
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ";", 
  RowBox[{
   RowBox[{"myCoef$", "[", 
    RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RGtensors", "[", 
    RowBox[{"gIN_", ",", "xIN_", ",", "opt___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"frameOpt", "=", "0"}], ",", "eIN", ",", 
       RowBox[{"Ropt", "=", "True"}], ",", 
       RowBox[{"Wopt", "=", "True"}], ",", "idMat", ",", "eFrame", ",", 
       "dxRul", ",", "Bmat", ",", "Amat", ",", 
       RowBox[{"NP$", "=", "False"}], ",", "de", ",", "a", ",", "b", ",", "c",
        ",", "id", ",", "k", ",", "StrCon", ",", "\[Gamma]Udd", ",", 
       "\[Gamma]ddd", ",", "gddd", ",", "Gamddd", ",", "rmn", ",", "tmp", ",",
        "RUd", ",", "Rg", ",", "gg", ",", "sT", ",", "Cflat", ",", "EinSp"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{
       "GUdd", ",", "\[Omega]Ud", ",", "RUddd", ",", "Rdd", ",", "EUd", ",", 
        "R", ",", "Wdddd", ",", "detg", ",", "rtAbsdetg", ",", "eta", ",", 
        "HStar", ",", "PS", ",", "PH"}], "]"}], ";", "\n", "\t\t", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "gIN", "]"}], "=!=", "gIN"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"MatrixForm", "[", "gIN", "]"}], ",", 
           "\"\< is not a symmetric matrix\>\""}], "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", " ", 
      RowBox[{"Dim", "=", 
       RowBox[{"Length", "[", "xIN", "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Dim", "=!=", 
         RowBox[{"Length", "[", "gIN", "]"}]}], ",", 
        RowBox[{
         RowBox[{"stPrint", "[", 
          RowBox[{
          "\"\<Metric and coordinate dimensions don't match\>\"", ",", "1"}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", "\t\t", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gIN", "===", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"NP$", "=", "True"}]}], "]"}], ";", 
      RowBox[{"eFrame", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", "Dim", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"frameOpt", "=", 
         RowBox[{"0", " ", "=", 
          RowBox[{">", " ", "coordFrame"}]}]}], ",", " ", 
        RowBox[{"frameOpt", "=", 
         RowBox[{"1", " ", "=", 
          RowBox[{">", " ", "explicitFrame"}]}]}], ",", " ", 
        RowBox[{"frameOpt", "=", 
         RowBox[{"2", " ", "=", 
          RowBox[{">", " ", "implicitFrame"}]}]}]}], " ", "*)"}], "\n", 
      "\t\t", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "opt", "}"}], "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", "opt", "}"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "e"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "dxRuleList", "]"}], "===", "List"}], "&&", 
              RowBox[{
               RowBox[{"Head", "[", "deList", "]"}], "===", "List"}]}], ",", 
             RowBox[{
              RowBox[{"frameOpt", "=", "2"}], ";", 
              RowBox[{"eIN", "=", "eFrame"}]}], ",", 
             RowBox[{
              RowBox[{"stPrint", "[", 
               RowBox[{
               "\"\<dxRuleList and/or deList have not been defined!\>\"", ",",
                 "1"}], "]"}], ";", 
              RowBox[{"Return", "[", "]"}]}]}], "]"}]}], "]"}], ";", "\n", 
         "\t", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", "opt", "}"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&&", 
            RowBox[{
             RowBox[{"d", "[", "0", "]"}], "=!=", "0"}]}], ",", 
           RowBox[{
            RowBox[{"stPrint", "[", 
             RowBox[{
             "\"\<matrixEDCcode.nb must be evaluated before section 2 \
RG&TC-Code!\>\"", ",", "1"}], "]"}], ";", 
            RowBox[{"Return", "[", "]"}]}], ",", "\n", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "opt", "}"}], "]"}], "===", "2"}], "&&", 
            RowBox[{
             RowBox[{"FormDegree", "[", 
              RowBox[{
               RowBox[{"{", "opt", "}"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "1"}]}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"frameOpt", "=!=", "2"}], ",", 
              RowBox[{
               RowBox[{"eIN", "=", 
                RowBox[{
                 RowBox[{"{", "opt", "}"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", 
               RowBox[{"frameOpt", "=", "1"}]}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "opt", "}"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "===", "0"}], ",", 
              RowBox[{"Ropt", "=", "False"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "opt", "}"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], ",", 
              RowBox[{"Wopt", "=", "False"}]}], "]"}]}], ",", "\n", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "opt", "}"}], "]"}], "===", "1"}], "&&", 
            RowBox[{"IntegerQ", "[", 
             RowBox[{"opt", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"opt", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "===", "0"}], ",", 
              RowBox[{"Ropt", "=", "False"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"opt", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], ",", 
              RowBox[{"Wopt", "=", "False"}]}], "]"}]}], ",", "\n", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "opt", "}"}], "]"}], "===", "1"}], "&&", 
            RowBox[{
             RowBox[{"FormDegree", "[", 
              RowBox[{"opt", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "1"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"frameOpt", "=!=", "2"}], ",", 
             RowBox[{
              RowBox[{"eIN", "=", "opt"}], ";", 
              RowBox[{"frameOpt", "=", "1"}]}]}], "]"}], ",", "\n", "\t", 
           "True", ",", 
           RowBox[{
            RowBox[{"stPrint", "[", 
             RowBox[{"\"\<Wrong optional arguments!\>\"", ",", "1"}], "]"}], 
            ";", 
            RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"gIN", ",", "eIN", ",", 
             RowBox[{"{", "deList", "}"}]}], "}"}], ",", "SeriesData"}], 
          "]"}]}], ",", "\n", "\t", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"gIN", ",", "eIN", ",", 
                 RowBox[{"{", "deList", "}"}]}], "}"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "===", "SeriesData"}], 
               "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"xIN", ",", "tmp"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"de", "[", "1", "]"}], "=", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"\"\<d\>\"", "<>", 
               RowBox[{"ToString", "[", "tmp", "]"}]}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"de", "[", "2", "]"}], "=", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"\"\<\[ScriptD]\>\"", "<>", 
               RowBox[{"ToString", "[", "tmp", "]"}]}], "]"}]}], ";", 
            RowBox[{"DeclareForms", "[", 
             RowBox[{"1", ",", 
              RowBox[{"\[ScriptD]", "[", "_", "]"}], ",", 
              RowBox[{"de", "[", "1", "]"}], ",", 
              RowBox[{"de", "[", "2", "]"}]}], "]"}], ";", 
            RowBox[{
             RowBox[{"d", "[", "tmp", "]"}], "=", 
             RowBox[{"de", "[", "1", "]"}]}], ";", 
            RowBox[{
             RowBox[{"\[ScriptD]", "[", "tmp", "]"}], "=", 
             RowBox[{"de", "[", "2", "]"}]}], ";", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"de", "[", "1", "]"}], "]"}], "=", "0"}]}], ",", 
           RowBox[{
            RowBox[{"d", "[", "tmp", "]"}], "=", "0"}]}], "]"}]}]}], "]"}], 
      ";", "\n", "\t\t", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"frameOpt", "===", "1"}], ",", 
        RowBox[{
         RowBox[{"DeclareForms", "[", 
          RowBox[{"1", ",", 
           RowBox[{"\[ScriptD]", "[", "_", "]"}]}], "]"}], ";", 
         RowBox[{"origFRin$", "=", 
          RowBox[{"eIN", "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"d", "/@", "xIN"}], ",", 
               RowBox[{"\[ScriptD]", "/@", "xIN"}]}], "}"}]}], "]"}]}]}], ";", 
         RowBox[{"eTO$dx", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"e", "/@", 
               RowBox[{"Range", "[", "Dim", "]"}]}], ",", "origFRin$"}], 
             "}"}]}], "]"}]}]}]}], "]"}], ";", "\n", "\t\t\t\t", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"frameOpt", ">", "0"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"FormDegree", "/@", "eIN"}], "]"}], "=!=", 
            RowBox[{"{", "1", "}"}]}], "||", 
           RowBox[{
            RowBox[{"Length", "[", "eIN", "]"}], "=!=", "Dim"}], "||", 
           RowBox[{"!", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"eIN", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"d", "[", "k_", "]"}], "->", "0"}], ",", 
                RowBox[{
                 RowBox[{"e", "[", "_", "]"}], "->", "0"}], ",", 
                RowBox[{
                 RowBox[{"y_", "|", 
                  RowBox[{"Bar", "[", "y_", "]"}]}], ":>", 
                 RowBox[{"0", "/;", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"DifFormSymbols", ",", "y"}], "]"}]}]}]}], "}"}]}],
              "]"}]}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"stPrint", "[", 
          RowBox[{"\"\<coframe has incorrect form\>\"", ",", "1"}], "]"}], 
         ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\t", "\n", "\t\t", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "simpRules", "]"}], "===", "Rule"}], "||", 
         RowBox[{
          RowBox[{"Head", "[", "simpRules", "]"}], "===", "RuleDelayed"}]}], 
        ",", 
        RowBox[{"simpRules", "=", 
         RowBox[{"{", "simpRules", "}"}]}]}], "]"}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "simpRules", "]"}], "=!=", "List"}], ",", " ", 
        RowBox[{"simpRules", "=", 
         RowBox[{"{", "}"}]}]}], "]"}], ";", 
      RowBox[{"idMat", "=", 
       RowBox[{"IdentityMatrix", "[", "Dim", "]"}]}], ";", "\n", "\n", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"frameOpt", "===", "0"}], ",", 
        RowBox[{
         RowBox[{"Amat", "=", "idMat"}], ";", 
         RowBox[{"Bmat", "=", "idMat"}], ";", 
         RowBox[{"eIN", "=", 
          RowBox[{"d", "/@", "xIN"}]}], ";", 
         RowBox[{"dxRul", "=", 
          RowBox[{"{", "}"}]}]}], ",", "\n", 
        RowBox[{
         RowBox[{"frameOpt", "===", "1"}], "&&", 
         RowBox[{"zeroQ", "[", 
          RowBox[{"eIN", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"d", "[", "k_", "]"}], "->", "0"}], ",", 
             RowBox[{
              RowBox[{"y_", "|", 
               RowBox[{"Bar", "[", "y_", "]"}]}], ":>", 
              RowBox[{"0", "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"DifFormSymbols", ",", "y"}], "]"}]}]}]}], "}"}]}], 
          "]"}]}], ",", 
        RowBox[{
         RowBox[{"Bmat", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"myCoef$", "[", 
             RowBox[{
              RowBox[{"eIN", "[", 
               RowBox[{"[", "a", "]"}], "]"}], ",", 
              RowBox[{"d", "[", 
               RowBox[{"xIN", "[", 
                RowBox[{"[", "b", "]"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "Dim"}], "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{"Det", "[", "Bmat", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"sT", "=", 
             RowBox[{"TimeUsed", "[", "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ByteCount", "[", "eIN", "]"}], ">", 
               RowBox[{"1500", "*", "Dim"}]}], ",", 
              RowBox[{"stPrint", "[", 
               RowBox[{"\"\<Computing d[coframe]...\>\"", ",", "1"}], "]"}]}],
              "]"}], ";", 
            RowBox[{"Amat", "=", 
             RowBox[{"FaSi", "[", 
              RowBox[{"Inverse", "[", "Bmat", "]"}], "]"}]}], ";", 
            RowBox[{"dxRul", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"d", "[", "xIN", "]"}], ",", 
                 RowBox[{"Amat", ".", "eFrame"}]}], "}"}]}], "]"}]}], ";", 
            RowBox[{"de", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FreeQ", "[", 
                RowBox[{"eIN", ",", "SeriesData"}], "]"}], ",", 
               RowBox[{"FacSimp", "[", 
                RowBox[{
                 RowBox[{"d", "[", "eIN", "]"}], "/.", "dxRul"}], "]"}], ",", 
               
               RowBox[{"FacSimp", "[", 
                RowBox[{"Wedge", "[", 
                 RowBox[{
                  RowBox[{"FacSimp", "[", 
                   RowBox[{
                    RowBox[{"FacSimp", "[", 
                    RowBox[{"d", "[", "Bmat", "]"}], "]"}], "/.", "dxRul"}], 
                   "]"}], ",", 
                  RowBox[{
                   RowBox[{"d", "[", "xIN", "]"}], "/.", "dxRul"}]}], "]"}], 
                "]"}]}], "]"}]}], ";", 
            RowBox[{"timePrint", "[", 
             RowBox[{"\"\<d[coframe]\>\"", ",", "sT"}], "]"}], ";", 
            RowBox[{"tmp", "=", 
             RowBox[{
              RowBox[{"d", "[", "xIN", "]"}], "/.", "dxRul"}]}], ";", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Set", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"d", "[", "xIN", "]"}], ",", "tmp"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{"stPrint", "[", 
             RowBox[{"\"\<coframe does not span space!\>\"", ",", "1"}], 
             "]"}], ";", 
            RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ",", "\n", 
        RowBox[{"frameOpt", "===", "2"}], ",", 
        RowBox[{
         RowBox[{"de", "=", "deList"}], ";", 
         RowBox[{"dxRul", "=", "dxRuleList"}], ";", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{"d", "[", "xIN", "]"}], "/.", "dxRul"}]}], ";", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Set", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"d", "[", "xIN", "]"}], ",", "tmp"}], "}"}]}], "]"}], 
         ";", 
         RowBox[{"Amat", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"myCoef$", "[", 
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"[", "a", "]"}], "]"}], ",", 
              RowBox[{"eIN", "[", 
               RowBox[{"[", "b", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "Dim"}], "}"}]}], "]"}]}]}]}], "]"}], ";", 
      "\n", "\t\t", "\n", 
      RowBox[{"k", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "x_Symbol"}], ")"}], "b_."], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "x_Symbol"}], ")"}], "b_."]}], "->", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["x", "2"]}], ")"}], "b"]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x_Symbol", "-", "y_Symbol"}], ")"}], "b_."], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x_Symbol", "+", "y_Symbol"}], ")"}], "b_."]}], 
          "\[Rule]", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "-", 
             SuperscriptBox["y", "2"]}], ")"}], "b"]}]}], "}"}]}], ";", 
      RowBox[{"gdd", "=", "gIN"}], ";", 
      RowBox[{"coordList", "=", "xIN"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<gdd = \>\"", ",", 
        RowBox[{"MF", "[", "gdd", "]"}]}], "]"}], ";", 
      RowBox[{"tmp", "=", 
       RowBox[{"eIN", ".", "gIN", ".", "eIN"}]}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\!\(\*SuperscriptBox[\(ds\), \(2\)]\) = \>\"", ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "tmp", "]"}], "===", "SeriesData"}], ",", 
           RowBox[{"FacSimp", "[", "tmp", "]"}], ",", 
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"Expand", "[", "tmp", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"d", "[", "a_", "]"}], "^", "2"}], ",", 
               RowBox[{
                RowBox[{"d", "[", "a_", "]"}], 
                RowBox[{"d", "[", "b_", "]"}]}], ",", 
               RowBox[{
                RowBox[{"e", "[", "a_", "]"}], "^", "2"}], ",", 
               RowBox[{
                RowBox[{"e", "[", "a_", "]"}], 
                RowBox[{"e", "[", "b_", "]"}]}]}], "}"}], ",", "Factor"}], 
            "]"}]}], "]"}], "//.", "k"}]}], "]"}], ";", 
      RowBox[{"sT", "=", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", 
      RowBox[{"gUU", "=", 
       RowBox[{
        RowBox[{"FixedPoint", "[", 
         RowBox[{"FaSi", ",", 
          RowBox[{"Inverse", "[", "gIN", "]"}]}], "]"}], "//.", "k"}]}], ";", 
      
      RowBox[{"detg", "=", 
       RowBox[{
        RowBox[{"FixedPoint", "[", 
         RowBox[{"FaSi", ",", 
          RowBox[{"Det", "[", "gIN", "]"}]}], "]"}], "//.", "k"}]}], ";", 
      "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<gUU = \>\"", ",", 
        RowBox[{"MF", "[", "gUU", "]"}]}], "]"}], ";", 
      RowBox[{"Clear", "[", "k", "]"}], ";", 
      RowBox[{"timePrint", "[", 
       RowBox[{"\"\<gUU\>\"", ",", "sT"}], "]"}], ";", "\n", "\t\t", "\n", 
      RowBox[{"rtAbsdetg", "=", 
       RowBox[{"PowerExpand", "[", 
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"Factor", "[", 
           RowBox[{"detg", "^", "2"}], "]"}], ",", 
          RowBox[{"1", "/", "4"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"HStar", ",", 
        RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"NP$", ",", 
        RowBox[{"rtAbsdetg", "=", "I"}]}], "]"}], ";", 
      RowBox[{
       RowBox[{"HStar", "[", "x_SeriesData", "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{"HStar", "/@", 
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], ";", 
      RowBox[{
       RowBox[{"HStar", "[", "x_Plus", "]"}], ":=", 
       RowBox[{"FacSimp", "[", 
        RowBox[{"Plus", "@@", 
         RowBox[{"HStar", "/@", "x"}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"HStar", "[", 
        RowBox[{"x_", "*", "y_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"x", "*", 
         RowBox[{"HStar", "[", "y", "]"}]}], "/;", 
        RowBox[{
         RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}], ";", 
      RowBox[{
       RowBox[{"HStar", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"rtAbsdetg", " ", 
         RowBox[{"Wedge", "@@", 
          RowBox[{"e", "/@", 
           RowBox[{"Range", "[", "Dim", "]"}]}]}]}], "/;", 
        RowBox[{
         RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}], ";", 
      RowBox[{
       RowBox[{"HStar", "[", "x_Wedge", "]"}], ":=", 
       RowBox[{
        RowBox[{"rtAbsdetg", "/", "detg"}], "/;", 
        RowBox[{
         RowBox[{"Length", "[", "x", "]"}], "===", "Dim"}]}]}], ";", 
      RowBox[{
       RowBox[{"HStar", "[", 
        RowBox[{"x_Wedge", "|", "x_e"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"HStar", "[", "x", "]"}], "=", 
        RowBox[{"rtAbsdetg", " ", 
         RowBox[{"FacSimp", "[", 
          RowBox[{"inn", "[", 
           RowBox[{"x", ",", 
            RowBox[{"Wedge", "@@", 
             RowBox[{"e", "/@", 
              RowBox[{"Range", "[", "Dim", "]"}]}]}]}], "]"}], "]"}]}]}]}], 
      ";", "\t\t", "\n", "\t\t", "\n", 
      RowBox[{
       RowBox[{"eta", "[", "]"}], ":=", 
       RowBox[{
        RowBox[{"eta", "[", "]"}], "=", 
        RowBox[{"rtAbsdetg", " ", 
         RowBox[{"Array", "[", 
          RowBox[{"epsilon", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"Dim", ",", 
             RowBox[{"{", "Dim", "}"}]}], "]"}]}], "]"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"eta", "[", "a__", "]"}], ":=", 
       RowBox[{
        RowBox[{"eta", "[", "a", "]"}], "=", 
        RowBox[{"Raise", "[", 
         RowBox[{
          RowBox[{"eta", "[", "]"}], ",", "a"}], "]"}]}]}], ";", 
      RowBox[{"sT", "=", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\n", "\t\t", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"frameOpt", ">", "0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"e", "[", "a_", "]"}], "]"}], ":=", 
          RowBox[{"de", "[", 
           RowBox[{"[", "a", "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"StrCon", "[", 
           RowBox[{"c_", ",", "a_", ",", "a_"}], "]"}], "=", "0"}], ";", 
         RowBox[{
          RowBox[{"StrCon", "[", 
           RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"StrCon", "[", 
             RowBox[{"c", ",", "b", ",", "a"}], "]"}]}], "/;", 
           RowBox[{"a", ">", "b"}]}]}], ";", 
         RowBox[{
          RowBox[{"StrCon", "[", 
           RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"-", 
           RowBox[{"myCoef$", "[", 
            RowBox[{
             RowBox[{"de", "[", 
              RowBox[{"[", "c", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"e", "[", "a", "]"}], "\[Wedge]", 
              RowBox[{"e", "[", "b", "]"}]}]}], "]"}]}]}], ";", "\n", 
         RowBox[{"\[Gamma]Udd", "=", 
          RowBox[{"Array", "[", 
           RowBox[{"StrCon", ",", 
            RowBox[{"{", 
             RowBox[{"Dim", ",", "Dim", ",", "Dim"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"\[Gamma]ddd", "=", 
          RowBox[{"gdd", ".", "\[Gamma]Udd"}]}]}], ",", 
        RowBox[{
         RowBox[{"\[Gamma]Udd", "=", 
          RowBox[{"zeroTensor", "[", "3", "]"}]}], ";", 
         RowBox[{"\[Gamma]ddd", "=", "\[Gamma]Udd"}]}]}], "]"}], ";", "\n", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{"*", " ", "Tests"}], " ", "**)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"frameOpt", ">", "0"}], ",", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", "[", "gdd", "]"}], "/.", "dxRul"}], ")"}], "/.", 
           RowBox[{
            RowBox[{"e", "[", "_", "]"}], "->", "0"}]}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"zeroQ", "[", "tmp", "]"}]}], ",", 
           RowBox[{
            RowBox[{"stPrint", "[", 
             RowBox[{
             "\"\<Warning: d[] on some symbols not defined!\>\"", ",", "1"}], 
             "]"}], ";", 
            RowBox[{"Print", "[", 
             RowBox[{"indepTerms", "[", 
              RowBox[{"FacSimp", "[", "tmp", "]"}], "]"}], "]"}]}]}], "]"}], 
         ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"frameOpt", "===", "2"}], "&&", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ByteCount", "[", "deList", "]"}], "+", 
                RowBox[{"ByteCount", "[", "dxRuleList", "]"}]}], ")"}], "/", 
              "Dim"}], "<", "6000"}]}], ",", 
           RowBox[{
            RowBox[{"tmp", "=", 
             RowBox[{"FacSimp", "[", 
              RowBox[{"d", "[", "deList", "]"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"zeroQ", "[", "tmp", "]"}]}], ",", 
              RowBox[{
               RowBox[{"stPrint", "[", 
                RowBox[{
                "\"\<Warning: deList not closed! d[deList]=\>\"", ",", "1"}], 
                "]"}], ";", 
               RowBox[{"Print", "[", "tmp", "]"}], ";", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"zeroQ", "[", 
                   RowBox[{"tmp", "/.", 
                    RowBox[{
                    RowBox[{"d", "[", "_", "]"}], "->", "0"}]}], "]"}]}], ",", 
                 RowBox[{"Return", "[", "]"}]}], "]"}]}]}], "]"}]}]}], 
          "]"}]}]}], "]"}], ";", "\n", "\t\t", "\n", 
      RowBox[{"Clear", "[", "pD", "]"}], ";", 
      RowBox[{
       RowBox[{"pD", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"pD", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Amat", "===", "idMat"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{"x", ",", 
            RowBox[{"coordList", "[", 
             RowBox[{"[", "y", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Amat", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "y"}], "]"}], "]"}], "*", 
             RowBox[{"D", "[", 
              RowBox[{"x", ",", 
               RowBox[{"coordList", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "Dim"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
      "\t", "\n", "\t\t", "\n", 
      RowBox[{
       RowBox[{"gddd", "[", 
        RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"gddd", "[", 
         RowBox[{"c", ",", "b", ",", "a"}], "]"}], "/;", 
        RowBox[{"a", ">", "b"}]}]}], ";", 
      RowBox[{
       RowBox[{"gddd", "[", 
        RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"gddd", "[", 
         RowBox[{"c", ",", "a", ",", "b"}], "]"}], "=", 
        RowBox[{"FaSi", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pD", "[", 
             RowBox[{
              RowBox[{"gdd", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "c"}], "]"}], "]"}], ",", "b"}], "]"}], "+", 
            RowBox[{"pD", "[", 
             RowBox[{
              RowBox[{"gdd", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "c"}], "]"}], "]"}], ",", "a"}], "]"}], "-", 
            RowBox[{"pD", "[", 
             RowBox[{
              RowBox[{"gdd", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "b"}], "]"}], "]"}], ",", "c"}], "]"}]}], 
           ")"}], "/", "2"}], "]"}]}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"frameOpt", "===", "0"}], ",", 
        RowBox[{
         RowBox[{"Gamddd", "=", 
          RowBox[{"Array", "[", 
           RowBox[{"gddd", ",", 
            RowBox[{"{", 
             RowBox[{"Dim", ",", "Dim", ",", "Dim"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"Clear", "[", "tmp", "]"}], ";", 
         RowBox[{"k", "=", 
          RowBox[{"gUU", ".", "Gamddd"}]}], ";", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"c", ",", "b", ",", "a"}], "]"}], "/;", 
           RowBox[{"a", ">", "b"}]}]}], ";", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"c", ",", "a", ",", "b"}], "]"}], "=", 
           RowBox[{"FaSi", "[", 
            RowBox[{"k", "[", 
             RowBox[{"[", 
              RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], "]"}]}]}], ";", 
         RowBox[{"GUdd", "=", 
          RowBox[{"Array", "[", 
           RowBox[{"tmp", ",", 
            RowBox[{"{", 
             RowBox[{"Dim", ",", "Dim", ",", "Dim"}], "}"}]}], "]"}]}]}], ",",
         "\n", 
        RowBox[{
         RowBox[{"Gamddd", "=", 
          RowBox[{"FaSi", "[", 
           RowBox[{
            RowBox[{"Array", "[", 
             RowBox[{"gddd", ",", 
              RowBox[{"{", 
               RowBox[{"Dim", ",", "Dim", ",", "Dim"}], "}"}]}], "]"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Gamma]ddd", "+", 
               RowBox[{"Transpose", "[", "\[Gamma]ddd", "]"}], "-", 
               RowBox[{"Transpose", "[", 
                RowBox[{"\[Gamma]ddd", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}]}], ")"}], 
             "/", "2"}]}], "]"}]}], ";", 
         RowBox[{"GUdd", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"NumericQ", "/@", 
                RowBox[{"Flatten", "[", "gUU", "]"}]}], "]"}], "===", 
              RowBox[{"{", "True", "}"}]}], "&&", 
             RowBox[{
              RowBox[{"nonZeroN", "[", "gUU", "]"}], "===", "Dim"}]}], ",", 
            RowBox[{"gUU", ".", "Gamddd"}], ",", 
            RowBox[{"FaSi", "[", 
             RowBox[{"gUU", ".", "Gamddd"}], "]"}]}], "]"}]}]}]}], "]"}], ";",
       "\n", "\t\t", "\n", 
      RowBox[{"timePrint", "[", 
       RowBox[{"\"\<Gamma\>\"", ",", "sT"}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"frameOpt", ">", "0"}], ",", 
        RowBox[{"\[Omega]Ud", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GUdd", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "k", ",", "b"}], "]"}], "]"}], 
              RowBox[{"e", "[", "k", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "Dim"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "Dim"}], "}"}]}], "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", "\n", 
      RowBox[{"sT", "=", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", 
      RowBox[{"RiemSym", "[", "rmn", "]"}], ";", 
      RowBox[{
       RowBox[{"rmn", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_", ",", "id_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"rmn", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "id"}], "]"}], "=", 
        RowBox[{"FaSi", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Amat", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "c"}], "]"}], "]"}], 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Gamddd", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", "id", ",", "b"}], "]"}], "]"}], ",", 
               RowBox[{"xIN", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Amat", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "id"}], "]"}], "]"}], 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Gamddd", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", "c", ",", "b"}], "]"}], "]"}], ",", 
               RowBox[{"xIN", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"GUdd", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "c", ",", "b"}], "]"}], "]"}], "*", 
             RowBox[{"Gamddd", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "id", ",", "a"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"GUdd", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "id", ",", "b"}], "]"}], "]"}], "*", 
             RowBox[{"Gamddd", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "c", ",", "a"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Gamddd", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "k", ",", "b"}], "]"}], "]"}], "*", 
             RowBox[{"\[Gamma]Udd", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "c", ",", "id"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "Dim"}], "}"}]}], "]"}], "]"}]}]}], ";", 
      RowBox[{"Rdddd", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"rmn", ",", 
         RowBox[{"{", 
          RowBox[{"Dim", ",", "Dim", ",", "Dim", ",", "Dim"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"timePrint", "[", 
       RowBox[{"\"\<Riemann(dddd)\>\"", ",", "sT"}], "]"}], ";", 
      RowBox[{"sT", "=", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zeroQ", "[", "Rdddd", "]"}], ",", 
        RowBox[{
         RowBox[{"stPrint", "[", "\"\<Flat Space!\>\"", "]"}], ";", 
         RowBox[{"Clear", "[", 
          RowBox[{"Rdd", ",", "EUd", ",", "R", ",", "Wdddd"}], "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", "\t\t", "\n", 
      RowBox[{"Rg", "=", 
       RowBox[{"gUU", ".", "Rdddd"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"Ropt", ",", 
        RowBox[{
         RowBox[{"Clear", "[", "rmn", "]"}], ";", 
         RowBox[{
          RowBox[{"rmn", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_", ",", "c_"}], "]"}], "=", "0"}],
          ";", 
         RowBox[{
          RowBox[{"rmn", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_", ",", "id_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"rmn", "[", 
             RowBox[{"a", ",", "b", ",", "id", ",", "c"}], "]"}]}], "/;", 
           RowBox[{"c", ">", "id"}]}]}], ";", 
         RowBox[{
          RowBox[{"rmn", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_", ",", "id_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"rmn", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "id"}], "]"}], "=", 
           RowBox[{"FaSi", "[", 
            RowBox[{"Rg", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "id"}], "]"}], "]"}], 
            "]"}]}]}], ";", 
         RowBox[{"RUddd", "=", 
          RowBox[{"Array", "[", 
           RowBox[{"rmn", ",", 
            RowBox[{"{", 
             RowBox[{"Dim", ",", "Dim", ",", "Dim", ",", "Dim"}], "}"}]}], 
           "]"}]}], ";", 
         RowBox[{"timePrint", "[", 
          RowBox[{"\"\<Riemann(Uddd)\>\"", ",", "sT"}], "]"}], ";", 
         RowBox[{"sT", "=", 
          RowBox[{"TimeUsed", "[", "]"}]}], ";", 
         RowBox[{"Rg", "=", "RUddd"}]}], ",", 
        RowBox[{"stPrint", "[", 
         RowBox[{"\"\<RUddd not computed\>\"", ",", "1"}], "]"}]}], "]"}], 
      ";", "\n", "\t\t", "\n", 
      RowBox[{"Clear", "[", "tmp", "]"}], ";", 
      RowBox[{
       RowBox[{"tmp", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"tmp", "[", 
         RowBox[{"b", ",", "a"}], "]"}], "/;", 
        RowBox[{"a", ">", "b"}]}]}], ";", 
      RowBox[{
       RowBox[{"tmp", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"tmp", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "=", 
        RowBox[{"FaSi", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Rg", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "a", ",", "k", ",", "b"}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"k", ",", "Dim"}], "}"}]}], "]"}], "]"}]}]}], ";", 
      RowBox[{"Rdd", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"{", 
          RowBox[{"Dim", ",", "Dim"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t\t\t\t", "\n", 
      RowBox[{"RUd", "=", 
       RowBox[{"gUU", ".", "Rdd"}]}], ";", 
      RowBox[{"R", "=", 
       RowBox[{"FaSi", "[", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"RUd", "[", 
           RowBox[{"[", 
            RowBox[{"a", ",", "a"}], "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"a", ",", "Dim"}], "}"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"timePrint", "[", 
       RowBox[{"\"\<Ricci\>\"", ",", "sT"}], "]"}], ";", 
      RowBox[{"sT", "=", 
       RowBox[{"TimeUsed", "[", "]"}]}], ";", "\n", "\t\t", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Wopt", "||", 
         RowBox[{"Dim", "<", "4"}]}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Dim", ">", "3"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"zeroQ", "[", "Rdd", "]"}], ",", 
             RowBox[{"Wdddd", "=", "Rdddd"}], ",", "\n", "\t", 
             RowBox[{
              RowBox[{"gg", "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"Outer", "[", 
                  RowBox[{"Times", ",", "gdd", ",", "gdd"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], 
                "]"}]}], ";", 
              RowBox[{"gg", "=", 
               RowBox[{"gg", "-", 
                RowBox[{"Transpose", "[", "gg", "]"}]}]}], ";", 
              RowBox[{"Rg", "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"Outer", "[", 
                  RowBox[{"Times", ",", "Rdd", ",", "gdd"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], 
                "]"}]}], ";", 
              RowBox[{"Rg", "=", 
               RowBox[{"Rg", "-", 
                RowBox[{"Transpose", "[", "Rg", "]"}]}]}], ";", 
              RowBox[{"Rg", "=", 
               RowBox[{"Rg", "-", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"Rg", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], 
                 "]"}]}]}], ";", "\n", 
              RowBox[{"Clear", "[", "rmn", "]"}], ";", 
              RowBox[{"RiemSym", "[", "rmn", "]"}], ";", 
              RowBox[{
               RowBox[{"rmn", "[", 
                RowBox[{"a_", ",", "b_", ",", "c_", ",", "id_"}], "]"}], ":=", 
               RowBox[{
                RowBox[{"rmn", "[", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "id"}], "]"}], "=", 
                RowBox[{"FaSi", "[", 
                 RowBox[{
                  RowBox[{"Rdddd", "[", 
                   RowBox[{"[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "id"}], "]"}], 
                   "]"}], "-", 
                  RowBox[{
                   RowBox[{"Rg", "[", 
                    RowBox[{"[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "id"}], "]"}], 
                    "]"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"Dim", "-", "2"}], ")"}]}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{
                    RowBox[{"gg", "[", 
                    RowBox[{"[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "id"}], "]"}], 
                    "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Dim", "-", "1"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"Dim", "-", "2"}], ")"}]}], ")"}]}]}]}], 
                 "]"}]}]}], ";", 
              RowBox[{"Wdddd", "=", 
               RowBox[{"Array", "[", 
                RowBox[{"rmn", ",", 
                 RowBox[{"{", 
                  RowBox[{"Dim", ",", "Dim", ",", "Dim", ",", "Dim"}], 
                  "}"}]}], "]"}]}]}]}], "]"}], ",", 
           RowBox[{"Wdddd", "=", 
            RowBox[{"zeroTensor", "[", "4", "]"}]}]}], "]"}], ";", 
         RowBox[{"timePrint", "[", 
          RowBox[{"\"\<Weyl\>\"", ",", "sT"}], "]"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"zeroQ", "[", "Wdddd", "]"}], ",", 
           RowBox[{
            RowBox[{"Cflat", "=", "True"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dim", "=!=", "3"}], "||", 
               RowBox[{"zeroQ", "[", "CF3d", "]"}]}], ",", 
              RowBox[{"stPrint", "[", "\"\<Conformally Flat\>\"", "]"}]}], 
             "]"}]}]}], "]"}]}], ",", 
        RowBox[{"stPrint", "[", 
         RowBox[{"\"\<Weyl tensor not computed\>\"", ",", "1"}], "]"}]}], 
       "]"}], ";", "\n", "\t\t", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zeroQ", "[", "Rdd", "]"}], ",", 
        RowBox[{
         RowBox[{"stPrint", "[", "\"\<Ricci Flat\>\"", "]"}], ";", 
         RowBox[{"EUd", "=", "Rdd"}]}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"sT", "=", 
          RowBox[{"TimeUsed", "[", "]"}]}], ";", 
         RowBox[{"EUd", "=", 
          RowBox[{"FaSi", "[", 
           RowBox[{"RUd", " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", "R", "*", "idMat"}]}], 
           "]"}]}], ";", 
         RowBox[{"timePrint", "[", 
          RowBox[{"\"\<Einstein\>\"", ",", "sT"}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"zeroQ", "[", 
            RowBox[{"EUd", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"1", "/", "2"}], "-", 
                RowBox[{"1", "/", "Dim"}]}], ")"}], "R", "*", "idMat"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"stPrint", "[", "\"\<Einstein Space\>\"", "]"}], ";", 
            RowBox[{"EinSp", "=", "True"}]}]}], "]"}]}]}], "]"}], ";", "\n", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dim", ">", "2"}], "&&", "Cflat", "&&", "EinSp"}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dim", "===", "2"}], "&&", 
           RowBox[{"zeroQ", "[", 
            RowBox[{"FaSi", "[", 
             RowBox[{"covD", "[", "R", "]"}], "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{
        "stPrint", "[", "\"\<Space of Constant Curvature!\>\"", "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"NP$", ",", "NPdefs"}], "]"}], ";"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CF3d", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"stPrint", "[", 
      RowBox[{"\"\<Testing for 3-dim conformal flatness...\>\"", ",", "1"}], 
      "]"}], ";", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp$", "=", 
         RowBox[{
          RowBox[{"covD", "[", "Rdd", "]"}], "-", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "gdd", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"covD", "[", "R", "]"}], "/", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"Dim", "-", "1"}], ")"}]}]}], "]"}]}]}], "}"}], ",", 
       RowBox[{"FaSi", "[", 
        RowBox[{"tmp$", "-", 
         RowBox[{"Transpose", "[", 
          RowBox[{"tmp$", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NPdefs", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"0", ",", " ", "0"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Rdd", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Rdd", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "/", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"1", ",", " ", "0"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Rdd", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "/", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"2", ",", " ", "2"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Rdd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Rdd", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "/", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"1", ",", " ", "2"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Rdd", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "1"}], "]"}], "]"}]}], "/", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"0", ",", " ", "2"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Rdd", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "4"}], "]"}], "]"}], "/", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"2", ",", " ", "0"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Rdd", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}], "/", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"PH", "[", 
       RowBox[{"1", ",", " ", "1"}], "]"}], " ", "=", " ", 
      RowBox[{"FaSi", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rdd", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
          RowBox[{"Rdd", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ")"}], "/", "4"}], 
       "]"}]}], ";", 
     RowBox[{"\[CapitalLambda]", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "R"}], "/", "2"}], "4"}]}], ";", 
     RowBox[{
     "tmp$", " ", "=", " ", 
      "\"\<NP variables PH[i,j], \[CapitalLambda] \>\""}], ";", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "Wdddd", "]"}], " ", "=!=", " ", "Symbol"}], ",",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{"PS", "[", "0", "]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"Wdddd", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "4", ",", "2", ",", "4"}], "]"}], "]"}]}]}], 
        ";", " ", 
        RowBox[{
         RowBox[{"PS", "[", "1", "]"}], " ", "=", " ", 
         RowBox[{"Wdddd", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
        " ", 
        RowBox[{
         RowBox[{"PS", "[", "2", "]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"Wdddd", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "]"}]}]}], 
        ";", " ", 
        RowBox[{
         RowBox[{"PS", "[", "3", "]"}], " ", "=", " ", 
         RowBox[{"Wdddd", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1", ",", "3", ",", "1"}], "]"}], "]"}]}], ";", 
        " ", 
        RowBox[{
         RowBox[{"PS", "[", "4", "]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"Wdddd", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1", ",", "3", ",", "1"}], "]"}], "]"}]}]}], 
        ";", " ", 
        RowBox[{"tmp$", " ", "=", " ", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"tmp$", ",", " ", "\"\<and PS[i] \>\""}], "]"}]}]}]}], 
      "]"}], ";", " ", 
     RowBox[{"stPrint", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"tmp$", ",", " ", "\"\<defined.\>\""}], "]"}], ",", " ", 
       "1"}], "]"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inn", "[", 
    RowBox[{"y_Wedge", ",", "x_"}], "]"}], ":=", 
   RowBox[{"inn", "[", 
    RowBox[{
     RowBox[{"Rest", "[", "y", "]"}], ",", 
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"First", "[", "y", "]"}], ",", "x"}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inn", "[", 
    RowBox[{
     RowBox[{"e", "[", "a_", "]"}], ",", 
     RowBox[{"x_", "+", "y_"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"inn", "[", 
     RowBox[{
      RowBox[{"e", "[", "a", "]"}], ",", "x"}], "]"}], "+", 
    RowBox[{"inn", "[", 
     RowBox[{
      RowBox[{"e", "[", "a", "]"}], ",", "y"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inn", "[", 
    RowBox[{
     RowBox[{"e", "[", "a_", "]"}], ",", 
     RowBox[{"x_", "*", "y_"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"e", "[", "a", "]"}], ",", "y"}], "]"}]}], "/;", 
    RowBox[{
     RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inn", "[", 
    RowBox[{
     RowBox[{"e", "[", "a_", "]"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{"0", "/;", 
    RowBox[{
     RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inn", "[", 
    RowBox[{
     RowBox[{"e", "[", "a_", "]"}], ",", "x_Wedge"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"e", "[", "a", "]"}], ",", 
       RowBox[{"First", "[", "x", "]"}]}], "]"}], "*", 
     RowBox[{"Rest", "[", "x", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"FormDegree", "[", 
       RowBox[{"First", "[", "x", "]"}], "]"}]}], "*", 
     RowBox[{
      RowBox[{"First", "[", "x", "]"}], "\[Wedge]", 
      RowBox[{"inn", "[", 
       RowBox[{
        RowBox[{"e", "[", "a", "]"}], ",", 
        RowBox[{"Rest", "[", "x", "]"}]}], "]"}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inn", "[", 
    RowBox[{
     RowBox[{"e", "[", "a_", "]"}], ",", 
     RowBox[{"e", "[", "b_", "]"}]}], "]"}], ":=", 
   RowBox[{"gUU", "[", 
    RowBox[{"[", 
     RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MoveIndex", "[", 
    RowBox[{"x_", ",", "i_", ",", "g_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rnk1", "=", 
        RowBox[{"TensorRank", "[", "x", "]"}]}], ",", "indL"}], "}"}], ",", 
     "\n", "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"i", "===", "1"}], ",", 
       RowBox[{"g", ".", "x"}], ",", 
       RowBox[{"i", "===", "rnk1"}], ",", 
       RowBox[{"x", ".", "g"}], ",", "True", ",", 
       RowBox[{
        RowBox[{"indL", "=", 
         RowBox[{
          RowBox[{"Range", "[", "rnk1", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "->", "1"}], ",", 
            RowBox[{"1", "->", "i"}]}], "}"}]}]}], ";", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"g", ".", 
           RowBox[{"Transpose", "[", 
            RowBox[{"x", ",", "indL"}], "]"}]}], ",", "indL"}], "]"}]}]}], 
      "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Lower", "[", 
    RowBox[{"x_", ",", "i__"}], "]"}], ":=", 
   RowBox[{"FacSimp", "[", 
    RowBox[{
     RowBox[{"FoldList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MoveIndex", "[", 
         RowBox[{"#1", ",", "#2", ",", "gdd"}], "]"}], "&"}], ",", "x", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "i", "}"}], "]"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Raise", "[", 
    RowBox[{"x_", ",", "i__"}], "]"}], ":=", 
   RowBox[{"FacSimp", "[", 
    RowBox[{
     RowBox[{"FoldList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MoveIndex", "[", 
         RowBox[{"#1", ",", "#2", ",", "gUU"}], "]"}], "&"}], ",", "x", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "i", "}"}], "]"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"multiDot", "[", 
    RowBox[{"x_", ",", "y_", ",", "indPr__"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rnk1", "=", 
        RowBox[{"TensorRank", "[", "x", "]"}]}], ",", 
       RowBox[{"rnk2", "=", 
        RowBox[{"TensorRank", "[", "y", "]"}]}], ",", 
       RowBox[{"indL", "=", 
        RowBox[{"Sort", "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", "indPr", "}"}], "]"}]}]}], ",", 
       RowBox[{"ordPr", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"{", "indPr", "}"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"indL", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", 
          RowBox[{"indL", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{"indL", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ">", "rnk1"}], "||", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"indL", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
          RowBox[{"indL", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{"indL", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ">", "rnk2"}]}], ",", 
        RowBox[{"errWarn", ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "ordPr", "]"}], "===", "1"}], ",", 
        RowBox[{"FacSimp", "[", 
         RowBox[{"dotOne", "[", 
          RowBox[{"x", ",", "y", ",", "indPr"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"rnk1", "===", "rnk2"}], "&&", 
         RowBox[{"rnk1", "===", 
          RowBox[{"Length", "[", "ordPr", "]"}]}]}], ",", 
        RowBox[{"FacSimp", "[", 
         RowBox[{"dotAll", "[", 
          RowBox[{"x", ",", "y", ",", "ordPr"}], "]"}], "]"}], ",", "True", 
        ",", 
        RowBox[{"OKindCon", "[", 
         RowBox[{
          RowBox[{"dotOne", "[", 
           RowBox[{"x", ",", "y", ",", 
            RowBox[{"ordPr", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"renumb", "[", 
            RowBox[{"rnk1", ",", 
             RowBox[{"ordPr", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "/@", 
           RowBox[{"Rest", "[", "ordPr", "]"}]}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"renumb", "[", 
     RowBox[{"rnk_", ",", "j_"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"j", ">", "b"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "-", "1"}], ",", 
       RowBox[{"b", "+", "rnk", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "-", "1"}], ",", 
       RowBox[{"b", "+", "rnk", "-", "2"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dotOne", "[", 
   RowBox[{"x_", ",", "y_", ",", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rnk1", "=", 
       RowBox[{"TensorRank", "[", "x", "]"}]}], ",", 
      RowBox[{"rnk2", "=", 
       RowBox[{"TensorRank", "[", "y", "]"}]}], ",", 
      RowBox[{"tmp$", "=", 
       RowBox[{"FormDegree", "[", "0", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tmp$", "===", "0"}], "&&", 
        RowBox[{
         RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}], "&&", 
        RowBox[{
         RowBox[{"FormDegree", "[", "y", "]"}], ">", "0"}]}], ",", 
       RowBox[{"tmp$", "=", "Wedge"}], ",", 
       RowBox[{"tmp$", "=", "Dot"}]}], "]"}], ";", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"tmp$", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"Range", "[", "rnk1", "]"}], "/.", "\[InvisibleSpace]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rnk1", "\[Rule]", "i"}], ",", 
              RowBox[{"i", "\[Rule]", "rnk1"}]}], "}"}]}]}], "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"Range", "[", "rnk2", "]"}], "/.", "\[InvisibleSpace]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"j", "\[Rule]", "1"}], ",", 
              RowBox[{"1", "\[Rule]", "j"}]}], "}"}]}]}], "]"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"i", "-", "1"}], "]"}], ",", 
         RowBox[{"RotateRight", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"i", ",", 
             RowBox[{"rnk1", "-", "1"}]}], "]"}], ",", "1"}], "]"}], ",", 
         RowBox[{"RotateLeft", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"rnk1", ",", 
             RowBox[{"rnk1", "+", "j", "-", "2"}]}], "]"}], ",", "1"}], "]"}],
          ",", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"rnk1", "+", "j", "-", "1"}], ",", 
           RowBox[{"rnk1", "+", "rnk2", "-", "2"}]}], "]"}]}], "]"}]}], 
      "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dotAll", "[", 
    RowBox[{"x_", ",", "y_", ",", "indPr_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s$", ",", "allInd", ",", "sumInd", ",", 
       RowBox[{"tmp$", "=", 
        RowBox[{"FormDegree", "[", "0", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"allInd", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"s$", ",", 
          RowBox[{"Transpose", "[", "indPr", "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"s$", "[", "i_", "]"}], ":>", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<s$\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}]}], ";", 
      RowBox[{"sumInd", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"allInd", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"Dim", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", 
              RowBox[{"allInd", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], "}"}],
         "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tmp$", "===", "0"}], "&&", 
         RowBox[{
          RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}], "&&", 
         RowBox[{
          RowBox[{"FormDegree", "[", "y", "]"}], ">", "0"}]}], ",", 
        RowBox[{"tmp$", "=", "Wedge"}], ",", 
        RowBox[{"tmp$", "=", "Times"}]}], "]"}], ";", 
      RowBox[{"Sum", "@@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Unevaluated", "[", 
          RowBox[{"tmp$", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"allInd", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"y", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"allInd", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Sequence", "@@", "sumInd"}]}], "}"}]}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Contract", "[", 
    RowBox[{"x_", ",", "indPr__"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rnk1", "=", 
        RowBox[{"TensorRank", "[", "x", "]"}]}], ",", 
       RowBox[{"indL", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "indPr", "}"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", "indL", "]"}], "]"}], "<", 
         RowBox[{"Length", "[", "indL", "]"}]}], "||", 
        RowBox[{
         RowBox[{"Length", "[", "indL", "]"}], ">", "rnk1"}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "[", "indL", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ">", "rnk1"}]}], ",", 
       RowBox[{"errWarn", ";", 
        RowBox[{"Return", "[", "]"}]}], ",", 
       RowBox[{"OKindCon", "[", 
        RowBox[{"x", ",", 
         RowBox[{"Sort", "[", 
          RowBox[{"Sort", "/@", 
           RowBox[{"{", "indPr", "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"newPrList", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rest", "[", "x", "]"}], "-", "1"}], "/.", 
    RowBox[{"k_", ":>", 
     RowBox[{
      RowBox[{"k", "-", "1"}], "/;", 
      RowBox[{"k", ">", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", "1"}]}]}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OKindCon", "[", 
    RowBox[{"x_", ",", "indPr_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FacSimp", "[", 
     RowBox[{"ConOne", "[", 
      RowBox[{"x", ",", 
       RowBox[{"indPr", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Length", "[", "indPr", "]"}], "===", "1"}]}]}], ";", 
  RowBox[{
   RowBox[{"OKindCon", "[", 
    RowBox[{"x_", ",", "indPr_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s$", ",", "allInd", ",", "sumInd"}], "}"}], ",", 
      RowBox[{
       RowBox[{"allInd", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"TensorRank", "[", "x", "]"}], "]"}], "/.", 
          RowBox[{"Apply", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"Apply", "[", 
             RowBox[{"Sequence", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"s$", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}], "}"}], "]"}], "&"}], 
                ",", "indPr"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}]}],
          "/.", 
         RowBox[{
          RowBox[{"s$", "[", "i_", "]"}], ":>", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<s$\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}]}], ";", 
       RowBox[{"sumInd", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Union", "[", "allInd", "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"Dim", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", "allInd", "]"}], "/", "2"}], "}"}]}], 
            "]"}]}], "}"}], "]"}]}], ";", 
       RowBox[{"FacSimp", "[", 
        RowBox[{"Sum", "@@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Unevaluated", "[", 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "allInd"}], "]"}], "]"}], "]"}], ",", 
           
           RowBox[{"Sequence", "@@", "sumInd"}]}], "}"}]}], "]"}]}]}], "]"}], 
    "/;", 
    RowBox[{
     RowBox[{"TensorRank", "[", "x", "]"}], "===", 
     RowBox[{"2", 
      RowBox[{"Length", "[", "indPr", "]"}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OKindCon", "[", 
    RowBox[{"x_", ",", "indPr_"}], "]"}], ":=", 
   RowBox[{"OKindCon", "[", 
    RowBox[{
     RowBox[{"ConOne", "[", 
      RowBox[{"x", ",", 
       RowBox[{"indPr", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"newPrList", "[", "indPr", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ConOne", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rnk1", "=", 
        RowBox[{"TensorRank", "[", "x", "]"}]}], ",", "tr1List", ",", 
       "tr2List"}], "}"}], ",", 
     RowBox[{
      RowBox[{"tr1List", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Range", "[", "rnk1", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"j", "->", "i"}], "}"}]}], ")"}], "/.", 
        RowBox[{"k_", ":>", 
         RowBox[{
          RowBox[{"k", "-", "1"}], "/;", 
          RowBox[{"k", ">", "j"}]}]}]}]}], ";", 
      RowBox[{"tr2List", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"i", "-", "1"}], "]"}], ",", 
         RowBox[{"RotateRight", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"i", ",", 
             RowBox[{"rnk1", "-", "1"}]}], "]"}], ",", "1"}], "]"}]}], 
        "]"}]}], ";", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"x", ",", "tr1List"}], "]"}], ",", "tr2List"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"rnk1", "-", "2"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"errWarn", ":=", 
   RowBox[{"stPrint", "[", 
    RowBox[{"\"\<Wrong tensor rank or number(s) of indices!\>\"", ",", "1"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"covDiv", "[", 
    RowBox[{"x_", ",", "UpList_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"covDiv", "[", 
     RowBox[{"x", ",", "UpList"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"TensorRank", "[", "x", "]"}]}], ",", "divInd", ",", 
        "allInd", ",", "freeInd", ",", "hhD", ",", "s", ",", "lt", ",", 
        "aInd"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", "UpList", "]"}], "]"}], ">", "k"}], "||", 
          
          RowBox[{
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"Flatten", "[", "UpList", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ">", "k"}], "||", 
          RowBox[{
           RowBox[{"Head", "[", "x", "]"}], "=!=", "List"}]}], ",", 
         RowBox[{"errWarn", ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "UpList", "]"}], ">", "1"}], ",", 
         RowBox[{"divInd", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"UpList", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "===", "List"}], "&"}]}], 
             "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"divInd", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "UpList", "}"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", "\t\t\t", 
       RowBox[{"allInd", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"aInd", "/@", 
           RowBox[{"Range", "[", "k", "]"}]}], ")"}], "/.", 
         RowBox[{
          RowBox[{"aInd", "[", "divInd", "]"}], "->", "s"}]}]}], ";", 
       RowBox[{"freeInd", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"allInd", ",", 
          RowBox[{
           RowBox[{"#", "=!=", "s"}], "&"}]}], "]"}]}], ";", 
       RowBox[{"Off", "[", 
        RowBox[{"Part", "::", "\"\<pspec\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lt", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"$VersionNumber", "<", "3.5"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"hhD", "[", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"Sequence", "@@", "allInd"}], "]"}], "]"}], ",", 
                 "s"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "Dim"}], "}"}]}], "]"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", "UpList", "]"}], ",", "i"}], "]"}],
                  ",", 
                 RowBox[{
                  RowBox[{"GUdd", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"allInd", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "s", ",", "j"}], 
                    "]"}], "]"}], 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"allInd", ",", "j", ",", "i"}], "]"}]}], "]"}], 
                   "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"GUdd", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "s", ",", 
                    RowBox[{"allInd", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], 
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"allInd", ",", "j", ",", "i"}], "]"}]}], "]"}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "Dim"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "k"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "Dim"}], "}"}]}], "]"}]}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"List", "[", 
                  RowBox[{"#", ",", "Dim"}], "]"}], "&"}], ",", "freeInd"}], 
               "]"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Unevaluated", "[", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"hhD", "[", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "allInd"}], "]"}], "]"}], ",", 
                  "s"}], "]"}], "+", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "UpList", "]"}], ",", "i"}], 
                    "]"}], ",", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"GUdd", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"allInd", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "s", ",", "j"}], 
                    "]"}], "]"}], 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"allInd", ",", "j", ",", "i"}], "]"}]}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "Dim"}], "}"}]}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"GUdd", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "s", ",", 
                    RowBox[{"allInd", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"allInd", ",", "j", ",", "i"}], "]"}]}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "Dim"}], "}"}]}], "]"}]}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "k"}], "}"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "Dim"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"List", "[", 
                  RowBox[{"#", ",", "Dim"}], "]"}], "&"}], ",", "freeInd"}], 
               "]"}], ")"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", " ", ">", "1"}], ",", 
         RowBox[{"lt", "=", 
          RowBox[{"Table", "@@", "lt"}]}], ",", 
         RowBox[{"lt", "=", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"pD", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "s$", "]"}], "]"}], ",", "s$"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s$", ",", "Dim"}], "}"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GUdd", "[", 
               RowBox[{"[", 
                RowBox[{"s$", ",", "s$", ",", "j"}], "]"}], "]"}], 
              RowBox[{"x", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "Dim"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"s$", ",", "Dim"}], "}"}]}], "]"}]}]}]}], "]"}], ";", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "\"\<pspec\>\""}], "]"}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"FaSi", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"lt", "/.", 
           RowBox[{"hhD", "->", "pD"}]}], "]"}], "]"}], "]"}]}]}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"covD", "[", 
    RowBox[{"x_List", ",", "y_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"covD", "[", 
     RowBox[{"x", ",", "y"}], "]"}], "=", 
    RowBox[{"c$D", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"covD", "[", 
    RowBox[{"x_", ",", "y_List"}], "]"}], ":=", "errWarn"}], ";", 
  RowBox[{
   RowBox[{"covD", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"covD", "[", "x", "]"}], "=", 
    RowBox[{"c$D", "[", "x", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c$D", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"UpList_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", "=", 
       RowBox[{"TensorRank", "[", "x", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "UpList", "]"}], ">", "0"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", "UpList", "]"}], "]"}], ">", "k"}], "||", 
           RowBox[{
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"Flatten", "[", "UpList", "]"}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ">", "k"}]}], 
          ")"}]}], ",", 
        RowBox[{"errWarn", ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "x", "]"}], "===", "List"}], ",", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"cDcomp", "[", 
           RowBox[{"x", ",", "k", ",", "UpList"}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"Dim", ",", 
            RowBox[{"{", 
             RowBox[{"k", "+", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"FaSi", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"pD", "[", 
            RowBox[{"x", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "Dim"}], "}"}]}], "]"}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cDcomp", "[", 
     RowBox[{"x_", ",", "rnk_", ",", 
      RowBox[{"UpList_", ":", 
       RowBox[{"{", "}"}]}]}], "]"}], "[", "y__", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y$", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ",", 
       RowBox[{"z$", "=", 
        RowBox[{
         RowBox[{"{", "y", "}"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"FaSi", "[", 
      RowBox[{
       RowBox[{"pD", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", 
           RowBox[{"Sequence", "@@", "y$"}], "]"}], "]"}], ",", "z$"}], "]"}],
        "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"UpList", ",", "i"}], "]"}], ",", 
           RowBox[{
            RowBox[{"GUdd", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"y$", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "z$", ",", "j"}], "]"}], 
             "]"}], 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"y$", ",", "j", ",", "i"}], "]"}]}], "]"}], "]"}]}], 
           ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"GUdd", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "z$", ",", 
                RowBox[{"y$", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"y$", ",", "j", ",", "i"}], "]"}]}], "]"}], "]"}]}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "rnk"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Bianchi", "[", "0", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp$", "=", 
       RowBox[{"covD", "[", "Rdddd", "]"}]}], "}"}], ",", 
     RowBox[{"FaSi", "[", 
      RowBox[{"indepTerms", "[", 
       RowBox[{"tmp$", "+", 
        RowBox[{"Transpose", "[", 
         RowBox[{"tmp$", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "3"}], "}"}]}], 
         "]"}], "+", 
        RowBox[{"Transpose", "[", 
         RowBox[{"tmp$", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "5", ",", "3", ",", "4"}], "}"}]}], 
         "]"}]}], "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Bianchi", "[", "1", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp$", "=", 
       RowBox[{"covD", "[", "Rdd", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "RUddd", "]"}], "===", "Symbol"}], ",", 
        RowBox[{"RUddd", "=", 
         RowBox[{"Raise", "[", 
          RowBox[{"Rdddd", ",", "1"}], "]"}]}]}], "]"}], ";", 
      RowBox[{"FaSi", "[", 
       RowBox[{"indepTerms", "[", 
        RowBox[{
         RowBox[{"covDiv", "[", 
          RowBox[{"RUddd", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "+", "tmp$", "-", 
         RowBox[{"Transpose", "[", 
          RowBox[{"tmp$", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], "]"}], 
       "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Bianchi", "[", "2", "]"}], ":=", 
   RowBox[{"indepTerms", "[", 
    RowBox[{"covDiv", "[", 
     RowBox[{"EUd", ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$PrePrint", "=", " ", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ByteCount", "[", "#", "]"}], " ", ">", " ", "200000"}], ",", 
      RowBox[{"Short", "[", 
       RowBox[{"#", ",", "100"}], "]"}], ",", " ", "#"}], "]"}], "&"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{
   "cDcomp", ",", "CF3d", ",", "ConOne", ",", "c$D", ",", "dotAll", ",", 
    "dotOne", ",", "epsilon", ",", "errWarn", ",", "FacSimp", ",", "FaSi", 
    ",", "indexList", ",", "inn", ",", "MF", ",", "MoveIndex", ",", 
    "newPrList", ",", "NPdefs", ",", "numb1", ",", "numb2", ",", "OKindCon", 
    ",", "redPlus", ",", "redTimes", ",", "renumb", ",", "RiemSym", ",", 
    "zeroTensor"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.652432276230204*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"7430500c-6483-4a45-9e10-3790e4b4aa57"]
}, Closed]],

Cell[CellGroupData[{

Cell["Higher dimensions", "Chapter",
 CellChangeTimes->{{3.739187548123968*^9, 
  3.739187549970181*^9}},ExpressionUUID->"43b43ced-02d5-44f2-ab23-\
6464cbfe9bd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7289867338919907`*^9, 3.7289867345109453`*^9}, {
   3.728986771359981*^9, 3.7289867714130898`*^9}, 3.728986912179791*^9, 
   3.728987318899911*^9, {3.728987847721098*^9, 3.7289878477766867`*^9}, {
   3.728988624929537*^9, 3.728988643175109*^9}, 3.7289891104639482`*^9, {
   3.7289897246388273`*^9, 3.728989737904036*^9}, 3.7297575285198174`*^9, {
   3.729759482383662*^9, 3.729759484747257*^9}, 3.729760691317608*^9, 
   3.7297608631410627`*^9, 3.729761141010128*^9, 3.729762259975236*^9, 
   3.729762757666398*^9, 3.729764770431529*^9, 3.729765089827795*^9, 
   3.7297652364681063`*^9, 3.729767073749632*^9, 3.729767120943416*^9, 
   3.7297672118212*^9, 3.729767516461615*^9, 3.729769234344637*^9, 
   3.729858221448113*^9, 3.72985852688632*^9, 3.7298586046574907`*^9, 
   3.729858737801342*^9, {3.729858897468779*^9, 3.729858919682989*^9}, 
   3.7300090010416*^9, 3.730009220494707*^9, 3.730009766287562*^9, 
   3.730009851464498*^9, 3.73001007068337*^9, {3.730011080828825*^9, 
   3.730011104505389*^9}, 3.7300116121215563`*^9, 3.730013213461378*^9, {
   3.7300136722790127`*^9, 3.7300136745430403`*^9}, 3.730017719945867*^9, 
   3.7300179456348753`*^9, 3.730018474653404*^9, 3.730022589874447*^9, 
   3.739165387973877*^9, {3.739165577337392*^9, 3.739165577423953*^9}, {
   3.7391656473837967`*^9, 3.739165673744275*^9}, 3.739165824951239*^9, 
   3.739167833058896*^9, 3.739187357881522*^9, {3.739187715622017*^9, 
   3.7391877157055407`*^9}, 3.739187887422082*^9, 3.739191077524032*^9, 
   3.739192001291335*^9, 3.739192163643269*^9, 3.739192206854464*^9, 
   3.739192577202381*^9, 3.7392485103466473`*^9, 3.739253386485968*^9, {
   3.739254793739903*^9, 3.7392547956187363`*^9}, 3.739265461361189*^9, {
   3.7392693454155703`*^9, 3.739269371330415*^9}, {3.739269976962812*^9, 
   3.739269978635479*^9}, 3.7393507182717743`*^9, {3.739350818287662*^9, 
   3.739350819309895*^9}, {3.739379695992358*^9, 3.739379696080147*^9}, {
   3.739380085023761*^9, 3.7393800851934013`*^9}, {3.739380472131962*^9, 
   3.7393804722441587`*^9}, 3.7395207094512653`*^9, 3.739520859988367*^9, {
   3.739601314927887*^9, 3.739601315002057*^9}, 3.7396086851059217`*^9, 
   3.7396090051842947`*^9, 3.739609050090455*^9, 3.7396091264181004`*^9, 
   3.742036780318589*^9, 3.742036917090535*^9, 3.742037194592857*^9, {
   3.742037404314431*^9, 3.742037404349394*^9}, 3.742037737389227*^9, 
   3.742040622570331*^9, 3.742040654392515*^9, 3.742040779367249*^9, 
   3.742041525478808*^9, 3.7420417687274847`*^9, {3.7420418191384363`*^9, 
   3.742041835500108*^9}, 3.7420418756553183`*^9, 3.742042415635481*^9, {
   3.7420429326004467`*^9, 3.7420429451190453`*^9}, 3.742042979940711*^9, 
   3.7420430314411297`*^9, 3.742043092327712*^9, 3.7420432188156147`*^9, {
   3.742043559285872*^9, 3.7420435988019667`*^9}, 3.7420436942356663`*^9, 
   3.74204390261753*^9, 3.7420440156516933`*^9, {3.742044118911632*^9, 
   3.742044145045458*^9}, {3.7420442916519127`*^9, 3.742044352584715*^9}, 
   3.74204491492572*^9, {3.827120730778708*^9, 3.82712074026291*^9}, {
   3.82712103068011*^9, 3.8271211047252607`*^9}, {3.827121330672319*^9, 
   3.8271213493835583`*^9}, {3.827121384166375*^9, 3.8271214156796637`*^9}, {
   3.8271214743165607`*^9, 3.827121476136641*^9}, 3.827121508526534*^9, {
   3.827121585366397*^9, 3.827121590055501*^9}, 3.827123364022616*^9, 
   3.827123462866392*^9, {3.827123626300115*^9, 3.827123695178184*^9}, 
   3.8271237344578333`*^9, {3.827130082782233*^9, 3.8271301109507103`*^9}, {
   3.8271303248842173`*^9, 3.8271303603397903`*^9}, {3.827462078483671*^9, 
   3.8274620803832703`*^9}, 3.8274633032354603`*^9, {3.827464149957054*^9, 
   3.827464226521943*^9}, {3.827464523928772*^9, 3.827464533478422*^9}, {
   3.827464670324975*^9, 3.827464723512499*^9}, 3.827464916991613*^9, 
   3.827465053011712*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"a89ee3fe-f6c1-4275-bdb8-6549be91eec4"],

Cell[CellGroupData[{

Cell["Setup", "Subchapter",
 CellChangeTimes->{{3.739187557310462*^9, 
  3.739187557726296*^9}},ExpressionUUID->"2f23f6d7-5d4f-43f0-8e92-\
18ad6574da54"],

Cell[CellGroupData[{

Cell["Check if save file exists", "Section",
 CellChangeTimes->{{3.827120476792161*^9, 
  3.827120479152342*^9}},ExpressionUUID->"d31f65e8-5024-447b-af79-\
dd497c203c54"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"FileExistsQ", "[", "\"\<metricFluctuations\>\"", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Range", "[", "9", "]"}], ">>", "\"\<metricFluctuations\>\""}]}],
    "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827120485030897*^9, 3.8271205717654552`*^9}, {
   3.8271207534691277`*^9, 3.827120753705183*^9}, 3.827123342126974*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"5ffac865-eab2-4938-90d8-b6748116a566"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup metric", "Section",
 CellChangeTimes->{{3.728648646377524*^9, 
  3.728648648659875*^9}},ExpressionUUID->"b1a920a6-22e6-4878-8453-\
d345d28b0b65"],

Cell[CellGroupData[{

Cell["Coordinates", "Subsubsection",
 CellChangeTimes->{{3.7391652080054407`*^9, 
  3.739165209521381*^9}},ExpressionUUID->"63dab14b-9bd7-4ad4-b5c4-\
d074afe7f3d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["\[Theta]", "1"], "=", "u"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xangular", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["\[Theta]", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739165159443267*^9, 3.739165163816283*^9}, {
   3.739191747791016*^9, 3.739191775399228*^9}, {3.742035456663703*^9, 
   3.742035501120831*^9}, {3.827463117104641*^9, 3.827463119353527*^9}, 
   3.827463202716967*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"82e705d8-7694-4f07-b70f-5845a45d6c2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric", "Subsubsection",
 CellChangeTimes->{{3.739165211062682*^9, 
  3.739165211722777*^9}},ExpressionUUID->"d6e3be46-244e-4783-8449-\
fa6e8634d5f7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"d\[CapitalOmega]", "[", "1", "]"}], "=", 
   RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[CapitalOmega]", "[", 
   RowBox[{"i_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    FractionBox["1", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"K", " ", 
        SuperscriptBox[
         SubscriptBox["\[Theta]", 
          RowBox[{"n", "-", "i", "+", "1"}]], "2"]}]}], ")"}]], "}"}], "~", 
   "Join", "~", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"K", " ", 
        SuperscriptBox[
         SubscriptBox["\[Theta]", 
          RowBox[{"n", "-", "i", "+", "1"}]], "2"]}]}], ")"}], 
     RowBox[{"d\[CapitalOmega]", "[", 
      RowBox[{"i", "-", "1"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gdd", "=", 
   RowBox[{
    RowBox[{"d\[CapitalOmega]", "[", "n", "]"}], "//", "DiagonalMatrix"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"g", "=", 
  RowBox[{
   RowBox[{"Det", "[", "gdd", "]"}], "//", "FullSimplify"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.73916522837589*^9, 3.739165228617202*^9}, {
  3.739191786095564*^9, 3.739191789512124*^9}, {3.742035484018749*^9, 
  3.742035505756844*^9}, {3.827120200663766*^9, 3.827120201430128*^9}, {
  3.827463143609618*^9, 3.827463148851737*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"eebbf521-242a-4047-903f-c23dd564d0c8"],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"K", " ", 
   SuperscriptBox["u", "2"]}]}]], "Output",
 CellChangeTimes->{{3.739191916539753*^9, 3.7391919445345907`*^9}, 
   3.7391920142014103`*^9, 3.739192176688714*^9, 3.739192215764917*^9, 
   3.7391925900343237`*^9, 3.739248290412097*^9, 3.739248332268186*^9, 
   3.7392485159233294`*^9, 3.739253391049624*^9, 3.739254800742239*^9, 
   3.7392654668809137`*^9, {3.73926932979205*^9, 3.7392693790892553`*^9}, 
   3.739269984342492*^9, 3.7393507293569*^9, 3.7393508259274683`*^9, 
   3.7393795283680563`*^9, 3.7393797148496323`*^9, 3.7393800620822153`*^9, 
   3.739380218558934*^9, 3.7393804232407084`*^9, 3.7393804907261057`*^9, 
   3.739520717317115*^9, 3.7395208662183647`*^9, 3.739601325747813*^9, 
   3.739608688130395*^9, 3.739608869101357*^9, 3.739609013383602*^9, 
   3.7396090619642487`*^9, 3.739609136546467*^9, 3.741676884274063*^9, 
   3.7420348871196213`*^9, {3.742035484745858*^9, 3.7420355060757723`*^9}, 
   3.742036787736497*^9, 3.742036921939063*^9, 3.7420371994554367`*^9, 
   3.742037408892963*^9, 3.742037742855845*^9, 3.7420406273828907`*^9, 
   3.742040659460504*^9, 3.742040784136629*^9, 3.74204153069984*^9, 
   3.7420417736309547`*^9, {3.742041824170238*^9, 3.74204184173792*^9}, 
   3.742041881682675*^9, 3.742042420718402*^9, 3.742042685135233*^9, {
   3.742042768699267*^9, 3.7420427921749268`*^9}, 3.742042836376511*^9, {
   3.742042925770212*^9, 3.742042951433786*^9}, 3.7420429846881533`*^9, 
   3.7420430383938417`*^9, 3.7420430997338676`*^9, 3.742043225392761*^9, {
   3.742043565095696*^9, 3.74204360816529*^9}, 3.742043700100429*^9, 
   3.742043910840933*^9, 3.742044046491125*^9, {3.742044127208387*^9, 
   3.742044151942102*^9}, {3.7420442968679943`*^9, 3.742044361779037*^9}, 
   3.742044920453814*^9, 3.8271204186761227`*^9, 3.827120948333012*^9, {
   3.827121018891737*^9, 3.82712109323421*^9}, {3.8271213396510887`*^9, 
   3.827121429006431*^9}, 3.8271214857866583`*^9, 3.827121545595326*^9, 
   3.8271217084388866`*^9, 3.8271233793495493`*^9, 3.827123472460649*^9, {
   3.827123636403916*^9, 3.827123704787291*^9}, 3.827123743497357*^9, 
   3.827128608950633*^9, 3.827130010321692*^9, {3.8271300747276497`*^9, 
   3.827130113818759*^9}, {3.8271303338040333`*^9, 3.827130359924705*^9}, 
   3.8271304129864073`*^9, 3.8274620989831533`*^9, 3.827463182387578*^9, 
   3.827463215444501*^9, 3.827463318910433*^9, 3.827463389824685*^9, {
   3.8274641548057613`*^9, 3.827464226935062*^9}, 3.827464274442514*^9, {
   3.8274645333037043`*^9, 3.8274645414203587`*^9}, {3.827464660470983*^9, 
   3.827464723807645*^9}, 3.827464766530437*^9, 3.827464938522415*^9, 
   3.827465060647437*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"67b22208-b144-448e-9d4a-044004d9c55e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Riemann etc.", "Subsubsection",
 CellChangeTimes->{{3.739165268125195*^9, 
  3.7391652720327063`*^9}},ExpressionUUID->"a02ff963-32f4-4df5-b444-\
ffeaa6d0e4e4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Print", "=", "dontprint"}], ",", 
       RowBox[{"StylePrint", "=", "dontprint"}]}], "}"}], ",", 
     RowBox[{"RGtensors", "[", 
      RowBox[{"gdd", ",", " ", "Xangular"}], "]"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  FractionBox["R", 
   RowBox[{"K", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}]], "//", "FullSimplify"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7298582740228033`*^9, 3.729858277064014*^9}, {
   3.729858913199738*^9, 3.729858945195147*^9}, 3.729859240915738*^9, 
   3.729859546157143*^9, 3.74204242290897*^9, 3.827120202846376*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"b2a6e114-de99-4ed4-b135-431d807df787"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.017797`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.739191916672433*^9, 3.7391919448060427`*^9}, 
   3.7391920143213367`*^9, 3.739192176899186*^9, 3.739192216060302*^9, 
   3.739192590217759*^9, 3.7392482905285177`*^9, 3.739248332586775*^9, 
   3.739248516023834*^9, 3.739253391167989*^9, 3.7392548009432583`*^9, 
   3.7392654670160303`*^9, {3.7392693299079647`*^9, 3.739269379487505*^9}, 
   3.739269984454605*^9, 3.739350729810205*^9, 3.73935082714252*^9, {
   3.739379530876564*^9, 3.7393795452657013`*^9}, 3.739379717613543*^9, 
   3.7393800648104343`*^9, 3.739380225677347*^9, 3.739380432982575*^9, 
   3.7393804935819073`*^9, 3.739520717397254*^9, 3.739520866313097*^9, 
   3.739601325947753*^9, 3.7396087170788183`*^9, 3.7396088693622932`*^9, 
   3.739609014324745*^9, 3.7396090633023252`*^9, 3.7396091369879436`*^9, 
   3.7416768845424757`*^9, 3.742034887294155*^9, {3.742035487492111*^9, 
   3.742035507525467*^9}, 3.7420367878566628`*^9, 3.742036922258542*^9, 
   3.74203719957123*^9, 3.74203740901937*^9, 3.742037743004425*^9, 
   3.742040627647723*^9, 3.742040659640977*^9, 3.742040784281678*^9, 
   3.742041530882482*^9, 3.742041773870659*^9, {3.742041824269401*^9, 
   3.742041842185896*^9}, 3.7420418820544147`*^9, 3.7420424208188562`*^9, 
   3.7420426852651033`*^9, {3.74204276885184*^9, 3.7420427923021727`*^9}, 
   3.7420428364872007`*^9, {3.742042925863489*^9, 3.7420429516797123`*^9}, 
   3.7420429849298363`*^9, 3.742043038954792*^9, 3.742043100623774*^9, 
   3.742043225572748*^9, {3.742043565225787*^9, 3.74204360846382*^9}, 
   3.74204370050506*^9, 3.742043911029513*^9, 3.74204404679451*^9, {
   3.742044127343381*^9, 3.742044152092238*^9}, {3.742044297022336*^9, 
   3.742044362245311*^9}, 3.742044920577094*^9, 3.827120418713382*^9, 
   3.8271209483843307`*^9, {3.827121018920062*^9, 3.8271210932992363`*^9}, {
   3.8271213397068853`*^9, 3.827121429361343*^9}, 3.82712148717404*^9, 
   3.8271215482299433`*^9, 3.827121716299445*^9, 3.827123382059656*^9, 
   3.827123473871468*^9, {3.8271236367329187`*^9, 3.827123704835737*^9}, 
   3.827123743545569*^9, 3.827128608980497*^9, 3.8271300103541603`*^9, {
   3.827130074761066*^9, 3.8271301138830853`*^9}, {3.827130333948309*^9, 
   3.8271303607522087`*^9}, 3.827130415591317*^9, 3.827462099015808*^9, 
   3.827463182410202*^9, 3.827463215493415*^9, 3.8274633189337587`*^9, 
   3.8274633898479023`*^9, {3.827464154836473*^9, 3.827464228349881*^9}, 
   3.8274642768404512`*^9, {3.827464533332836*^9, 3.827464541442875*^9}, {
   3.827464660504771*^9, 3.8274647251996307`*^9}, 3.8274647689031067`*^9, 
   3.827464938546173*^9, 3.827465060669735*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"18034e26-cb8c-48aa-8a8e-483da7fc5b72"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.739191916672433*^9, 3.7391919448060427`*^9}, 
   3.7391920143213367`*^9, 3.739192176899186*^9, 3.739192216060302*^9, 
   3.739192590217759*^9, 3.7392482905285177`*^9, 3.739248332586775*^9, 
   3.739248516023834*^9, 3.739253391167989*^9, 3.7392548009432583`*^9, 
   3.7392654670160303`*^9, {3.7392693299079647`*^9, 3.739269379487505*^9}, 
   3.739269984454605*^9, 3.739350729810205*^9, 3.73935082714252*^9, {
   3.739379530876564*^9, 3.7393795452657013`*^9}, 3.739379717613543*^9, 
   3.7393800648104343`*^9, 3.739380225677347*^9, 3.739380432982575*^9, 
   3.7393804935819073`*^9, 3.739520717397254*^9, 3.739520866313097*^9, 
   3.739601325947753*^9, 3.7396087170788183`*^9, 3.7396088693622932`*^9, 
   3.739609014324745*^9, 3.7396090633023252`*^9, 3.7396091369879436`*^9, 
   3.7416768845424757`*^9, 3.742034887294155*^9, {3.742035487492111*^9, 
   3.742035507525467*^9}, 3.7420367878566628`*^9, 3.742036922258542*^9, 
   3.74203719957123*^9, 3.74203740901937*^9, 3.742037743004425*^9, 
   3.742040627647723*^9, 3.742040659640977*^9, 3.742040784281678*^9, 
   3.742041530882482*^9, 3.742041773870659*^9, {3.742041824269401*^9, 
   3.742041842185896*^9}, 3.7420418820544147`*^9, 3.7420424208188562`*^9, 
   3.7420426852651033`*^9, {3.74204276885184*^9, 3.7420427923021727`*^9}, 
   3.7420428364872007`*^9, {3.742042925863489*^9, 3.7420429516797123`*^9}, 
   3.7420429849298363`*^9, 3.742043038954792*^9, 3.742043100623774*^9, 
   3.742043225572748*^9, {3.742043565225787*^9, 3.74204360846382*^9}, 
   3.74204370050506*^9, 3.742043911029513*^9, 3.74204404679451*^9, {
   3.742044127343381*^9, 3.742044152092238*^9}, {3.742044297022336*^9, 
   3.742044362245311*^9}, 3.742044920577094*^9, 3.827120418713382*^9, 
   3.8271209483843307`*^9, {3.827121018920062*^9, 3.8271210932992363`*^9}, {
   3.8271213397068853`*^9, 3.827121429361343*^9}, 3.82712148717404*^9, 
   3.8271215482299433`*^9, 3.827121716299445*^9, 3.827123382059656*^9, 
   3.827123473871468*^9, {3.8271236367329187`*^9, 3.827123704835737*^9}, 
   3.827123743545569*^9, 3.827128608980497*^9, 3.8271300103541603`*^9, {
   3.827130074761066*^9, 3.8271301138830853`*^9}, {3.827130333948309*^9, 
   3.8271303607522087`*^9}, 3.827130415591317*^9, 3.827462099015808*^9, 
   3.827463182410202*^9, 3.827463215493415*^9, 3.8274633189337587`*^9, 
   3.8274633898479023`*^9, {3.827464154836473*^9, 3.827464228349881*^9}, 
   3.8274642768404512`*^9, {3.827464533332836*^9, 3.827464541442875*^9}, {
   3.827464660504771*^9, 3.8274647251996307`*^9}, 3.8274647689031067`*^9, 
   3.827464938546173*^9, 3.827465060671548*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"9b0b4e5b-a918-4c0c-a505-a849bd3f9252"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar equation", "Section",
 CellChangeTimes->{{3.739165405639711*^9, 
  3.739165407607911*^9}},ExpressionUUID->"91dfc4f1-02dd-4b2a-b06c-\
d0f62b9a6839"],

Cell[CellGroupData[{

Cell["\[Square]S", "Subsubsection",
 CellChangeTimes->{{3.739165411293722*^9, 
  3.739165413732201*^9}},ExpressionUUID->"5fb54085-44bc-478f-9185-\
710a9b21453d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P0", "=", 
   RowBox[{"P", "[", "u", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dP0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "i"], "P0"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "Xangular"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dP0U", "=", 
   RowBox[{"gUU", ".", "dP0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sqrtg", "=", 
   RowBox[{
    SqrtBox["g"], "//", "PowerExpand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"boxP", "=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "sqrtg"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], "n"], 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{
       "Xangular", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], 
      RowBox[{"(", 
       RowBox[{"sqrtg", " ", 
        RowBox[{
        "dP0U", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ")"}]}]}]}], "//", "Simplify"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739165309601705*^9, 3.739165358276366*^9}, {
  3.739379437920836*^9, 3.739379490962426*^9}, {3.739379635388504*^9, 
  3.739379673494445*^9}, {3.739380022010037*^9, 3.739380033211478*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"485a5346-4d4d-4e9c-bb55-ba42ed9518ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", "K", " ", "u", " ", 
   RowBox[{
    SuperscriptBox["P", "\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"K", " ", 
      SuperscriptBox["u", "2"]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["P", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8271204187502117`*^9, 3.8271209483980083`*^9, {3.827121018951672*^9, 
   3.827121093334608*^9}, {3.82712133975732*^9, 3.827121429397414*^9}, 
   3.8271214872968817`*^9, 3.827121548433881*^9, 3.8271217164603453`*^9, 
   3.8271233821810627`*^9, 3.827123473970224*^9, {3.827123636772272*^9, 
   3.827123704896138*^9}, 3.827123743598155*^9, 3.827128609005352*^9, 
   3.827130010378127*^9, {3.8271300747757797`*^9, 3.8271301138986473`*^9}, {
   3.827130333970104*^9, 3.827130360773958*^9}, 3.827130415654149*^9, 
   3.8274620990316772`*^9, 3.8274631824878263`*^9, 3.827463215543997*^9, 
   3.8274633189567842`*^9, 3.827463389872634*^9, 3.8274641548450737`*^9, {
   3.8274641851313467`*^9, 3.827464228446083*^9}, 3.827464276942286*^9, {
   3.8274645333628063`*^9, 3.827464541465691*^9}, {3.827464660539976*^9, 
   3.827464725285836*^9}, 3.827464768999167*^9, 3.8274649385748672`*^9, 
   3.827465060694003*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"967d626c-1de3-4c63-af52-795ffaaab658"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["equation", "Subsubsection",
 CellChangeTimes->{{3.739165418956313*^9, 
  3.739165419456725*^9}},ExpressionUUID->"424b0e80-1eb7-4b7c-ad46-\
bf21e7c137f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqP", "=", 
  RowBox[{"boxP", "+", 
   RowBox[{
    SuperscriptBox["k", "2"], "P0"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739165425354258*^9, 3.73916543281708*^9}, {
  3.739379497040131*^9, 3.7393795025977983`*^9}, {3.8271202294207697`*^9, 
  3.8271202303206997`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"eff33e32-74ed-46da-9e44-a352eaf66f55"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["k", "2"], " ", 
   RowBox[{"P", "[", "u", "]"}]}], "-", 
  RowBox[{"3", " ", "K", " ", "u", " ", 
   RowBox[{
    SuperscriptBox["P", "\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"K", " ", 
      SuperscriptBox["u", "2"]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["P", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.827120418756122*^9, 3.827120948438303*^9, {3.8271210189576797`*^9, 
   3.827121093339147*^9}, {3.827121339765378*^9, 3.827121429403508*^9}, 
   3.827121487302549*^9, 3.8271215484403553`*^9, 3.827121716466296*^9, 
   3.827123382189068*^9, 3.8271234739763403`*^9, {3.8271236367777033`*^9, 
   3.827123704902998*^9}, 3.827123743606592*^9, 3.82712860901128*^9, 
   3.827130010384986*^9, {3.8271300748070717`*^9, 3.827130113904109*^9}, {
   3.827130333976535*^9, 3.8271303607795467`*^9}, 3.827130415661069*^9, 
   3.827462099057996*^9, 3.8274631824938087`*^9, 3.827463215551125*^9, 
   3.82746331896318*^9, 3.827463389879451*^9, {3.827464154869069*^9, 
   3.827464228454627*^9}, 3.8274642769499702`*^9, {3.827464533370469*^9, 
   3.827464541472732*^9}, {3.8274646605481462`*^9, 3.8274647252936983`*^9}, 
   3.827464769006096*^9, 3.827464938581646*^9, 3.827465060700726*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"83053785-9f1e-4e1e-94f1-93194c53ef3c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution", "Subsubsection",
 CellChangeTimes->{{3.739165508107482*^9, 
  3.739165508801506*^9}},ExpressionUUID->"e74be2dc-e595-4658-9bb1-\
bc196a3308d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Prule", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"eqP", "\[Equal]", "0"}], ",", 
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"{", 
           RowBox[{"u", ",", "2"}], "}"}]], "P0"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "//", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", 
        RowBox[{"_", "[", "u", "]"}], ",", "Simplify"}], "]"}], "&"}]}], 
    ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["n_", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["u", "2"], " ", "K"}]}]], "\[RuleDelayed]", 
      FractionBox[
       RowBox[{"-", "n"}], 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox["u", "2"], " ", "K"}]}]]}], ",", 
     RowBox[{
      FractionBox["n_", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", "K"}]}], ")"}], "2"]], 
      "\[RuleDelayed]", 
      FractionBox["n", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", "K"}]}], ")"}], "2"]]}]}], 
    "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739165471183556*^9, 3.739165492936963*^9}, 
   3.739165609554573*^9, {3.739379577377104*^9, 3.7393795910328617`*^9}, {
   3.827120221229322*^9, 3.827120252279002*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"335836a3-b93b-4405-925c-5d717d4f83f2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["P", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "u", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"P", "[", "u", "]"}]}], 
      RowBox[{"1", "-", 
       RowBox[{"K", " ", 
        SuperscriptBox["u", "2"]}]}]]}], "+", 
    FractionBox[
     RowBox[{"3", " ", "K", " ", "u", " ", 
      RowBox[{
       SuperscriptBox["P", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], 
     RowBox[{"1", "-", 
      RowBox[{"K", " ", 
       SuperscriptBox["u", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739191916968408*^9, 3.7391919452804813`*^9}, 
   3.739192015093751*^9, 3.73919217756045*^9, 3.739192217497568*^9, 
   3.739192591104458*^9, 3.7392482908682632`*^9, 3.739248333605156*^9, 
   3.73924851637925*^9, 3.7392533917317867`*^9, 3.7392548022416477`*^9, 
   3.7392654688632402`*^9, {3.739269330254685*^9, 3.7392693866862717`*^9}, 
   3.739269985528247*^9, 3.739350791090281*^9, 3.739352315946228*^9, 
   3.739379591570126*^9, 3.739380065267126*^9, 3.739380226317802*^9, 
   3.739380433510461*^9, 3.7393804940088043`*^9, 3.739520717777164*^9, 
   3.739520866582485*^9, 3.739601326593548*^9, 3.73960887064144*^9, 
   3.739609015383428*^9, 3.7396090643367968`*^9, 3.739609138035266*^9, 
   3.741676885470417*^9, 3.742034887589102*^9, 3.742036788188068*^9, 
   3.742036922650991*^9, 3.742037199859242*^9, 3.742037409360927*^9, 
   3.7420377433603973`*^9, 3.742040627999837*^9, 3.7420406599828997`*^9, 
   3.7420407846194897`*^9, 3.742041531513166*^9, 3.742041774638019*^9, {
   3.742041824653378*^9, 3.742041842535202*^9}, 3.742041882408585*^9, 
   3.742042421106469*^9, 3.7420426856471443`*^9, {3.7420427694280577`*^9, 
   3.742042792919264*^9}, 3.742042836870644*^9, {3.742042926157477*^9, 
   3.742042952007395*^9}, 3.742042985256308*^9, 3.74204303953647*^9, 
   3.742043101061823*^9, 3.742043225916231*^9, {3.742043565543095*^9, 
   3.742043608893736*^9}, 3.74204370094186*^9, 3.7420439114224777`*^9, 
   3.74204404730971*^9, {3.74204412772961*^9, 3.7420441524772873`*^9}, {
   3.742044297403307*^9, 3.742044362688944*^9}, 3.742044920905715*^9, 
   3.8271204187927628`*^9, 3.827120948485238*^9, {3.827121018987197*^9, 
   3.8271210933455048`*^9}, {3.827121339814098*^9, 3.827121429442*^9}, 
   3.827121487341374*^9, 3.827121548509119*^9, 3.827121716510548*^9, 
   3.8271233822328053`*^9, 3.827123474019302*^9, {3.82712363681947*^9, 
   3.827123704955422*^9}, 3.8271237436552773`*^9, 3.8271286090343857`*^9, 
   3.827130010410598*^9, {3.8271300748387833`*^9, 3.8271301139142714`*^9}, {
   3.827130333999083*^9, 3.827130360798848*^9}, 3.827130415686235*^9, 
   3.827462099085533*^9, 3.8274631825187273`*^9, 3.827463215571135*^9, 
   3.8274633189866247`*^9, 3.827463389902184*^9, {3.827464155078104*^9, 
   3.827464228483993*^9}, 3.827464276979961*^9, {3.827464533393964*^9, 
   3.8274645414949417`*^9}, {3.827464660584262*^9, 3.827464725321286*^9}, 
   3.827464769034903*^9, 3.827464938604705*^9, 3.827465060722353*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"0c317c7d-4b5b-4aeb-a282-e79d87ebd78c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Prule", "/.", 
  RowBox[{"\[Gamma]", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.73960880062504*^9, 3.739608802534114*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"be68aea0-6bba-4eb8-8a29-7b330d49603c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["P", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "u", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"P", "[", "u", "]"}]}], 
      RowBox[{"1", "-", 
       RowBox[{"K", " ", 
        SuperscriptBox["u", "2"]}]}]]}], "+", 
    FractionBox[
     RowBox[{"4", " ", "K", " ", "u", " ", 
      RowBox[{
       SuperscriptBox["P", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], 
     RowBox[{"1", "-", 
      RowBox[{"K", " ", 
       SuperscriptBox["u", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.739608802964532*^9, {3.742042769568474*^9, 3.7420427930694237`*^9}, {
   3.8271210465656347`*^9, 3.827121093382826*^9}, 3.827128609040339*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"9c70808c-bbe6-4448-be14-c363e1d18c6e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor components", "Subchapter",
 CellChangeTimes->{{3.7391657311277018`*^9, 
  3.739165733012116*^9}},ExpressionUUID->"47be451c-5626-4df3-84b7-\
5425a845a685"],

Cell[CellGroupData[{

Cell["Vectors", "Section",
 CellChangeTimes->{{3.739165736330415*^9, 
  3.739165737021036*^9}},ExpressionUUID->"efe34e0c-7db7-4116-a2d3-\
de2b51f6fe6c"],

Cell[CellGroupData[{

Cell["Polar", "Subsubsection",
 CellChangeTimes->{{3.739187592345533*^9, 
  3.7391875927758636`*^9}},ExpressionUUID->"1e442c5d-702b-42b6-be22-\
7f7d98273997"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"P0", ",", "#"}], "]"}], "&"}], "/@", "Xangular"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[74]:=",ExpressionUUID->"3436c4d5-7524-4d82-8261-f857208cacb1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["P", "\[Prime]",
     MultilineFunction->None], "[", "u", "]"}], ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.739191917154085*^9, 3.739191945751899*^9}, 
   3.7391920155586643`*^9, 3.739192178046322*^9, 3.7391922178455343`*^9, 
   3.739192591412315*^9, 3.739248291037347*^9, 3.739248334039172*^9, 
   3.739248516572225*^9, 3.73925339201705*^9, 3.73925480249305*^9, 
   3.739265469054962*^9, {3.7392693305398407`*^9, 3.739269387431473*^9}, 
   3.739269985745281*^9, 3.73935079128575*^9, 3.739352316337699*^9, 
   3.739380065401825*^9, 3.739380226503126*^9, 3.7393804336271753`*^9, 
   3.739380494141904*^9, 3.739520717877009*^9, 3.7395208666827297`*^9, 
   3.739601326864605*^9, 3.739608871039404*^9, 3.739609016358395*^9, 
   3.739609064809574*^9, 3.7396091385348377`*^9, 3.741676885703135*^9, 
   3.742034887737627*^9, 3.742036788321892*^9, 3.742036922879171*^9, 
   3.742037199960821*^9, 3.742037409515818*^9, 3.742037743561852*^9, 
   3.742040628133801*^9, 3.742040660172675*^9, 3.7420407847543287`*^9, 
   3.742041531847828*^9, 3.7420417747860403`*^9, {3.742041824788028*^9, 
   3.742041842741982*^9}, 3.742041882717664*^9, 3.742042421207152*^9, 
   3.742042685781012*^9, {3.742042769821355*^9, 3.74204279331951*^9}, 
   3.7420428370214977`*^9, {3.7420429262528553`*^9, 3.7420429521214046`*^9}, 
   3.7420429853941*^9, 3.742043039670226*^9, 3.742043101195488*^9, 
   3.742043226033338*^9, {3.7420435656636047`*^9, 3.742043609160228*^9}, 
   3.742043701075795*^9, 3.742043911555769*^9, 3.7420440474609833`*^9, {
   3.742044127906287*^9, 3.742044152629612*^9}, {3.742044297538178*^9, 
   3.742044362833187*^9}, 3.7420449210401917`*^9, 3.82712041879827*^9, 
   3.8271209484908733`*^9, {3.8271210189933453`*^9, 3.827121093388475*^9}, {
   3.8271213398195963`*^9, 3.827121429450602*^9}, 3.827121487347139*^9, 
   3.827121548515049*^9, 3.82712171651693*^9, 3.8271233822397614`*^9, 
   3.827123474058605*^9, {3.827123636825366*^9, 3.8271237049639397`*^9}, 
   3.8271237436617947`*^9, 3.827128609062883*^9, 3.827130010417082*^9, {
   3.827130074845943*^9, 3.827130113920616*^9}, {3.8271303340065813`*^9, 
   3.827130360805448*^9}, 3.8271304156935797`*^9, 3.827462099092156*^9, 
   3.827463182524852*^9, 3.8274632155773697`*^9, 3.8274633189930553`*^9, 
   3.827463389908821*^9, {3.8274641550835543`*^9, 3.827464228491085*^9}, 
   3.8274642769864492`*^9, {3.827464533402766*^9, 3.8274645415025873`*^9}, {
   3.827464660591051*^9, 3.827464725329297*^9}, 3.8274647690417957`*^9, 
   3.827464938612821*^9, 3.827465060729597*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"b49091ff-13be-4e48-9b63-e01df32d6579"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["axial", "Subsubsection",
 CellChangeTimes->{{3.739187602447112*^9, 
  3.7391876028978357`*^9}},ExpressionUUID->"32881243-7855-47d6-bfd0-\
885684ed56c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"boxV", "[", "V_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"covDiv", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"covD", "[", "V", "]"}], ".", "gUU"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//.", 
    RowBox[{"Prule", "~", "Join", "~", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Prule", ",", "#"}], "]"}], "&"}], "/@", "Xangular"}], "]"}],
      "~", "Join", "~", "Prule", "~", "Join", "~", 
     RowBox[{"D", "[", 
      RowBox[{"Prule", ",", "u"}], "]"}]}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqVa", "[", "V_", "]"}], ":=", 
  RowBox[{
   RowBox[{"boxV", "[", "V", "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k", "2"], "-", " ", "K"}], ")"}], 
    "V"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqVp", "[", "V_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"boxV", "[", "V", "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k", "2"], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "K"}]}], ")"}], "V"}]}], "//.", 
    RowBox[{"Prule", "~", "Join", "~", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Prule", ",", "#"}], "]"}], "&"}], "/@", "Xangular"}], "]"}],
      "~", "Join", "~", "Prule", "~", "Join", "~", 
     RowBox[{"D", "[", 
      RowBox[{"Prule", ",", "u"}], "]"}]}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divV", "[", "V_", "]"}], ":=", 
  RowBox[{"covDiv", "[", 
   RowBox[{
    RowBox[{"gUU", ".", "V"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739167390671953*^9, 3.7391674188754177`*^9}, {
   3.7391674932832737`*^9, 3.739167529826623*^9}, {3.739167596894416*^9, 
   3.739167601170656*^9}, {3.739167890867058*^9, 3.739167930577553*^9}, 
   3.739167985687766*^9, {3.739168185678425*^9, 3.739168199850954*^9}, {
   3.739168278693993*^9, 3.739168288673774*^9}, {3.739178522220707*^9, 
   3.739178522413821*^9}, {3.739183577215025*^9, 3.7391835778417673`*^9}, {
   3.739380266380517*^9, 3.739380271053812*^9}, {3.827120267052001*^9, 
   3.827120267918103*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"a3fc6f1c-54d4-4802-8755-b2c90301a1f6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Va", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"n", "-", "1"}], "}"}]}], "]"}], "~", "Join", "~", 
   RowBox[{"{", 
    RowBox[{"PV", "[", "u", "]"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"divVa", "=", 
  RowBox[{"divV", "[", "Va", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eqnVa", "=", 
  RowBox[{
   RowBox[{"boxV", "[", "Va", "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k", "2"], "-", 
      RowBox[{"1", " ", "K"}]}], ")"}], "Va"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prodVpVa", "=", 
   RowBox[{"Vp", ".", "gUU", ".", "Va"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tmpeqs", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "divVa", "}"}], "~", "Join", "~", "eqnVa", "~", "Join", "~", 
    
    RowBox[{"{", "prodVpVa", "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"PVrule", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tmpeqs", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"PV", "''"}], "[", "u", "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "[", "u", "]"}], ",", "k"}], "}"}], ",", 
      "FullSimplify"}], "]"}], "&"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739187605268602*^9, 3.73918761539769*^9}, {
   3.7391877536360598`*^9, 3.73918780971859*^9}, {3.7391918010155907`*^9, 
   3.739191803325452*^9}, {3.739191935106422*^9, 3.73919193525333*^9}, {
   3.7392478146104603`*^9, 3.739247828425509*^9}, 3.739608843135542*^9, 
   3.82712026879416*^9},
 CellLabel->"In[79]:=",ExpressionUUID->"7e0d3ead-1270-4a59-834f-287f1f49b84b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"PV", "[", "u", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739191917262092*^9, 3.7391919460285797`*^9}, 
   3.739192015807609*^9, 3.739192178264247*^9, 3.739192218228044*^9, 
   3.739192591607321*^9, {3.739247817682075*^9, 3.73924782929382*^9}, 
   3.73924829116998*^9, 3.739248334429597*^9, 3.7392485167046003`*^9, 
   3.7392533921681137`*^9, 3.73925480271399*^9, 3.73926546920503*^9, {
   3.739269330847773*^9, 3.7392693880947323`*^9}, 3.739269986626227*^9, 
   3.739350791431426*^9, 3.7393523165922623`*^9, 3.7393800655487556`*^9, 
   3.7393802266832*^9, 3.739380272996051*^9, 3.739380433777*^9, 
   3.7393804942901573`*^9, 3.7395207179791183`*^9, 3.739520866784618*^9, 
   3.739601327029677*^9, {3.739608844277238*^9, 3.7396088714743013`*^9}, 
   3.739609016896166*^9, 3.739609065064046*^9, 3.739609138797864*^9, 
   3.741676885977689*^9, 3.742034887874125*^9, 3.742036788440463*^9, 
   3.742036923028064*^9, 3.7420372000620537`*^9, 3.742037409635128*^9, 
   3.742037743709496*^9, 3.742040628380228*^9, 3.7420406602992268`*^9, 
   3.742040784903356*^9, 3.742041531996169*^9, 3.742041774929689*^9, {
   3.7420418249363623`*^9, 3.742041842870819*^9}, 3.742041883039063*^9, 
   3.742042421314271*^9, 3.742042686065309*^9, {3.742042769969434*^9, 
   3.742042793501487*^9}, 3.74204283730835*^9, {3.742042926378606*^9, 
   3.742042952308404*^9}, 3.7420429855886583`*^9, 3.742043039801569*^9, 
   3.742043101327319*^9, 3.742043226147025*^9, {3.7420435657914953`*^9, 
   3.7420436093271303`*^9}, 3.7420437012091513`*^9, 3.742043911787212*^9, 
   3.742044047624681*^9, {3.742044128128077*^9, 3.742044152863278*^9}, {
   3.7420442977542543`*^9, 3.742044362964744*^9}, 3.742044921155044*^9, 
   3.827120418841503*^9, 3.827120948539556*^9, {3.8271210190286093`*^9, 
   3.827121093398341*^9}, {3.827121339872962*^9, 3.827121429493181*^9}, 
   3.827121487389202*^9, 3.8271215485867*^9, 3.8271217165663033`*^9, 
   3.8271233822879353`*^9, 3.827123474102077*^9, {3.827123636870743*^9, 
   3.8271237050277567`*^9}, 3.82712374371196*^9, 3.827128609090981*^9, 
   3.827130010447847*^9, {3.827130074885769*^9, 3.82713011394003*^9}, {
   3.827130334037098*^9, 3.8271303608313713`*^9}, 3.8271304157251043`*^9, 
   3.82746209912298*^9, 3.827463182554984*^9, 3.82746321560281*^9, 
   3.827463319019004*^9, 3.82746338994683*^9, {3.827464155110572*^9, 
   3.827464228526842*^9}, 3.8274642770208693`*^9, {3.827464533438633*^9, 
   3.82746454153062*^9}, {3.82746466063026*^9, 3.8274647253627*^9}, 
   3.827464769071104*^9, 3.827464938641086*^9, 3.827465060759383*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"47055e43-bb96-440b-bd97-93a3b6647029"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.739191917262092*^9, 3.7391919460285797`*^9}, 
   3.739192015807609*^9, 3.739192178264247*^9, 3.739192218228044*^9, 
   3.739192591607321*^9, {3.739247817682075*^9, 3.73924782929382*^9}, 
   3.73924829116998*^9, 3.739248334429597*^9, 3.7392485167046003`*^9, 
   3.7392533921681137`*^9, 3.73925480271399*^9, 3.73926546920503*^9, {
   3.739269330847773*^9, 3.7392693880947323`*^9}, 3.739269986626227*^9, 
   3.739350791431426*^9, 3.7393523165922623`*^9, 3.7393800655487556`*^9, 
   3.7393802266832*^9, 3.739380272996051*^9, 3.739380433777*^9, 
   3.7393804942901573`*^9, 3.7395207179791183`*^9, 3.739520866784618*^9, 
   3.739601327029677*^9, {3.739608844277238*^9, 3.7396088714743013`*^9}, 
   3.739609016896166*^9, 3.739609065064046*^9, 3.739609138797864*^9, 
   3.741676885977689*^9, 3.742034887874125*^9, 3.742036788440463*^9, 
   3.742036923028064*^9, 3.7420372000620537`*^9, 3.742037409635128*^9, 
   3.742037743709496*^9, 3.742040628380228*^9, 3.7420406602992268`*^9, 
   3.742040784903356*^9, 3.742041531996169*^9, 3.742041774929689*^9, {
   3.7420418249363623`*^9, 3.742041842870819*^9}, 3.742041883039063*^9, 
   3.742042421314271*^9, 3.742042686065309*^9, {3.742042769969434*^9, 
   3.742042793501487*^9}, 3.74204283730835*^9, {3.742042926378606*^9, 
   3.742042952308404*^9}, 3.7420429855886583`*^9, 3.742043039801569*^9, 
   3.742043101327319*^9, 3.742043226147025*^9, {3.7420435657914953`*^9, 
   3.7420436093271303`*^9}, 3.7420437012091513`*^9, 3.742043911787212*^9, 
   3.742044047624681*^9, {3.742044128128077*^9, 3.742044152863278*^9}, {
   3.7420442977542543`*^9, 3.742044362964744*^9}, 3.742044921155044*^9, 
   3.827120418841503*^9, 3.827120948539556*^9, {3.8271210190286093`*^9, 
   3.827121093398341*^9}, {3.827121339872962*^9, 3.827121429493181*^9}, 
   3.827121487389202*^9, 3.8271215485867*^9, 3.8271217165663033`*^9, 
   3.8271233822879353`*^9, 3.827123474102077*^9, {3.827123636870743*^9, 
   3.8271237050277567`*^9}, 3.82712374371196*^9, 3.827128609090981*^9, 
   3.827130010447847*^9, {3.827130074885769*^9, 3.82713011394003*^9}, {
   3.827130334037098*^9, 3.8271303608313713`*^9}, 3.8271304157251043`*^9, 
   3.82746209912298*^9, 3.827463182554984*^9, 3.82746321560281*^9, 
   3.827463319019004*^9, 3.82746338994683*^9, {3.827464155110572*^9, 
   3.827464228526842*^9}, 3.8274642770208693`*^9, {3.827464533438633*^9, 
   3.82746454153062*^9}, {3.82746466063026*^9, 3.8274647253627*^9}, 
   3.827464769071104*^9, 3.827464938641086*^9, 3.8274650607618237`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"2ddb28a7-46ca-4742-a44c-b0d4a8834bfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "2"], "-", "K"}], ")"}], " ", 
     RowBox[{"PV", "[", "u", "]"}]}], "+", 
    RowBox[{"2", " ", "K", " ", 
     RowBox[{"PV", "[", "u", "]"}]}], "-", 
    RowBox[{"K", " ", "u", " ", 
     RowBox[{
      SuperscriptBox["PV", "\[Prime]",
       MultilineFunction->None], "[", "u", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"K", " ", 
        SuperscriptBox["u", "2"]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["PV", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "u", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739191917262092*^9, 3.7391919460285797`*^9}, 
   3.739192015807609*^9, 3.739192178264247*^9, 3.739192218228044*^9, 
   3.739192591607321*^9, {3.739247817682075*^9, 3.73924782929382*^9}, 
   3.73924829116998*^9, 3.739248334429597*^9, 3.7392485167046003`*^9, 
   3.7392533921681137`*^9, 3.73925480271399*^9, 3.73926546920503*^9, {
   3.739269330847773*^9, 3.7392693880947323`*^9}, 3.739269986626227*^9, 
   3.739350791431426*^9, 3.7393523165922623`*^9, 3.7393800655487556`*^9, 
   3.7393802266832*^9, 3.739380272996051*^9, 3.739380433777*^9, 
   3.7393804942901573`*^9, 3.7395207179791183`*^9, 3.739520866784618*^9, 
   3.739601327029677*^9, {3.739608844277238*^9, 3.7396088714743013`*^9}, 
   3.739609016896166*^9, 3.739609065064046*^9, 3.739609138797864*^9, 
   3.741676885977689*^9, 3.742034887874125*^9, 3.742036788440463*^9, 
   3.742036923028064*^9, 3.7420372000620537`*^9, 3.742037409635128*^9, 
   3.742037743709496*^9, 3.742040628380228*^9, 3.7420406602992268`*^9, 
   3.742040784903356*^9, 3.742041531996169*^9, 3.742041774929689*^9, {
   3.7420418249363623`*^9, 3.742041842870819*^9}, 3.742041883039063*^9, 
   3.742042421314271*^9, 3.742042686065309*^9, {3.742042769969434*^9, 
   3.742042793501487*^9}, 3.74204283730835*^9, {3.742042926378606*^9, 
   3.742042952308404*^9}, 3.7420429855886583`*^9, 3.742043039801569*^9, 
   3.742043101327319*^9, 3.742043226147025*^9, {3.7420435657914953`*^9, 
   3.7420436093271303`*^9}, 3.7420437012091513`*^9, 3.742043911787212*^9, 
   3.742044047624681*^9, {3.742044128128077*^9, 3.742044152863278*^9}, {
   3.7420442977542543`*^9, 3.742044362964744*^9}, 3.742044921155044*^9, 
   3.827120418841503*^9, 3.827120948539556*^9, {3.8271210190286093`*^9, 
   3.827121093398341*^9}, {3.827121339872962*^9, 3.827121429493181*^9}, 
   3.827121487389202*^9, 3.8271215485867*^9, 3.8271217165663033`*^9, 
   3.8271233822879353`*^9, 3.827123474102077*^9, {3.827123636870743*^9, 
   3.8271237050277567`*^9}, 3.82712374371196*^9, 3.827128609090981*^9, 
   3.827130010447847*^9, {3.827130074885769*^9, 3.82713011394003*^9}, {
   3.827130334037098*^9, 3.8271303608313713`*^9}, 3.8271304157251043`*^9, 
   3.82746209912298*^9, 3.827463182554984*^9, 3.82746321560281*^9, 
   3.827463319019004*^9, 3.82746338994683*^9, {3.827464155110572*^9, 
   3.827464228526842*^9}, 3.8274642770208693`*^9, {3.827464533438633*^9, 
   3.82746454153062*^9}, {3.82746466063026*^9, 3.8274647253627*^9}, 
   3.827464769071104*^9, 3.827464938641086*^9, 3.827465060763988*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"c2e61dc1-0b69-4b62-9d7c-d04182fb6d78"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "2"], "+", "K"}], ")"}], " ", 
     RowBox[{"PV", "[", "u", "]"}]}], "-", 
    RowBox[{"K", " ", "u", " ", 
     RowBox[{
      SuperscriptBox["PV", "\[Prime]",
       MultilineFunction->None], "[", "u", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"K", " ", 
        SuperscriptBox["u", "2"]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["PV", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "u", "]"}]}]}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.739191917262092*^9, 3.7391919460285797`*^9}, 
   3.739192015807609*^9, 3.739192178264247*^9, 3.739192218228044*^9, 
   3.739192591607321*^9, {3.739247817682075*^9, 3.73924782929382*^9}, 
   3.73924829116998*^9, 3.739248334429597*^9, 3.7392485167046003`*^9, 
   3.7392533921681137`*^9, 3.73925480271399*^9, 3.73926546920503*^9, {
   3.739269330847773*^9, 3.7392693880947323`*^9}, 3.739269986626227*^9, 
   3.739350791431426*^9, 3.7393523165922623`*^9, 3.7393800655487556`*^9, 
   3.7393802266832*^9, 3.739380272996051*^9, 3.739380433777*^9, 
   3.7393804942901573`*^9, 3.7395207179791183`*^9, 3.739520866784618*^9, 
   3.739601327029677*^9, {3.739608844277238*^9, 3.7396088714743013`*^9}, 
   3.739609016896166*^9, 3.739609065064046*^9, 3.739609138797864*^9, 
   3.741676885977689*^9, 3.742034887874125*^9, 3.742036788440463*^9, 
   3.742036923028064*^9, 3.7420372000620537`*^9, 3.742037409635128*^9, 
   3.742037743709496*^9, 3.742040628380228*^9, 3.7420406602992268`*^9, 
   3.742040784903356*^9, 3.742041531996169*^9, 3.742041774929689*^9, {
   3.7420418249363623`*^9, 3.742041842870819*^9}, 3.742041883039063*^9, 
   3.742042421314271*^9, 3.742042686065309*^9, {3.742042769969434*^9, 
   3.742042793501487*^9}, 3.74204283730835*^9, {3.742042926378606*^9, 
   3.742042952308404*^9}, 3.7420429855886583`*^9, 3.742043039801569*^9, 
   3.742043101327319*^9, 3.742043226147025*^9, {3.7420435657914953`*^9, 
   3.7420436093271303`*^9}, 3.7420437012091513`*^9, 3.742043911787212*^9, 
   3.742044047624681*^9, {3.742044128128077*^9, 3.742044152863278*^9}, {
   3.7420442977542543`*^9, 3.742044362964744*^9}, 3.742044921155044*^9, 
   3.827120418841503*^9, 3.827120948539556*^9, {3.8271210190286093`*^9, 
   3.827121093398341*^9}, {3.827121339872962*^9, 3.827121429493181*^9}, 
   3.827121487389202*^9, 3.8271215485867*^9, 3.8271217165663033`*^9, 
   3.8271233822879353`*^9, 3.827123474102077*^9, {3.827123636870743*^9, 
   3.8271237050277567`*^9}, 3.82712374371196*^9, 3.827128609090981*^9, 
   3.827130010447847*^9, {3.827130074885769*^9, 3.82713011394003*^9}, {
   3.827130334037098*^9, 3.8271303608313713`*^9}, 3.8271304157251043`*^9, 
   3.82746209912298*^9, 3.827463182554984*^9, 3.82746321560281*^9, 
   3.827463319019004*^9, 3.82746338994683*^9, {3.827464155110572*^9, 
   3.827464228526842*^9}, 3.8274642770208693`*^9, {3.827464533438633*^9, 
   3.82746454153062*^9}, {3.82746466063026*^9, 3.8274647253627*^9}, 
   3.827464769071104*^9, 3.827464938641086*^9, 3.827465060766159*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"9fe61352-f986-4596-8447-97e464d7cc17"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["PV", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "u", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["k", "2"], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"K", " ", 
          SuperscriptBox["u", "2"]}]}]], "+", 
       FractionBox["K", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"K", " ", 
          SuperscriptBox["u", "2"]}]}]]}], ")"}], " ", 
     RowBox[{"PV", "[", "u", "]"}]}], "+", 
    FractionBox[
     RowBox[{"K", " ", "u", " ", 
      RowBox[{
       SuperscriptBox["PV", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], 
     RowBox[{"1", "-", 
      RowBox[{"K", " ", 
       SuperscriptBox["u", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739191917262092*^9, 3.7391919460285797`*^9}, 
   3.739192015807609*^9, 3.739192178264247*^9, 3.739192218228044*^9, 
   3.739192591607321*^9, {3.739247817682075*^9, 3.73924782929382*^9}, 
   3.73924829116998*^9, 3.739248334429597*^9, 3.7392485167046003`*^9, 
   3.7392533921681137`*^9, 3.73925480271399*^9, 3.73926546920503*^9, {
   3.739269330847773*^9, 3.7392693880947323`*^9}, 3.739269986626227*^9, 
   3.739350791431426*^9, 3.7393523165922623`*^9, 3.7393800655487556`*^9, 
   3.7393802266832*^9, 3.739380272996051*^9, 3.739380433777*^9, 
   3.7393804942901573`*^9, 3.7395207179791183`*^9, 3.739520866784618*^9, 
   3.739601327029677*^9, {3.739608844277238*^9, 3.7396088714743013`*^9}, 
   3.739609016896166*^9, 3.739609065064046*^9, 3.739609138797864*^9, 
   3.741676885977689*^9, 3.742034887874125*^9, 3.742036788440463*^9, 
   3.742036923028064*^9, 3.7420372000620537`*^9, 3.742037409635128*^9, 
   3.742037743709496*^9, 3.742040628380228*^9, 3.7420406602992268`*^9, 
   3.742040784903356*^9, 3.742041531996169*^9, 3.742041774929689*^9, {
   3.7420418249363623`*^9, 3.742041842870819*^9}, 3.742041883039063*^9, 
   3.742042421314271*^9, 3.742042686065309*^9, {3.742042769969434*^9, 
   3.742042793501487*^9}, 3.74204283730835*^9, {3.742042926378606*^9, 
   3.742042952308404*^9}, 3.7420429855886583`*^9, 3.742043039801569*^9, 
   3.742043101327319*^9, 3.742043226147025*^9, {3.7420435657914953`*^9, 
   3.7420436093271303`*^9}, 3.7420437012091513`*^9, 3.742043911787212*^9, 
   3.742044047624681*^9, {3.742044128128077*^9, 3.742044152863278*^9}, {
   3.7420442977542543`*^9, 3.742044362964744*^9}, 3.742044921155044*^9, 
   3.827120418841503*^9, 3.827120948539556*^9, {3.8271210190286093`*^9, 
   3.827121093398341*^9}, {3.827121339872962*^9, 3.827121429493181*^9}, 
   3.827121487389202*^9, 3.8271215485867*^9, 3.8271217165663033`*^9, 
   3.8271233822879353`*^9, 3.827123474102077*^9, {3.827123636870743*^9, 
   3.8271237050277567`*^9}, 3.82712374371196*^9, 3.827128609090981*^9, 
   3.827130010447847*^9, {3.827130074885769*^9, 3.82713011394003*^9}, {
   3.827130334037098*^9, 3.8271303608313713`*^9}, 3.8271304157251043`*^9, 
   3.82746209912298*^9, 3.827463182554984*^9, 3.82746321560281*^9, 
   3.827463319019004*^9, 3.82746338994683*^9, {3.827464155110572*^9, 
   3.827464228526842*^9}, 3.8274642770208693`*^9, {3.827464533438633*^9, 
   3.82746454153062*^9}, {3.82746466063026*^9, 3.8274647253627*^9}, 
   3.827464769071104*^9, 3.827464938641086*^9, 3.827465060789345*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"4d2c6d0e-e827-432f-8b95-0e8f8c004516"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensors", "Section",
 CellChangeTimes->{{3.730006514140242*^9, 
  3.730006514737814*^9}},ExpressionUUID->"4d040f79-025a-4e1c-bc60-\
bed1b04e59e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"symmD", "[", "V_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"covD", "[", "V", "]"}], "//", 
      RowBox[{
       RowBox[{"#", "+", 
        RowBox[{"Transpose", "[", "#", "]"}]}], "&"}]}], ")"}], "//.", 
    "Prule"}], "//", "Simplify"}]}], "\n", 
 RowBox[{
  RowBox[{"Dsq", "[", "T_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"covDiv", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"covD", "[", "T", "]"}], ".", "gUU"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "1", "}"}], "}"}]}], "]"}], "//.", "Prule"}], "//", 
   "Simplify"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730006625510538*^9, 3.730006642399392*^9}, {
   3.730006714172442*^9, 3.7300067170868998`*^9}, 3.730011634986723*^9},
 CellLabel->"In[85]:=",ExpressionUUID->"9e5ca562-fe07-457c-94c7-3983f32026e2"],

Cell[CellGroupData[{

Cell["Polar and axial, using Mukuhyama\[CloseCurlyQuote]s expressions", \
"Subsection",
 CellChangeTimes->{{3.742042014456547*^9, 
  3.7420420272837973`*^9}},ExpressionUUID->"8353f9a8-1df0-4541-b3c1-\
e849284d4cfc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "Y"], "=", 
    RowBox[{"gdd", " ", "P0"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"B12", " ", "last", " ", "equation"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "LT"], "=", 
    RowBox[{
     RowBox[{"symmD", "[", "Va", "]"}], "//.", 
     RowBox[{"PVrule", "~", "Join", "~", 
      RowBox[{"D", "[", 
       RowBox[{"PVrule", ",", "u"}], "]"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"B12", " ", "first", " ", "equation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "LL"], "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"symmD", "[", "Vp", "]"}], "-", 
       RowBox[{
        FractionBox["2", "n"], "gdd", " ", 
        RowBox[{"covDiv", "[", 
         RowBox[{
          RowBox[{"gUU", ".", "Vp"}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}]}], "//.", "Prule"}], "//", 
     "Simplify"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"B12", " ", "middle"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T2", "LL"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"covD", "[", 
         RowBox[{"covD", "[", "P0", "]"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["2", "n"], 
        SuperscriptBox["k", "2"], " ", "gdd", " ", "P0"}]}], "//.", "Prule"}],
      "//", "Simplify"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"same", " ", "as", " ", "above"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["T2", "LL"], "-", 
   SubscriptBox["T", "LL"]}], "//", "Simplify"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730006931421471*^9, 3.73000694879534*^9}, {
   3.7300076754339848`*^9, 3.7300076790958*^9}, {3.730008087916335*^9, 
   3.730008094558935*^9}, {3.730008129458968*^9, 3.730008131914631*^9}, {
   3.7300081763555517`*^9, 3.730008215197246*^9}, {3.730011468265452*^9, 
   3.7300114743298264`*^9}, 3.730011693871849*^9, {3.730012280819537*^9, 
   3.730012306551609*^9}, {3.730012819532124*^9, 3.730012830359892*^9}, {
   3.730013555725596*^9, 3.730013556203258*^9}, {3.730015018861836*^9, 
   3.7300150267327347`*^9}, {3.7300151412870817`*^9, 3.730015141794734*^9}, {
   3.7391692504410133`*^9, 3.739169252886613*^9}, {3.739169308877123*^9, 
   3.739169334065854*^9}, {3.7392478351614428`*^9, 3.73924783741646*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"b22678c5-854a-4f31-a2da-c2ceba319630"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.827464167383956*^9, 3.8274642303722687`*^9}, 
   3.827464280259594*^9, {3.8274645335361443`*^9, 3.827464541632359*^9}, {
   3.8274646607415247`*^9, 3.827464727031075*^9}, 3.827464772307045*^9, 
   3.827464938728837*^9, 3.827465060866445*^9},
 FontSize->16,
 FontSlant->"Italic",
 FontColor->RGBColor[1, 0, 1],
 CellLabel->"Out[91]=",ExpressionUUID->"e58f072a-73d9-43d4-843a-da29862e63be"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["transverse traceless sector in d>3, construct one example:", \
"Subsection",
 CellChangeTimes->{{3.74204204059088*^9, 
  3.742042055259541*^9}},ExpressionUUID->"a6e5a1c8-40bb-4f85-90f1-\
c1bb094c061b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2Tensor", "[", "T_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"covDiv", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"covD", "[", "T", "]"}], ".", "gUU"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}], "//.", 
    RowBox[{"Prule", "~", "Join", "~", 
     RowBox[{"D", "[", 
      RowBox[{"Prule", ",", "u"}], "]"}]}]}], "//", 
   "FullSimplify"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739177813850168*^9, 3.7391778313591213`*^9}, {
  3.739177935940559*^9, 3.739177941201531*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"dcd2e9c4-feb5-4d0c-89e3-1c3e662d93a9"],

Cell[CellGroupData[{

Cell["particular solution:", "Subsubsection",
 CellChangeTimes->{{3.742044483958671*^9, 3.74204452071382*^9}, {
  3.8271215580719557`*^9, 3.827121560468045*^9}, {3.827463802252595*^9, 
  3.827463810635654*^9}},ExpressionUUID->"d5e41aca-da6d-4bb0-a8c2-\
61fa994a1f8e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TTT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "n", "}"}], ",", 
     RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TTT", "\[LeftDoubleBracket]", 
    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[Equal]", "2"}], ",", "0", ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"K", " ", 
           SuperscriptBox[
            SubscriptBox["\[Theta]", "2"], "2"]}]}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]]], 
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[Product]", 
         RowBox[{"i", "=", "3"}], 
         RowBox[{"n", "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"K", " ", 
           SubsuperscriptBox["\[Theta]", "i", "2"]}]}], ")"}]}], ")"}], " ", 
      RowBox[{"PT", "[", "u", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["T", "TT"], "=", 
   RowBox[{"TTT", "//", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "+", 
       RowBox[{"Transpose", "[", "#", "]"}]}], "&"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PTrule", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"0", "\[Equal]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"d2Tensor", "[", 
              SubscriptBox["T", "TT"], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["k", "2"], "-", " ", 
                RowBox[{"2", " ", "K"}]}], " ", ")"}], 
              SubscriptBox["T", "TT"]}]}], "//", "Flatten"}], "//", 
           RowBox[{"MaximalBy", "[", "LeafCount", "]"}]}], "//", "First"}], "//",
          "Simplify"}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"PT", "''"}], "[", "u", "]"}]}], "]"}], "\[LeftDoubleBracket]",
     "1", "\[RightDoubleBracket]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "[", "u", "]"}], ",", "k"}], "}"}], ",", 
      "FullSimplify"}], "]"}], "&"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.742042529856545*^9, 3.742044532973134*^9, {3.7420445893222017`*^9, 
   3.7420445896304398`*^9}, {3.742044939353973*^9, 3.742044942618626*^9}, {
   3.827120301094151*^9, 3.8271203024782763`*^9}, {3.827463368171957*^9, 
   3.8274633700165453`*^9}, 3.827463539398938*^9, {3.827464391162998*^9, 
   3.8274644128068666`*^9}, {3.8274646151248503`*^9, 3.827464636023321*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"de68c0a4-7acb-48c8-a18d-81360728942f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["PT", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "u", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "K"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"K", " ", 
             SuperscriptBox["u", "2"]}]}], ")"}], "2"]]}], "+", 
       FractionBox[
        SuperscriptBox["k", "2"], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"K", " ", 
          SuperscriptBox["u", "2"]}]}]]}], ")"}], " ", 
     RowBox[{"PT", "[", "u", "]"}]}], "+", 
    FractionBox[
     RowBox[{"K", " ", "u", " ", 
      RowBox[{
       SuperscriptBox["PT", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"K", " ", 
       SuperscriptBox["u", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8271236820766687`*^9, 3.827123706874897*^9}, 
   3.827123744133979*^9, 3.827128609371065*^9, 3.827130010777419*^9, {
   3.8271300752254744`*^9, 3.8271301143709707`*^9}, {3.827130335436838*^9, 
   3.8271303746322317`*^9}, 3.827130421049014*^9, 3.827462099245954*^9, 
   3.8274631827787867`*^9, 3.8274632157443247`*^9, 3.8274633195010023`*^9, {
   3.827463372074889*^9, 3.827463390219171*^9}, 3.8274635455331783`*^9, 
   3.827464155377945*^9, {3.827464185488765*^9, 3.827464242350398*^9}, 
   3.827464281904113*^9, {3.827464533630869*^9, 3.827464541713498*^9}, {
   3.827464660881762*^9, 3.8274647391873417`*^9}, 3.827464773888081*^9, 
   3.827464938742072*^9, 3.8274650610060167`*^9},
 FontSize->16,
 FontSlant->"Italic",
 FontColor->RGBColor[1, 0, 1],
 CellLabel->"Out[96]=",ExpressionUUID->"b1f09f83-2c5f-45a5-8dbc-42074d204bad"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check Identities", "Subsection",
 CellChangeTimes->{{3.730007867657111*^9, 
  3.7300078697306957`*^9}},ExpressionUUID->"01735d95-6e57-4ed3-b61f-\
7a49150145b9"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["T", "Y"], 
  TraditionalForm]],ExpressionUUID->"deb0a57a-87d0-4f7d-9fb4-42d91de210c7"]], \
"Subsubsection",
 CellChangeTimes->{{3.7300079290400476`*^9, 
  3.730007929618438*^9}},ExpressionUUID->"30b80bf8-2de5-458d-a639-\
d10b8fbe6b23"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"gUU", ".", 
     SubscriptBox["T", "Y"]}], 
    RowBox[{"n", " ", "P0"}]], "//", "Tr"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covDiv", "[", 
    RowBox[{
     RowBox[{"gUU", ".", 
      SubscriptBox["T", "Y"]}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}], "-", "Vp"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2Tensor", "[", 
    SubscriptBox["T", "Y"], "]"}], "+", " ", 
   RowBox[{
    SuperscriptBox["k", "2"], 
    SubscriptBox["T", "Y"]}]}], "//", "Simplify"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7300078772839603`*^9, 3.730007940322863*^9}, {
  3.730010146830391*^9, 3.7300101602145033`*^9}, {3.730012903097664*^9, 
  3.730012903326016*^9}, {3.7391696443737288`*^9, 3.7391696449256067`*^9}, {
  3.7391778524227133`*^9, 3.7391779000535793`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"dfa15620-e91f-43fc-8874-fe9f949a2fb7"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.739191918228216*^9, 3.739191946938656*^9}, 
   3.7391920164928102`*^9, 3.739192179012808*^9, 3.739192219026663*^9, 
   3.7391925933109503`*^9, 3.739247855903453*^9, 3.7392482922843037`*^9, 
   3.739248335213388*^9, 3.739248517228094*^9, 3.739253392829702*^9, 
   3.739254803322627*^9, 3.7392654697464647`*^9, {3.7392693312955427`*^9, 
   3.739269390301928*^9}, 3.7392699877278214`*^9, 3.739350792385375*^9, 
   3.7393523182709713`*^9, 3.739380069108294*^9, 3.7393802317478647`*^9, 
   3.739380437586604*^9, 3.7393804961286182`*^9, 3.7395207183953*^9, 
   3.739520867140499*^9, 3.739601327645854*^9, 3.739608872622951*^9, 
   3.739609020247539*^9, 3.739609066889821*^9, 3.739609140134079*^9, 
   3.7416768871206093`*^9, 3.7420348886231003`*^9, 3.742036788973146*^9, 
   3.742036923632234*^9, 3.742037200577471*^9, 3.742037410170767*^9, 
   3.7420377441440372`*^9, 3.742040629004011*^9, 3.742040660768998*^9, 
   3.7420407855051622`*^9, 3.7420415324331217`*^9, 3.742041775604261*^9, {
   3.742041825456141*^9, 3.7420418438221273`*^9}, 3.742041883694479*^9, 
   3.742042422040189*^9, 3.742042686710485*^9, 3.742042838718938*^9, {
   3.742042927798852*^9, 3.742042956372164*^9}, 3.7420429957489767`*^9, 
   3.742043072739615*^9, 3.742043230564184*^9, {3.742043567276957*^9, 
   3.742043619247671*^9}, 3.742043733527774*^9, 3.74204391595374*^9, 
   3.7420440583719053`*^9, {3.742044130210766*^9, 3.742044154999963*^9}, {
   3.74204429917104*^9, 3.742044343659635*^9}, 3.7420443953011627`*^9, 
   3.742044922839655*^9, 3.827120420087109*^9, 3.827120948947029*^9, {
   3.827121019370838*^9, 3.8271210939437933`*^9}, {3.827121341751676*^9, 
   3.827121431657321*^9}, 3.827121501272251*^9, 3.827121554468505*^9, 
   3.827123387837315*^9, 3.8271234876117573`*^9, {3.827123639003365*^9, 
   3.8271237069459677`*^9}, 3.827123744143455*^9, 3.827128609395891*^9, 
   3.827130010806789*^9, {3.8271300752597637`*^9, 3.827130114396047*^9}, {
   3.82713033549988*^9, 3.8271303746850157`*^9}, 3.827130421110414*^9, 
   3.827462099280175*^9, 3.827463182807994*^9, 3.8274632157912483`*^9, 
   3.827463319527111*^9, 3.827463390239897*^9, 3.827463545584343*^9, {
   3.827464155406208*^9, 3.82746424245448*^9}, 3.827464281981944*^9, {
   3.8274645336584997`*^9, 3.827464541740704*^9}, {3.827464660887293*^9, 
   3.8274647392225657`*^9}, 3.8274647739625387`*^9, 3.827464938764853*^9, 
   3.827465061012252*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"7c3f80c5-fd9e-42de-9f2a-a6f3903af951"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.739191918228216*^9, 3.739191946938656*^9}, 
   3.7391920164928102`*^9, 3.739192179012808*^9, 3.739192219026663*^9, 
   3.7391925933109503`*^9, 3.739247855903453*^9, 3.7392482922843037`*^9, 
   3.739248335213388*^9, 3.739248517228094*^9, 3.739253392829702*^9, 
   3.739254803322627*^9, 3.7392654697464647`*^9, {3.7392693312955427`*^9, 
   3.739269390301928*^9}, 3.7392699877278214`*^9, 3.739350792385375*^9, 
   3.7393523182709713`*^9, 3.739380069108294*^9, 3.7393802317478647`*^9, 
   3.739380437586604*^9, 3.7393804961286182`*^9, 3.7395207183953*^9, 
   3.739520867140499*^9, 3.739601327645854*^9, 3.739608872622951*^9, 
   3.739609020247539*^9, 3.739609066889821*^9, 3.739609140134079*^9, 
   3.7416768871206093`*^9, 3.7420348886231003`*^9, 3.742036788973146*^9, 
   3.742036923632234*^9, 3.742037200577471*^9, 3.742037410170767*^9, 
   3.7420377441440372`*^9, 3.742040629004011*^9, 3.742040660768998*^9, 
   3.7420407855051622`*^9, 3.7420415324331217`*^9, 3.742041775604261*^9, {
   3.742041825456141*^9, 3.7420418438221273`*^9}, 3.742041883694479*^9, 
   3.742042422040189*^9, 3.742042686710485*^9, 3.742042838718938*^9, {
   3.742042927798852*^9, 3.742042956372164*^9}, 3.7420429957489767`*^9, 
   3.742043072739615*^9, 3.742043230564184*^9, {3.742043567276957*^9, 
   3.742043619247671*^9}, 3.742043733527774*^9, 3.74204391595374*^9, 
   3.7420440583719053`*^9, {3.742044130210766*^9, 3.742044154999963*^9}, {
   3.74204429917104*^9, 3.742044343659635*^9}, 3.7420443953011627`*^9, 
   3.742044922839655*^9, 3.827120420087109*^9, 3.827120948947029*^9, {
   3.827121019370838*^9, 3.8271210939437933`*^9}, {3.827121341751676*^9, 
   3.827121431657321*^9}, 3.827121501272251*^9, 3.827121554468505*^9, 
   3.827123387837315*^9, 3.8271234876117573`*^9, {3.827123639003365*^9, 
   3.8271237069459677`*^9}, 3.827123744143455*^9, 3.827128609395891*^9, 
   3.827130010806789*^9, {3.8271300752597637`*^9, 3.827130114396047*^9}, {
   3.82713033549988*^9, 3.8271303746850157`*^9}, 3.827130421110414*^9, 
   3.827462099280175*^9, 3.827463182807994*^9, 3.8274632157912483`*^9, 
   3.827463319527111*^9, 3.827463390239897*^9, 3.827463545584343*^9, {
   3.827464155406208*^9, 3.82746424245448*^9}, 3.827464281981944*^9, {
   3.8274645336584997`*^9, 3.827464541740704*^9}, {3.827464660887293*^9, 
   3.8274647392225657`*^9}, 3.8274647739625387`*^9, 3.827464938764853*^9, 
   3.8274650610144577`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"1c1cdc8f-2989-4242-88e6-025279688cde"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739191918228216*^9, 3.739191946938656*^9}, 
   3.7391920164928102`*^9, 3.739192179012808*^9, 3.739192219026663*^9, 
   3.7391925933109503`*^9, 3.739247855903453*^9, 3.7392482922843037`*^9, 
   3.739248335213388*^9, 3.739248517228094*^9, 3.739253392829702*^9, 
   3.739254803322627*^9, 3.7392654697464647`*^9, {3.7392693312955427`*^9, 
   3.739269390301928*^9}, 3.7392699877278214`*^9, 3.739350792385375*^9, 
   3.7393523182709713`*^9, 3.739380069108294*^9, 3.7393802317478647`*^9, 
   3.739380437586604*^9, 3.7393804961286182`*^9, 3.7395207183953*^9, 
   3.739520867140499*^9, 3.739601327645854*^9, 3.739608872622951*^9, 
   3.739609020247539*^9, 3.739609066889821*^9, 3.739609140134079*^9, 
   3.7416768871206093`*^9, 3.7420348886231003`*^9, 3.742036788973146*^9, 
   3.742036923632234*^9, 3.742037200577471*^9, 3.742037410170767*^9, 
   3.7420377441440372`*^9, 3.742040629004011*^9, 3.742040660768998*^9, 
   3.7420407855051622`*^9, 3.7420415324331217`*^9, 3.742041775604261*^9, {
   3.742041825456141*^9, 3.7420418438221273`*^9}, 3.742041883694479*^9, 
   3.742042422040189*^9, 3.742042686710485*^9, 3.742042838718938*^9, {
   3.742042927798852*^9, 3.742042956372164*^9}, 3.7420429957489767`*^9, 
   3.742043072739615*^9, 3.742043230564184*^9, {3.742043567276957*^9, 
   3.742043619247671*^9}, 3.742043733527774*^9, 3.74204391595374*^9, 
   3.7420440583719053`*^9, {3.742044130210766*^9, 3.742044154999963*^9}, {
   3.74204429917104*^9, 3.742044343659635*^9}, 3.7420443953011627`*^9, 
   3.742044922839655*^9, 3.827120420087109*^9, 3.827120948947029*^9, {
   3.827121019370838*^9, 3.8271210939437933`*^9}, {3.827121341751676*^9, 
   3.827121431657321*^9}, 3.827121501272251*^9, 3.827121554468505*^9, 
   3.827123387837315*^9, 3.8271234876117573`*^9, {3.827123639003365*^9, 
   3.8271237069459677`*^9}, 3.827123744143455*^9, 3.827128609395891*^9, 
   3.827130010806789*^9, {3.8271300752597637`*^9, 3.827130114396047*^9}, {
   3.82713033549988*^9, 3.8271303746850157`*^9}, 3.827130421110414*^9, 
   3.827462099280175*^9, 3.827463182807994*^9, 3.8274632157912483`*^9, 
   3.827463319527111*^9, 3.827463390239897*^9, 3.827463545584343*^9, {
   3.827464155406208*^9, 3.82746424245448*^9}, 3.827464281981944*^9, {
   3.8274645336584997`*^9, 3.827464541740704*^9}, {3.827464660887293*^9, 
   3.8274647392225657`*^9}, 3.8274647739625387`*^9, 3.827464938764853*^9, 
   3.8274650610376797`*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"7bb20971-9c95-480a-bb5f-6ed9aa2e4eac"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["T", "LL"], 
  TraditionalForm]],ExpressionUUID->"2755187c-f0eb-47fe-9975-6e38e61a22af"]], \
"Subsubsection",
 CellChangeTimes->{{3.7300079851972103`*^9, 
  3.730007987837407*^9}},ExpressionUUID->"3e68c736-e697-449d-a1f3-\
28a240245b03"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gUU", ".", 
    SubscriptBox["T", "LL"]}], "//", "Tr"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2Tensor", "[", 
    SubscriptBox["T", "LL"], "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k", "2"], "-", " ", 
      RowBox[{"2", " ", "n", "  ", "K"}]}], " ", ")"}], 
    SubscriptBox["T", "LL"]}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covDiv", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["T", "LL"], ".", "gUU"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "n"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "2"], "-", " ", 
       RowBox[{"n", " ", "K"}]}], ")"}], " ", "Vp"}]}], "//.", "Prule"}], "//",
   "Simplify"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730008244288803*^9, 3.7300082909477377`*^9}, {
  3.730008327117169*^9, 3.730008352572608*^9}, {3.730012928775037*^9, 
  3.730013066534556*^9}, {3.730013567387288*^9, 3.73001356780091*^9}, {
  3.739169512115169*^9, 3.739169524081262*^9}, {3.7391779060658903`*^9, 
  3.7391779275431128`*^9}, {3.8271203040414886`*^9, 3.827120304605846*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"402d9b4a-b6e8-4bf4-b2de-09ae67167a22"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.739191918512351*^9, 3.7391919471717854`*^9}, 
   3.739192016804635*^9, 3.7391921792477627`*^9, 3.739192219496243*^9, 
   3.73919259358339*^9, 3.739248292398822*^9, 3.739248335637981*^9, 
   3.739248517337534*^9, 3.739253393058775*^9, 3.7392548035301447`*^9, 
   3.7392654698610373`*^9, {3.739269331426525*^9, 3.7392693909028587`*^9}, 
   3.7392699879387827`*^9, 3.7393507929903708`*^9, 3.739352319537328*^9, 
   3.739380070301627*^9, 3.739380439969348*^9, 3.73938049746577*^9, 
   3.739520718477622*^9, 3.739520867282213*^9, 3.739601327749071*^9, 
   3.7396088733085127`*^9, 3.739609022094305*^9, 3.739609067296591*^9, 
   3.739609140639584*^9, 3.741676887599265*^9, 3.7420348888611183`*^9, 
   3.742036789159685*^9, 3.742036923805491*^9, 3.742037200762208*^9, 
   3.742037410272026*^9, 3.742037744313385*^9, 3.74204062911665*^9, 
   3.742040660968933*^9, 3.7420407856878147`*^9, 3.7420415327265253`*^9, 
   3.742041775822712*^9, {3.7420418255731363`*^9, 3.7420418440187607`*^9}, 
   3.742041884025716*^9, 3.742042422133113*^9, 3.7420426869318647`*^9, 
   3.74204283890901*^9, {3.7420429279319077`*^9, 3.742042956640923*^9}, 
   3.742042996050437*^9, 3.742043073191375*^9, 3.742043230782543*^9, {
   3.742043567460331*^9, 3.742043619579126*^9}, 3.742043733995702*^9, 
   3.742043916187549*^9, 3.7420440587445498`*^9, {3.74204413041181*^9, 
   3.742044155201192*^9}, {3.742044299359455*^9, 3.742044343996973*^9}, 
   3.742044395734413*^9, 3.742044922956048*^9, 3.827120420095306*^9, 
   3.827120948955503*^9, {3.827121019411079*^9, 3.827121094155384*^9}, {
   3.82712134176115*^9, 3.8271214322489157`*^9}, 3.827121502072816*^9, 
   3.8271215562650347`*^9, 3.827123389531275*^9, 3.827123488336224*^9, {
   3.827123639433455*^9, 3.8271237069605083`*^9}, 3.8271237442184677`*^9, 
   3.827128609452999*^9, 3.827130010913637*^9, {3.8271300753115387`*^9, 
   3.827130114505979*^9}, {3.8271303357334967`*^9, 3.827130375480501*^9}, 
   3.827130422828927*^9, 3.827462099289423*^9, 3.827463182817342*^9, 
   3.8274632158031282`*^9, 3.8274633195803213`*^9, 3.827463390266089*^9, 
   3.827463545626923*^9, {3.827464155479569*^9, 3.827464243171014*^9}, 
   3.827464283542295*^9, {3.827464533670874*^9, 3.827464541777079*^9}, {
   3.827464660919986*^9, 3.827464739941394*^9}, 3.827464775407902*^9, 
   3.827464938777196*^9, 3.827465061044174*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"14a5f0b3-2f4f-4468-b2b8-0bb12ca984ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739191918512351*^9, 3.7391919471717854`*^9}, 
   3.739192016804635*^9, 3.7391921792477627`*^9, 3.739192219496243*^9, 
   3.73919259358339*^9, 3.739248292398822*^9, 3.739248335637981*^9, 
   3.739248517337534*^9, 3.739253393058775*^9, 3.7392548035301447`*^9, 
   3.7392654698610373`*^9, {3.739269331426525*^9, 3.7392693909028587`*^9}, 
   3.7392699879387827`*^9, 3.7393507929903708`*^9, 3.739352319537328*^9, 
   3.739380070301627*^9, 3.739380439969348*^9, 3.73938049746577*^9, 
   3.739520718477622*^9, 3.739520867282213*^9, 3.739601327749071*^9, 
   3.7396088733085127`*^9, 3.739609022094305*^9, 3.739609067296591*^9, 
   3.739609140639584*^9, 3.741676887599265*^9, 3.7420348888611183`*^9, 
   3.742036789159685*^9, 3.742036923805491*^9, 3.742037200762208*^9, 
   3.742037410272026*^9, 3.742037744313385*^9, 3.74204062911665*^9, 
   3.742040660968933*^9, 3.7420407856878147`*^9, 3.7420415327265253`*^9, 
   3.742041775822712*^9, {3.7420418255731363`*^9, 3.7420418440187607`*^9}, 
   3.742041884025716*^9, 3.742042422133113*^9, 3.7420426869318647`*^9, 
   3.74204283890901*^9, {3.7420429279319077`*^9, 3.742042956640923*^9}, 
   3.742042996050437*^9, 3.742043073191375*^9, 3.742043230782543*^9, {
   3.742043567460331*^9, 3.742043619579126*^9}, 3.742043733995702*^9, 
   3.742043916187549*^9, 3.7420440587445498`*^9, {3.74204413041181*^9, 
   3.742044155201192*^9}, {3.742044299359455*^9, 3.742044343996973*^9}, 
   3.742044395734413*^9, 3.742044922956048*^9, 3.827120420095306*^9, 
   3.827120948955503*^9, {3.827121019411079*^9, 3.827121094155384*^9}, {
   3.82712134176115*^9, 3.8271214322489157`*^9}, 3.827121502072816*^9, 
   3.8271215562650347`*^9, 3.827123389531275*^9, 3.827123488336224*^9, {
   3.827123639433455*^9, 3.8271237069605083`*^9}, 3.8271237442184677`*^9, 
   3.827128609452999*^9, 3.827130010913637*^9, {3.8271300753115387`*^9, 
   3.827130114505979*^9}, {3.8271303357334967`*^9, 3.827130375480501*^9}, 
   3.827130422828927*^9, 3.827462099289423*^9, 3.827463182817342*^9, 
   3.8274632158031282`*^9, 3.8274633195803213`*^9, 3.827463390266089*^9, 
   3.827463545626923*^9, {3.827464155479569*^9, 3.827464243171014*^9}, 
   3.827464283542295*^9, {3.827464533670874*^9, 3.827464541777079*^9}, {
   3.827464660919986*^9, 3.827464739941394*^9}, 3.827464775407902*^9, 
   3.827464938777196*^9, 3.827465061146779*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"15ba80fe-a110-4795-9edd-69c7cba76afb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.739191918512351*^9, 3.7391919471717854`*^9}, 
   3.739192016804635*^9, 3.7391921792477627`*^9, 3.739192219496243*^9, 
   3.73919259358339*^9, 3.739248292398822*^9, 3.739248335637981*^9, 
   3.739248517337534*^9, 3.739253393058775*^9, 3.7392548035301447`*^9, 
   3.7392654698610373`*^9, {3.739269331426525*^9, 3.7392693909028587`*^9}, 
   3.7392699879387827`*^9, 3.7393507929903708`*^9, 3.739352319537328*^9, 
   3.739380070301627*^9, 3.739380439969348*^9, 3.73938049746577*^9, 
   3.739520718477622*^9, 3.739520867282213*^9, 3.739601327749071*^9, 
   3.7396088733085127`*^9, 3.739609022094305*^9, 3.739609067296591*^9, 
   3.739609140639584*^9, 3.741676887599265*^9, 3.7420348888611183`*^9, 
   3.742036789159685*^9, 3.742036923805491*^9, 3.742037200762208*^9, 
   3.742037410272026*^9, 3.742037744313385*^9, 3.74204062911665*^9, 
   3.742040660968933*^9, 3.7420407856878147`*^9, 3.7420415327265253`*^9, 
   3.742041775822712*^9, {3.7420418255731363`*^9, 3.7420418440187607`*^9}, 
   3.742041884025716*^9, 3.742042422133113*^9, 3.7420426869318647`*^9, 
   3.74204283890901*^9, {3.7420429279319077`*^9, 3.742042956640923*^9}, 
   3.742042996050437*^9, 3.742043073191375*^9, 3.742043230782543*^9, {
   3.742043567460331*^9, 3.742043619579126*^9}, 3.742043733995702*^9, 
   3.742043916187549*^9, 3.7420440587445498`*^9, {3.74204413041181*^9, 
   3.742044155201192*^9}, {3.742044299359455*^9, 3.742044343996973*^9}, 
   3.742044395734413*^9, 3.742044922956048*^9, 3.827120420095306*^9, 
   3.827120948955503*^9, {3.827121019411079*^9, 3.827121094155384*^9}, {
   3.82712134176115*^9, 3.8271214322489157`*^9}, 3.827121502072816*^9, 
   3.8271215562650347`*^9, 3.827123389531275*^9, 3.827123488336224*^9, {
   3.827123639433455*^9, 3.8271237069605083`*^9}, 3.8271237442184677`*^9, 
   3.827128609452999*^9, 3.827130010913637*^9, {3.8271300753115387`*^9, 
   3.827130114505979*^9}, {3.8271303357334967`*^9, 3.827130375480501*^9}, 
   3.827130422828927*^9, 3.827462099289423*^9, 3.827463182817342*^9, 
   3.8274632158031282`*^9, 3.8274633195803213`*^9, 3.827463390266089*^9, 
   3.827463545626923*^9, {3.827464155479569*^9, 3.827464243171014*^9}, 
   3.827464283542295*^9, {3.827464533670874*^9, 3.827464541777079*^9}, {
   3.827464660919986*^9, 3.827464739941394*^9}, 3.827464775407902*^9, 
   3.827464938777196*^9, 3.8274650611489563`*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"ecf711fc-4c04-495f-8320-3a8d42a7390c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["T", "LT"], 
  TraditionalForm]],ExpressionUUID->"d720176e-d828-400f-bd3e-f541d4ae5539"]], \
"Subsubsection",
 CellChangeTimes->{{3.730013095564261*^9, 
  3.730013099095539*^9}},ExpressionUUID->"a67209d6-62ef-4698-9409-\
15585578da00"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gUU", ".", 
     SubscriptBox["T", "LT"]}], "/.", "PVrule"}], "//", "Tr"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d2Tensor", "[", 
     SubscriptBox["T", "LT"], "]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "2"], "-", "  ", "K", "-", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}], "  ", "K"}]}], " ", ")"}], " ", 
     SubscriptBox["T", "LT"]}]}], "//.", 
   RowBox[{"(", 
    RowBox[{"PVrule", "~", "Join", "~", 
     RowBox[{"D", "[", 
      RowBox[{"PVrule", ",", "u"}], "]"}]}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"covDiv", "[", 
      RowBox[{
       RowBox[{"gUU", ".", 
        SubscriptBox["T", "LT"]}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k", "2"], "-", " ", "K", " ", "-", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "K"}]}], ")"}], " ", "Va"}]}], 
    "//.", "Prule"}], "//.", 
   RowBox[{"(", 
    RowBox[{"PVrule", "~", "Join", "~", 
     RowBox[{"D", "[", 
      RowBox[{"PVrule", ",", "u"}], "]"}]}], ")"}]}], "//", 
  "Simplify"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730008244288803*^9, 3.7300082909477377`*^9}, {
   3.730008327117169*^9, 3.730008352572608*^9}, {3.730012928775037*^9, 
   3.730013066534556*^9}, {3.7300131210226316`*^9, 3.730013148347537*^9}, {
   3.730013571239955*^9, 3.73001357167953*^9}, {3.730014594324914*^9, 
   3.730014612368051*^9}, {3.7300186005810747`*^9, 3.73001860143775*^9}, 
   3.730018688144857*^9, {3.730018756604171*^9, 3.730018784366352*^9}, {
   3.730018837678588*^9, 3.7300188975359497`*^9}, {3.7300189486873913`*^9, 
   3.7300189677790422`*^9}, {3.739169528079534*^9, 3.739169577463079*^9}, {
   3.739169662674735*^9, 3.739169681416609*^9}, {3.739176652416206*^9, 
   3.7391766620591087`*^9}, 3.739177151799822*^9, {3.739177297365018*^9, 
   3.739177320296979*^9}, {3.7391779462700157`*^9, 3.73917799834089*^9}, {
   3.739186540121694*^9, 3.7391866725090227`*^9}, 3.739186710256014*^9, {
   3.7391875211125603`*^9, 3.7391875300647907`*^9}, {3.739191014891632*^9, 
   3.7391910177088747`*^9}, 3.739191856161757*^9, {3.739248309302272*^9, 
   3.739248320642295*^9}, {3.82712031040049*^9, 3.827120312007777*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"9d167ed3-bdb6-4fd8-9930-c9b24178a5ac"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.739191918773426*^9, 3.7391919474254847`*^9}, 
   3.739192016970253*^9, 3.7391921795444736`*^9, 3.739192220074863*^9, 
   3.739192593819646*^9, {3.739248292736579*^9, 3.7392483358693113`*^9}, 
   3.7392485174560823`*^9, 3.739253393260054*^9, 3.739254803921524*^9, 
   3.739265470006442*^9, {3.739269331660367*^9, 3.739269391856285*^9}, 
   3.739269988069709*^9, 3.739350794158577*^9, 3.739352322238062*^9, 
   3.739380073580723*^9, 3.739380447796873*^9, 3.739380500640584*^9, 
   3.739520718561228*^9, 3.739520867457431*^9, 3.739601327943862*^9, 
   3.7396088746806097`*^9, 3.7396090251462317`*^9, 3.739609068033861*^9, 
   3.739609141669112*^9, 3.741676888177842*^9, 3.742034889083928*^9, 
   3.742036789406859*^9, 3.742036924064384*^9, 3.74203720106221*^9, 
   3.742037410444983*^9, 3.742037744714534*^9, 3.742040629600938*^9, 
   3.742040661417543*^9, 3.742040786232317*^9, 3.742041532932399*^9, 
   3.742041776056471*^9, {3.7420418258047867`*^9, 3.742041844424859*^9}, 
   3.7420418846839523`*^9, 3.7420424223339567`*^9, 3.742042687265203*^9, 
   3.742042839178175*^9, {3.742042928083497*^9, 3.7420429570560923`*^9}, 
   3.742042996567133*^9, 3.7420430741752253`*^9, 3.742043231266521*^9, {
   3.742043567611817*^9, 3.742043620174058*^9}, 3.742043735032089*^9, 
   3.7420439166040688`*^9, 3.7420440594312696`*^9, {3.742044130561182*^9, 
   3.7420441555475197`*^9}, {3.742044299510275*^9, 3.7420443445369587`*^9}, 
   3.742044396704689*^9, 3.7420449230538177`*^9, 3.827120420152348*^9, 
   3.827120949102167*^9, {3.8271210195861998`*^9, 3.827121094501639*^9}, {
   3.8271213418167963`*^9, 3.827121434555806*^9}, 3.8271215073456097`*^9, 
   3.827121570988007*^9, 3.82712340478117*^9, 3.827123493273857*^9, {
   3.827123641579629*^9, 3.8271237070381317`*^9}, 3.8271237446080437`*^9, 
   3.827128609656829*^9, 3.827130011128631*^9, {3.827130075532077*^9, 
   3.827130114934783*^9}, {3.827130336633399*^9, 3.827130380694624*^9}, 
   3.827130437428034*^9, 3.8274620993482027`*^9, 3.827463184076758*^9, 
   3.827463215853591*^9, 3.827463319706438*^9, 3.827463390390669*^9, 
   3.827463545672922*^9, {3.8274641559702663`*^9, 3.827464248079277*^9}, 
   3.827464296715806*^9, {3.827464533717277*^9, 3.827464541894849*^9}, {
   3.827464661082355*^9, 3.827464744858498*^9}, 3.827464788522318*^9, 
   3.827464938820225*^9, 3.827465061155341*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"165c1743-9eef-48da-aabd-406377ed18d9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739191918773426*^9, 3.7391919474254847`*^9}, 
   3.739192016970253*^9, 3.7391921795444736`*^9, 3.739192220074863*^9, 
   3.739192593819646*^9, {3.739248292736579*^9, 3.7392483358693113`*^9}, 
   3.7392485174560823`*^9, 3.739253393260054*^9, 3.739254803921524*^9, 
   3.739265470006442*^9, {3.739269331660367*^9, 3.739269391856285*^9}, 
   3.739269988069709*^9, 3.739350794158577*^9, 3.739352322238062*^9, 
   3.739380073580723*^9, 3.739380447796873*^9, 3.739380500640584*^9, 
   3.739520718561228*^9, 3.739520867457431*^9, 3.739601327943862*^9, 
   3.7396088746806097`*^9, 3.7396090251462317`*^9, 3.739609068033861*^9, 
   3.739609141669112*^9, 3.741676888177842*^9, 3.742034889083928*^9, 
   3.742036789406859*^9, 3.742036924064384*^9, 3.74203720106221*^9, 
   3.742037410444983*^9, 3.742037744714534*^9, 3.742040629600938*^9, 
   3.742040661417543*^9, 3.742040786232317*^9, 3.742041532932399*^9, 
   3.742041776056471*^9, {3.7420418258047867`*^9, 3.742041844424859*^9}, 
   3.7420418846839523`*^9, 3.7420424223339567`*^9, 3.742042687265203*^9, 
   3.742042839178175*^9, {3.742042928083497*^9, 3.7420429570560923`*^9}, 
   3.742042996567133*^9, 3.7420430741752253`*^9, 3.742043231266521*^9, {
   3.742043567611817*^9, 3.742043620174058*^9}, 3.742043735032089*^9, 
   3.7420439166040688`*^9, 3.7420440594312696`*^9, {3.742044130561182*^9, 
   3.7420441555475197`*^9}, {3.742044299510275*^9, 3.7420443445369587`*^9}, 
   3.742044396704689*^9, 3.7420449230538177`*^9, 3.827120420152348*^9, 
   3.827120949102167*^9, {3.8271210195861998`*^9, 3.827121094501639*^9}, {
   3.8271213418167963`*^9, 3.827121434555806*^9}, 3.8271215073456097`*^9, 
   3.827121570988007*^9, 3.82712340478117*^9, 3.827123493273857*^9, {
   3.827123641579629*^9, 3.8271237070381317`*^9}, 3.8271237446080437`*^9, 
   3.827128609656829*^9, 3.827130011128631*^9, {3.827130075532077*^9, 
   3.827130114934783*^9}, {3.827130336633399*^9, 3.827130380694624*^9}, 
   3.827130437428034*^9, 3.8274620993482027`*^9, 3.827463184076758*^9, 
   3.827463215853591*^9, 3.827463319706438*^9, 3.827463390390669*^9, 
   3.827463545672922*^9, {3.8274641559702663`*^9, 3.827464248079277*^9}, 
   3.827464296715806*^9, {3.827464533717277*^9, 3.827464541894849*^9}, {
   3.827464661082355*^9, 3.827464744858498*^9}, 3.827464788522318*^9, 
   3.827464938820225*^9, 3.827465061480092*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"8bd071fb-cf37-4d7d-b77e-24e6291476da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.739191918773426*^9, 3.7391919474254847`*^9}, 
   3.739192016970253*^9, 3.7391921795444736`*^9, 3.739192220074863*^9, 
   3.739192593819646*^9, {3.739248292736579*^9, 3.7392483358693113`*^9}, 
   3.7392485174560823`*^9, 3.739253393260054*^9, 3.739254803921524*^9, 
   3.739265470006442*^9, {3.739269331660367*^9, 3.739269391856285*^9}, 
   3.739269988069709*^9, 3.739350794158577*^9, 3.739352322238062*^9, 
   3.739380073580723*^9, 3.739380447796873*^9, 3.739380500640584*^9, 
   3.739520718561228*^9, 3.739520867457431*^9, 3.739601327943862*^9, 
   3.7396088746806097`*^9, 3.7396090251462317`*^9, 3.739609068033861*^9, 
   3.739609141669112*^9, 3.741676888177842*^9, 3.742034889083928*^9, 
   3.742036789406859*^9, 3.742036924064384*^9, 3.74203720106221*^9, 
   3.742037410444983*^9, 3.742037744714534*^9, 3.742040629600938*^9, 
   3.742040661417543*^9, 3.742040786232317*^9, 3.742041532932399*^9, 
   3.742041776056471*^9, {3.7420418258047867`*^9, 3.742041844424859*^9}, 
   3.7420418846839523`*^9, 3.7420424223339567`*^9, 3.742042687265203*^9, 
   3.742042839178175*^9, {3.742042928083497*^9, 3.7420429570560923`*^9}, 
   3.742042996567133*^9, 3.7420430741752253`*^9, 3.742043231266521*^9, {
   3.742043567611817*^9, 3.742043620174058*^9}, 3.742043735032089*^9, 
   3.7420439166040688`*^9, 3.7420440594312696`*^9, {3.742044130561182*^9, 
   3.7420441555475197`*^9}, {3.742044299510275*^9, 3.7420443445369587`*^9}, 
   3.742044396704689*^9, 3.7420449230538177`*^9, 3.827120420152348*^9, 
   3.827120949102167*^9, {3.8271210195861998`*^9, 3.827121094501639*^9}, {
   3.8271213418167963`*^9, 3.827121434555806*^9}, 3.8271215073456097`*^9, 
   3.827121570988007*^9, 3.82712340478117*^9, 3.827123493273857*^9, {
   3.827123641579629*^9, 3.8271237070381317`*^9}, 3.8271237446080437`*^9, 
   3.827128609656829*^9, 3.827130011128631*^9, {3.827130075532077*^9, 
   3.827130114934783*^9}, {3.827130336633399*^9, 3.827130380694624*^9}, 
   3.827130437428034*^9, 3.8274620993482027`*^9, 3.827463184076758*^9, 
   3.827463215853591*^9, 3.827463319706438*^9, 3.827463390390669*^9, 
   3.827463545672922*^9, {3.8274641559702663`*^9, 3.827464248079277*^9}, 
   3.827464296715806*^9, {3.827464533717277*^9, 3.827464541894849*^9}, {
   3.827464661082355*^9, 3.827464744858498*^9}, 3.827464788522318*^9, 
   3.827464938820225*^9, 3.8274650614827337`*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"36a296ab-0180-4dc0-88df-38a6c7fe93c1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["T", "TT"], 
  TraditionalForm]],ExpressionUUID->"a47e45be-52e1-4e4e-b04d-528054505a06"]], \
"Subsubsection",
 CellChangeTimes->{{3.7420421518929033`*^9, 
  3.742042152869845*^9}},ExpressionUUID->"23029a31-a8e5-4175-8b26-\
973c569567a8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Tr", "[", 
  RowBox[{"gUU", ".", 
   SubscriptBox["T", "TT"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"covDiv", "[", 
  RowBox[{
   RowBox[{"gUU", ".", 
    SubscriptBox["T", "TT"]}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d2Tensor", "[", 
     SubscriptBox["T", "TT"], "]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "2"], "-", " ", 
       RowBox[{"2", " ", "K"}]}], " ", ")"}], 
     SubscriptBox["T", "TT"]}]}], "/.", "PTrule"}], "//", 
  "Simplify"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.742042171348708*^9, 3.742042234668714*^9}, {
   3.742042326828485*^9, 3.74204233830652*^9}, 3.827120313356832*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"0466b573-0c7d-4ba3-9563-ccbc927d5af1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7420421825857487`*^9, {3.742042218282956*^9, 3.74204223495362*^9}, {
   3.742042318504744*^9, 3.74204233857964*^9}, 3.742042422934533*^9, 
   3.742042687748126*^9, 3.7420428396855383`*^9, {3.742042928534618*^9, 
   3.7420429579574738`*^9}, 3.742042997603422*^9, 3.7420430757603207`*^9, 
   3.742043232340493*^9, {3.742043568109839*^9, 3.742043621258047*^9}, 
   3.7420437366030273`*^9, 3.742043917506392*^9, 3.742044060610736*^9, {
   3.742044131164332*^9, 3.7420441561910067`*^9}, 3.742044234383621*^9, {
   3.7420442999685287`*^9, 3.742044345583963*^9}, 3.742044398321287*^9, 
   3.742044923244117*^9, 3.742044954143014*^9, 3.827120421173319*^9, 
   3.827120949600052*^9, {3.827121020062983*^9, 3.827121095718177*^9}, {
   3.8271213421711082`*^9, 3.827121435857122*^9}, 3.8271215098637543`*^9, 
   3.827121576502926*^9, 3.827123410219961*^9, 3.827123495625368*^9, {
   3.827123642887814*^9, 3.827123707396637*^9}, 3.827123745737492*^9, 
   3.827128610261125*^9, 3.8271300117797737`*^9, {3.827130076162232*^9, 
   3.827130115432823*^9}, {3.827130337547742*^9, 3.827130353107629*^9}, 
   3.827130383180326*^9, 3.827130442866096*^9, 3.827462099544105*^9, {
   3.827463187445764*^9, 3.827463216074399*^9}, 3.827463320123849*^9, 
   3.8274633907199917`*^9, 3.8274635457159643`*^9, {3.8274641560961027`*^9, 
   3.827464250388337*^9}, 3.827464301611126*^9, {3.8274645339511137`*^9, 
   3.827464542242777*^9}, {3.827464661531015*^9, 3.8274647471246*^9}, 
   3.827464793427363*^9, 3.82746493901589*^9, 3.827465061488858*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"58320289-76ba-4e7f-a1f4-ff6d19c5077f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7420421825857487`*^9, {3.742042218282956*^9, 3.74204223495362*^9}, {
   3.742042318504744*^9, 3.74204233857964*^9}, 3.742042422934533*^9, 
   3.742042687748126*^9, 3.7420428396855383`*^9, {3.742042928534618*^9, 
   3.7420429579574738`*^9}, 3.742042997603422*^9, 3.7420430757603207`*^9, 
   3.742043232340493*^9, {3.742043568109839*^9, 3.742043621258047*^9}, 
   3.7420437366030273`*^9, 3.742043917506392*^9, 3.742044060610736*^9, {
   3.742044131164332*^9, 3.7420441561910067`*^9}, 3.742044234383621*^9, {
   3.7420442999685287`*^9, 3.742044345583963*^9}, 3.742044398321287*^9, 
   3.742044923244117*^9, 3.742044954143014*^9, 3.827120421173319*^9, 
   3.827120949600052*^9, {3.827121020062983*^9, 3.827121095718177*^9}, {
   3.8271213421711082`*^9, 3.827121435857122*^9}, 3.8271215098637543`*^9, 
   3.827121576502926*^9, 3.827123410219961*^9, 3.827123495625368*^9, {
   3.827123642887814*^9, 3.827123707396637*^9}, 3.827123745737492*^9, 
   3.827128610261125*^9, 3.8271300117797737`*^9, {3.827130076162232*^9, 
   3.827130115432823*^9}, {3.827130337547742*^9, 3.827130353107629*^9}, 
   3.827130383180326*^9, 3.827130442866096*^9, 3.827462099544105*^9, {
   3.827463187445764*^9, 3.827463216074399*^9}, 3.827463320123849*^9, 
   3.8274633907199917`*^9, 3.8274635457159643`*^9, {3.8274641560961027`*^9, 
   3.827464250388337*^9}, 3.827464301611126*^9, {3.8274645339511137`*^9, 
   3.827464542242777*^9}, {3.827464661531015*^9, 3.8274647471246*^9}, 
   3.827464793427363*^9, 3.82746493901589*^9, 3.827465061491075*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"0c929ac2-38b8-4559-8271-8574e9bce255"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7420421825857487`*^9, {3.742042218282956*^9, 3.74204223495362*^9}, {
   3.742042318504744*^9, 3.74204233857964*^9}, 3.742042422934533*^9, 
   3.742042687748126*^9, 3.7420428396855383`*^9, {3.742042928534618*^9, 
   3.7420429579574738`*^9}, 3.742042997603422*^9, 3.7420430757603207`*^9, 
   3.742043232340493*^9, {3.742043568109839*^9, 3.742043621258047*^9}, 
   3.7420437366030273`*^9, 3.742043917506392*^9, 3.742044060610736*^9, {
   3.742044131164332*^9, 3.7420441561910067`*^9}, 3.742044234383621*^9, {
   3.7420442999685287`*^9, 3.742044345583963*^9}, 3.742044398321287*^9, 
   3.742044923244117*^9, 3.742044954143014*^9, 3.827120421173319*^9, 
   3.827120949600052*^9, {3.827121020062983*^9, 3.827121095718177*^9}, {
   3.8271213421711082`*^9, 3.827121435857122*^9}, 3.8271215098637543`*^9, 
   3.827121576502926*^9, 3.827123410219961*^9, 3.827123495625368*^9, {
   3.827123642887814*^9, 3.827123707396637*^9}, 3.827123745737492*^9, 
   3.827128610261125*^9, 3.8271300117797737`*^9, {3.827130076162232*^9, 
   3.827130115432823*^9}, {3.827130337547742*^9, 3.827130353107629*^9}, 
   3.827130383180326*^9, 3.827130442866096*^9, 3.827462099544105*^9, {
   3.827463187445764*^9, 3.827463216074399*^9}, 3.827463320123849*^9, 
   3.8274633907199917`*^9, 3.8274635457159643`*^9, {3.8274641560961027`*^9, 
   3.827464250388337*^9}, 3.827464301611126*^9, {3.8274645339511137`*^9, 
   3.827464542242777*^9}, {3.827464661531015*^9, 3.8274647471246*^9}, 
   3.827464793427363*^9, 3.82746493901589*^9, 3.82746506149303*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"b234d5a8-ed8d-4197-888e-721314b63562"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Build final metric, according to A.14", "Chapter",
 CellChangeTimes->{{3.7391905993014812`*^9, 3.739190600950588*^9}, 
   3.827464028584909*^9},ExpressionUUID->"b1d293e9-f168-4e28-9a27-\
36120733388c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zeroes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "+", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"n", "+", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtdt", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"dtdt", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtdr", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"dtdr", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{
    RowBox[{"dtdr", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdr", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"drdr", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtdx", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"dtdx", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{
    RowBox[{"dtdx", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtdz", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"dtdz", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{
    RowBox[{"dtdz", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], "=", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdx", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"drdx", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{
    RowBox[{"drdx", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdz", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"drdz", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", 
     RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{
    RowBox[{"drdz", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "=", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"\[CapitalOmega]", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"3", ";;"}], ",", 
     RowBox[{"3", ";;"}]}], "\[RightDoubleBracket]"}], "=", "gdd"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8271287430499287`*^9, 3.827128847373703*^9}, {
  3.827128932870489*^9, 3.8271290207339983`*^9}, {3.8271290914460087`*^9, 
  3.827129107704266*^9}, {3.8274620080481863`*^9, 3.827462011949993*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"d6b30fc0-348b-45d1-9cb1-6e3ad172ff60"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gFull1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["h", "tt"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "dtdt"}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", "tr"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "dtdr"}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", "rr"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "drdr"}], "+", 
       RowBox[{
        FractionBox["1", "n"], 
        RowBox[{
         SubscriptBox["h", "+"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "\[CapitalOmega]"}]}], ")"}], "P0"}],
     "+", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["h", "tx"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "dtdx"}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", "rx"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "drdx"}]}], ")"}], 
     RowBox[{"Vp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["h", "tz"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "dtdz"}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", "rz"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "drdz"}]}], ")"}], 
     RowBox[{"Va", "\[LeftDoubleBracket]", 
      RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gFull2", "=", "zeroes"}], ";", 
  RowBox[{
   RowBox[{"gFull2", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"3", ";;"}], ",", 
     RowBox[{"3", ";;"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{
        SubscriptBox["h", "-"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], 
       SubscriptBox["T", "LL"]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "xz"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], 
       SubscriptBox["T", "LT"]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "yz"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], 
       SubscriptBox["T", "TT"]}]}], ")"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gFull", "=", 
   RowBox[{"gFull1", "+", "gFull2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gFull", "//", "MatrixForm"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8271288503309383`*^9, 3.827128928547709*^9}, {
  3.8271291132990093`*^9, 3.827129174961623*^9}, {3.827129212637062*^9, 
  3.827129230048612*^9}, {3.827129298715248*^9, 3.827129388581118*^9}, {
  3.827129817636698*^9, 3.82712983139123*^9}, {3.827129864067325*^9, 
  3.827129864636594*^9}, {3.827129896306115*^9, 3.827129899513097*^9}, {
  3.8271299818522673`*^9, 3.827129982496387*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"37290991-ff63-4d9e-8b16-7426f7448129"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"P", "[", "u", "]"}], " ", 
       RowBox[{
        SubscriptBox["h", "tt"], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"P", "[", "u", "]"}], " ", 
       RowBox[{
        SubscriptBox["h", "tr"], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "tx"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["P", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], "0", 
      RowBox[{
       RowBox[{"PV", "[", "u", "]"}], " ", 
       RowBox[{
        SubscriptBox["h", "tz"], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"P", "[", "u", "]"}], " ", 
       RowBox[{
        SubscriptBox["h", "tr"], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"P", "[", "u", "]"}], " ", 
       RowBox[{
        SubscriptBox["h", "rr"], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "rx"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["P", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], "0", 
      RowBox[{
       RowBox[{"PV", "[", "u", "]"}], " ", 
       RowBox[{
        SubscriptBox["h", "rz"], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["h", "tx"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["P", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "rx"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["P", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"P", "[", "u", "]"}], " ", 
         RowBox[{
          SubscriptBox["h", "+"], "[", 
          RowBox[{"t", ",", "r"}], "]"}]}], 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"K", " ", 
            SuperscriptBox["u", "2"]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{
          SubscriptBox["h", "-"], "[", 
          RowBox[{"t", ",", "r"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["k", "2"], " ", 
            RowBox[{"P", "[", "u", "]"}]}], "-", 
           RowBox[{"3", " ", "K", " ", "u", " ", 
            RowBox[{
             SuperscriptBox["P", "\[Prime]",
              MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"3", " ", "K", " ", 
          SuperscriptBox["u", "2"]}]}]]}], "0", 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "xz"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "K", " ", "u", " ", 
            RowBox[{"PV", "[", "u", "]"}]}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"K", " ", 
             SuperscriptBox["u", "2"]}]}]]}], "+", 
         RowBox[{
          SuperscriptBox["PV", "\[Prime]",
           MultilineFunction->None], "[", "u", "]"}]}], ")"}]}]},
     {"0", "0", "0", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"K", " ", 
            SuperscriptBox["u", "2"]}]}], ")"}], " ", 
         RowBox[{"P", "[", "u", "]"}], " ", 
         RowBox[{
          SubscriptBox["h", "+"], "[", 
          RowBox[{"t", ",", "r"}], "]"}]}], 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"K", " ", 
            SubsuperscriptBox["\[Theta]", "2", "2"]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"K", " ", 
            SuperscriptBox["u", "2"]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["h", "-"], "[", 
          RowBox[{"t", ",", "r"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], " ", 
            RowBox[{"P", "[", "u", "]"}]}], "+", 
           RowBox[{"3", " ", "K", " ", "u", " ", 
            RowBox[{
             SuperscriptBox["P", "\[Prime]",
              MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}], 
        RowBox[{"3", "-", 
         RowBox[{"3", " ", "K", " ", 
          SubsuperscriptBox["\[Theta]", "2", "2"]}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "K", " ", 
         RowBox[{"PV", "[", "u", "]"}], " ", 
         SubscriptBox["\[Theta]", "2"], " ", 
         RowBox[{
          SubscriptBox["h", "xz"], "[", 
          RowBox[{"t", ",", "r"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"PT", "[", "u", "]"}], " ", 
         RowBox[{
          SubscriptBox["h", "yz"], "[", 
          RowBox[{"t", ",", "r"}], "]"}]}]}], 
       RowBox[{"1", "-", 
        RowBox[{"K", " ", 
         SubsuperscriptBox["\[Theta]", "2", "2"]}]}]]},
     {
      RowBox[{
       RowBox[{"PV", "[", "u", "]"}], " ", 
       RowBox[{
        SubscriptBox["h", "tz"], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"PV", "[", "u", "]"}], " ", 
       RowBox[{
        SubscriptBox["h", "rz"], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "xz"], "[", 
        RowBox[{"t", ",", "r"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "K", " ", "u", " ", 
            RowBox[{"PV", "[", "u", "]"}]}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"K", " ", 
             SuperscriptBox["u", "2"]}]}]]}], "+", 
         RowBox[{
          SuperscriptBox["PV", "\[Prime]",
           MultilineFunction->None], "[", "u", "]"}]}], ")"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "K", " ", 
         RowBox[{"PV", "[", "u", "]"}], " ", 
         SubscriptBox["\[Theta]", "2"], " ", 
         RowBox[{
          SubscriptBox["h", "xz"], "[", 
          RowBox[{"t", ",", "r"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"PT", "[", "u", "]"}], " ", 
         RowBox[{
          SubscriptBox["h", "yz"], "[", 
          RowBox[{"t", ",", "r"}], "]"}]}]}], 
       RowBox[{"1", "-", 
        RowBox[{"K", " ", 
         SubsuperscriptBox["\[Theta]", "2", "2"]}]}]], 
      RowBox[{
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"K", " ", 
           SuperscriptBox["u", "2"]}]}], ")"}], " ", 
        RowBox[{"P", "[", "u", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"K", " ", 
           SubsuperscriptBox["\[Theta]", "2", "2"]}]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["h", "+"], "[", 
         RowBox[{"t", ",", "r"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"K", " ", 
           SuperscriptBox["u", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"K", " ", 
           SubsuperscriptBox["\[Theta]", "2", "2"]}]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["h", "-"], "[", 
         RowBox[{"t", ",", "r"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k", "2"], " ", 
           RowBox[{"P", "[", "u", "]"}]}], "-", 
          RowBox[{"3", " ", "K", " ", "u", " ", 
           RowBox[{
            SuperscriptBox["P", "\[Prime]",
             MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.827129347415106*^9, {3.827129380608995*^9, 3.827129389316022*^9}, 
   3.8271294284640207`*^9, 3.827130012013249*^9, {3.827130076377193*^9, 
   3.8271301156048803`*^9}, {3.827130338197267*^9, 3.827130353406262*^9}, 
   3.8271303917808723`*^9, 3.8271304439919357`*^9, 3.827462099690907*^9, {
   3.827463187649547*^9, 3.82746321619223*^9}, 3.827463320413369*^9, 
   3.827463390864945*^9, 3.827463545880905*^9, {3.827464156167542*^9, 
   3.82746422065773*^9}, 3.8274642581895437`*^9, 3.827464302526045*^9, {
   3.8274645340607643`*^9, 3.827464542417323*^9}, {3.827464661622666*^9, 
   3.827464747371923*^9}, 3.827464793713951*^9, 3.827464939065617*^9, 
   3.827465061602725*^9},
 CellLabel->
  "Out[121]//MatrixForm=",ExpressionUUID->"0e68a295-5f1a-4b04-92dd-\
603edbdfd39c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["rules for scalar functions entering above", "Section",
 CellChangeTimes->{{3.827464048019228*^9, 
  3.827464055623817*^9}},ExpressionUUID->"12fe6a4f-096c-4fd9-9816-\
60ef83da4210"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleRules", "=", 
   RowBox[{
   "Prule", "~", "Join", "~", "PVrule", "~", "Join", "~", "PTrule"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"angleRulesGeneral", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["P", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "u", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["k", "2"]}], " ", 
         RowBox[{"P", "[", "u", "]"}]}], "+", 
        RowBox[{"n", " ", "u", " ", "K", " ", 
         RowBox[{
          SuperscriptBox["P", "\[Prime]",
           MultilineFunction->None], "[", "u", "]"}]}]}], 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox["u", "2"], " ", "K"}]}]]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["PV", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "u", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox["k", "2"], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             SuperscriptBox["u", "2"], " ", "K"}]}]], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "2"}], ")"}], 
           FractionBox[
            RowBox[{" ", "K"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", "K"}]}]]}]}], ")"}], " ", 
        RowBox[{"PV", "[", "u", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], 
        FractionBox[
         RowBox[{" ", 
          RowBox[{"u", " ", "K", " ", 
           RowBox[{
            SuperscriptBox["PV", "\[Prime]",
             MultilineFunction->None], "[", "u", "]"}]}]}], 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", "K"}]}]]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["PT", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "u", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "K", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "-", "3"}], ")"}], " ", 
                SuperscriptBox["u", "2"], " ", "K"}]}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                SuperscriptBox["u", "2"], " ", "K"}]}], ")"}], "2"]]}], "+", 
          FractionBox[
           SuperscriptBox["k", "2"], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             SuperscriptBox["u", "2"], " ", "K"}]}]]}], ")"}], " ", 
        RowBox[{"PT", "[", "u", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "4"}], ")"}], 
        FractionBox[
         RowBox[{"u", " ", "K", " ", 
          RowBox[{
           SuperscriptBox["PT", "\[Prime]",
            MultilineFunction->None], "[", "u", "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", "K"}]}]]}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "''"}], "[", "u", "]"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["V", "1"], "''"}], "[", "u", "]"}], ",", 
     RowBox[{
      RowBox[{"PT", "''"}], "[", "u", "]"}]}], "}"}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "/.", "angleRules"}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"#", "/.", "angleRulesGeneral"}], ")"}]}], "&"}]}], "//", 
  "Simplify"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739191552567651*^9, 3.7391915583049088`*^9}, 
   3.7391915905211782`*^9, 3.739192351720695*^9, {3.739248340386223*^9, 
   3.739248350644758*^9}, {3.742042393401739*^9, 3.742042406098597*^9}, {
   3.742042862441091*^9, 3.742042864689958*^9}, 3.7420432136308107`*^9, {
   3.7420446402619*^9, 3.7420447310810337`*^9}, {3.827120318645186*^9, 
   3.827120326077854*^9}, {3.827464059540352*^9, 3.8274640636461277`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"05c62a0a-6c74-4e3e-9b7b-86b2c09c2ff0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8274641562421513`*^9, 3.8274642206856422`*^9}, 
   3.8274642582190847`*^9, 3.827464302559615*^9, {3.827464534122624*^9, 
   3.8274645424746923`*^9}, {3.827464661672213*^9, 3.827464747402877*^9}, 
   3.827464793743662*^9, 3.8274649391633863`*^9, 3.827465061639579*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"d44ad128-b493-4ffc-b026-1d5499f820cf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Save", "Section",
 CellChangeTimes->{{3.8271206202195168`*^9, 
  3.8271206206133003`*^9}},ExpressionUUID->"71f22420-829f-4eda-bb67-\
18067b7f7f63"],

Cell[CellGroupData[{

Cell["if it already exists, check equality", "Subsubsection",
 CellChangeTimes->{{3.827120822387205*^9, 3.827120827137579*^9}, {
  3.827120976436941*^9, 
  3.827120990590623*^9}},ExpressionUUID->"f84cf814-a5ab-4d15-93d7-\
1eca3df6a32e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"metricFluctuations", "=", 
   RowBox[{"<<", "\"\<metricFluctuations\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"Not", "@", 
    RowBox[{"IntegerQ", "@", 
     RowBox[{
     "metricFluctuations", "\[LeftDoubleBracket]", "n", 
      "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "\[Equal]", "0"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"gFull", "-", 
         RowBox[{
         "metricFluctuations", "\[LeftDoubleBracket]", "n", 
          "\[RightDoubleBracket]"}]}], "//", "Simplify"}], "//", "Flatten"}], 
      "//", "DeleteDuplicates"}], ")"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827120832810596*^9, 3.827120891567403*^9}, {
  3.827120969644683*^9, 3.827120973715662*^9}, {3.827130061536195*^9, 
  3.827130068077952*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"a0e18c5f-b9bc-48dc-b21a-b475b63095f9"],

Cell[BoxData[
 RowBox[{"{", "True", "}"}]], "Output",
 CellChangeTimes->{3.827465061676516*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"f2b7f973-9e40-483c-b7a2-48ca67db3a9a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["If it doesn\[CloseCurlyQuote]t exist, save", "Subsubsection",
 CellChangeTimes->{{3.827120769229424*^9, 
  3.827120781750801*^9}},ExpressionUUID->"2a6edc6c-773c-4eec-ae33-\
48cf39a2aa33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IntegerQ", "@", 
     RowBox[{
     "metricFluctuations", "\[LeftDoubleBracket]", "n", 
      "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "metricFluctuations", "\[LeftDoubleBracket]", "n", 
       "\[RightDoubleBracket]"}], "=", "gFull"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"metricFluctuations", ">>", "\"\<metricFluctuations\>\""}]}]}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827120664593937*^9, 3.827120678372592*^9}, {
  3.827120764486208*^9, 3.8271208161216516`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"0fd4aabd-25cb-444c-a153-8d4425ca6dac"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1040},
WindowMargins->{{1680, Automatic}, {822, Automatic}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1912c4a6-0c3a-4db0-8eac-ece2a54e5e9b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 166, 3, 98, "Title",ExpressionUUID->"e5813202-3d5a-41ae-a402-5ba051bea5f8"],
Cell[CellGroupData[{
Cell[771, 29, 178, 4, 62, "Section",ExpressionUUID->"16b7694d-4b10-4f4f-a984-10933a13e5e1"],
Cell[952, 35, 101820, 2827, 5730, "Input",ExpressionUUID->"7430500c-6483-4a45-9e10-3790e4b4aa57",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[102809, 2867, 162, 3, 58, "Chapter",ExpressionUUID->"43b43ced-02d5-44f2-ab23-6464cbfe9bd5"],
Cell[102974, 2872, 3999, 58, 46, "Input",ExpressionUUID->"a89ee3fe-f6c1-4275-bdb8-6549be91eec4",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[106998, 2934, 153, 3, 65, "Subchapter",ExpressionUUID->"2f23f6d7-5d4f-43f0-8e92-18ad6574da54"],
Cell[CellGroupData[{
Cell[107176, 2941, 170, 3, 67, "Section",ExpressionUUID->"d31f65e8-5024-447b-af79-dd497c203c54"],
Cell[107349, 2946, 685, 17, 89, "Input",ExpressionUUID->"5ffac865-eab2-4938-90d8-b6748116a566",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[108071, 2968, 157, 3, 67, "Section",ExpressionUUID->"b1a920a6-22e6-4878-8453-d345d28b0b65"],
Cell[CellGroupData[{
Cell[108253, 2975, 164, 3, 45, "Subsubsection",ExpressionUUID->"63dab14b-9bd7-4ad4-b5c4-d074afe7f3d1"],
Cell[108420, 2980, 671, 16, 68, "Input",ExpressionUUID->"82e705d8-7694-4f07-b70f-5845a45d6c2a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[109128, 3001, 157, 3, 45, "Subsubsection",ExpressionUUID->"d6e3be46-244e-4783-8449-fa6e8634d5f7"],
Cell[CellGroupData[{
Cell[109310, 3008, 1481, 41, 137, "Input",ExpressionUUID->"eebbf521-242a-4047-903f-c23dd564d0c8",
 InitializationCell->True],
Cell[110794, 3051, 2746, 40, 34, "Output",ExpressionUUID->"67b22208-b144-448e-9d4a-044004d9c55e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113589, 3097, 173, 3, 45, "Subsubsection",ExpressionUUID->"a02ff963-32f4-4df5-b444-ffeaa6d0e4e4"],
Cell[CellGroupData[{
Cell[113787, 3104, 845, 21, 86, "Input",ExpressionUUID->"b2a6e114-de99-4ed4-b135-431d807df787",
 InitializationCell->True],
Cell[114635, 3127, 2753, 39, 34, "Output",ExpressionUUID->"18034e26-cb8c-48aa-8a8e-483da7fc5b72"],
Cell[117391, 3168, 2697, 37, 34, "Output",ExpressionUUID->"9b0b4e5b-a918-4c0c-a505-a849bd3f9252"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[120149, 3212, 160, 3, 67, "Section",ExpressionUUID->"91dfc4f1-02dd-4b2a-b06c-d0f62b9a6839"],
Cell[CellGroupData[{
Cell[120334, 3219, 161, 3, 45, "Subsubsection",ExpressionUUID->"5fb54085-44bc-478f-9185-710a9b21453d"],
Cell[CellGroupData[{
Cell[120520, 3226, 1398, 40, 162, "Input",ExpressionUUID->"485a5346-4d4d-4e9c-bb55-ba42ed9518ae",
 InitializationCell->True],
Cell[121921, 3268, 1437, 29, 37, "Output",ExpressionUUID->"967d626c-1de3-4c63-af52-795ffaaab658"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123407, 3303, 159, 3, 45, "Subsubsection",ExpressionUUID->"424b0e80-1eb7-4b7c-ad46-bf21e7c137f0"],
Cell[CellGroupData[{
Cell[123591, 3310, 398, 9, 46, "Input",ExpressionUUID->"eff33e32-74ed-46da-9e44-a352eaf66f55",
 InitializationCell->True],
Cell[123992, 3321, 1470, 30, 37, "Output",ExpressionUUID->"83053785-9f1e-4e1e-94f1-93194c53ef3c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125511, 3357, 159, 3, 45, "Subsubsection",ExpressionUUID->"e74be2dc-e595-4658-9bb1-bc196a3308d9"],
Cell[CellGroupData[{
Cell[125695, 3364, 1647, 52, 68, "Input",ExpressionUUID->"335836a3-b93b-4405-925c-5d717d4f83f2",
 InitializationCell->True],
Cell[127345, 3418, 3197, 57, 55, "Output",ExpressionUUID->"0c317c7d-4b5b-4aeb-a282-e79d87ebd78c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130579, 3480, 234, 4, 30, "Input",ExpressionUUID->"be68aea0-6bba-4eb8-8a29-7b330d49603c"],
Cell[130816, 3486, 919, 26, 55, "Output",ExpressionUUID->"9c70808c-bbe6-4448-be14-c363e1d18c6e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131808, 3520, 167, 3, 65, "Subchapter",ExpressionUUID->"47be451c-5626-4df3-84b7-5425a845a685"],
Cell[CellGroupData[{
Cell[132000, 3527, 152, 3, 67, "Section",ExpressionUUID->"efe34e0c-7db7-4116-a2d3-de2b51f6fe6c"],
Cell[CellGroupData[{
Cell[132177, 3534, 158, 3, 45, "Subsubsection",ExpressionUUID->"1e442c5d-702b-42b6-be22-7f7d98273997"],
Cell[CellGroupData[{
Cell[132360, 3541, 263, 7, 46, "Input",ExpressionUUID->"3436c4d5-7524-4d82-8261-f857208cacb1",
 InitializationCell->True],
Cell[132626, 3550, 2689, 41, 34, "Output",ExpressionUUID->"b49091ff-13be-4e48-9b63-e01df32d6579"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135364, 3597, 158, 3, 45, "Subsubsection",ExpressionUUID->"32881243-7855-47d6-bfd0-885684ed56c5"],
Cell[135525, 3602, 2423, 67, 114, "Input",ExpressionUUID->"a3fc6f1c-54d4-4802-8755-b2c90301a1f6",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[137973, 3673, 1901, 54, 154, "Input",ExpressionUUID->"7e0d3ead-1270-4a59-834f-287f1f49b84b",
 InitializationCell->True],
Cell[139877, 3729, 2699, 39, 34, "Output",ExpressionUUID->"47055e43-bb96-440b-bd97-93a3b6647029"],
Cell[142579, 3770, 2616, 36, 34, "Output",ExpressionUUID->"2ddb28a7-46ca-4742-a44c-b0d4a8834bfe"],
Cell[145198, 3808, 3296, 58, 37, "Output",ExpressionUUID->"c2e61dc1-0b69-4b62-9d7c-d04182fb6d78"],
Cell[148497, 3868, 3242, 57, 37, "Output",ExpressionUUID->"9fe61352-f986-4596-8447-97e464d7cc17"],
Cell[151742, 3927, 3457, 65, 57, "Output",ExpressionUUID->"4d2c6d0e-e827-432f-8b95-0e8f8c004516"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[155260, 3999, 152, 3, 67, "Section",ExpressionUUID->"4d040f79-025a-4e1c-bc60-bed1b04e59e8"],
Cell[155415, 4004, 887, 26, 68, "Input",ExpressionUUID->"9e5ca562-fe07-457c-94c7-3983f32026e2",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[156327, 4034, 215, 4, 54, "Subsection",ExpressionUUID->"8353f9a8-1df0-4541-b3c1-e849284d4cfc"],
Cell[CellGroupData[{
Cell[156567, 4042, 2572, 69, 166, "Input",ExpressionUUID->"b22678c5-854a-4f31-a2da-c2ceba319630",
 InitializationCell->True],
Cell[159142, 4113, 671, 16, 38, "Output",ExpressionUUID->"e58f072a-73d9-43d4-843a-da29862e63be"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[159862, 4135, 207, 4, 54, "Subsection",ExpressionUUID->"a6e5a1c8-40bb-4f85-90f1-c1bb094c061b"],
Cell[160072, 4141, 631, 17, 46, "Input",ExpressionUUID->"dcd2e9c4-feb5-4d0c-89e3-1c3e662d93a9",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[160728, 4162, 267, 4, 45, "Subsubsection",ExpressionUUID->"d5e41aca-da6d-4bb0-a8c2-61fa994a1f8e"],
Cell[CellGroupData[{
Cell[161020, 4170, 2925, 84, 144, "Input",ExpressionUUID->"de68c0a4-7acb-48c8-a18d-81360728942f",
 InitializationCell->True],
Cell[163948, 4256, 1874, 48, 72, "Output",ExpressionUUID->"b1f09f83-2c5f-45a5-8dbc-42074d204bad"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[165883, 4311, 166, 3, 54, "Subsection",ExpressionUUID->"01735d95-6e57-4ed3-b61f-7a49150145b9"],
Cell[CellGroupData[{
Cell[166074, 4318, 289, 7, 44, "Subsubsection",ExpressionUUID->"30b80bf8-2de5-458d-a639-d10b8fbe6b23"],
Cell[CellGroupData[{
Cell[166388, 4329, 1003, 28, 108, "Input",ExpressionUUID->"dfa15620-e91f-43fc-8874-fe9f949a2fb7",
 InitializationCell->True],
Cell[167394, 4359, 2515, 35, 34, "Output",ExpressionUUID->"7c3f80c5-fd9e-42de-9f2a-a6f3903af951"],
Cell[169912, 4396, 2572, 37, 34, "Output",ExpressionUUID->"1c1cdc8f-2989-4242-88e6-025279688cde"],
Cell[172487, 4435, 2749, 43, 34, "Output",ExpressionUUID->"7bb20971-9c95-480a-bb5f-6ed9aa2e4eac"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[175285, 4484, 290, 7, 44, "Subsubsection",ExpressionUUID->"3e68c736-e697-449d-a1f3-28a240245b03"],
Cell[CellGroupData[{
Cell[175600, 4495, 1437, 42, 107, "Input",ExpressionUUID->"402d9b4a-b6e8-4bf4-b2de-09ae67167a22",
 InitializationCell->True],
Cell[177040, 4539, 2465, 35, 34, "Output",ExpressionUUID->"14a5f0b3-2f4f-4468-b2b8-0bb12ca984ef"],
Cell[179508, 4576, 2697, 43, 34, "Output",ExpressionUUID->"15ba80fe-a110-4795-9edd-69c7cba76afb"],
Cell[182208, 4621, 2522, 37, 34, "Output",ExpressionUUID->"ecf711fc-4c04-495f-8320-3a8d42a7390c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[184779, 4664, 288, 7, 44, "Subsubsection",ExpressionUUID->"a67209d6-62ef-4698-9409-15585578da00"],
Cell[CellGroupData[{
Cell[185092, 4675, 2592, 64, 93, "Input",ExpressionUUID->"9d167ed3-bdb6-4fd8-9930-c9b24178a5ac",
 InitializationCell->True],
Cell[187687, 4741, 2469, 35, 34, "Output",ExpressionUUID->"165c1743-9eef-48da-aabd-406377ed18d9"],
Cell[190159, 4778, 2701, 43, 34, "Output",ExpressionUUID->"8bd071fb-cf37-4d7d-b77e-24e6291476da"],
Cell[192863, 4823, 2526, 37, 34, "Output",ExpressionUUID->"36a296ab-0180-4dc0-88df-38a6c7fe93c1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[195438, 4866, 290, 7, 44, "Subsubsection",ExpressionUUID->"23029a31-a8e5-4175-8b26-973c569567a8"],
Cell[CellGroupData[{
Cell[195753, 4877, 854, 25, 91, "Input",ExpressionUUID->"0466b573-0c7d-4ba3-9563-ccbc927d5af1",
 InitializationCell->True],
Cell[196610, 4904, 1653, 24, 34, "Output",ExpressionUUID->"58320289-76ba-4e7f-a1f4-ff6d19c5077f"],
Cell[198266, 4930, 1708, 26, 34, "Output",ExpressionUUID->"0c929ac2-38b8-4559-8271-8574e9bce255"],
Cell[199977, 4958, 1884, 32, 34, "Output",ExpressionUUID->"b234d5a8-ed8d-4197-888e-721314b63562"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[201958, 5000, 207, 3, 69, "Chapter",ExpressionUUID->"b1d293e9-f168-4e28-9a27-36120733388c"],
Cell[202168, 5005, 3216, 86, 236, "Input",ExpressionUUID->"d6b30fc0-348b-45d1-9cb1-6e3ad172ff60",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[205409, 5095, 3027, 91, 145, "Input",ExpressionUUID->"37290991-ff63-4d9e-8b16-7426f7448129",
 InitializationCell->True],
Cell[208439, 5188, 9413, 276, 192, "Output",ExpressionUUID->"0e68a295-5f1a-4b04-92dd-603edbdfd39c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217889, 5469, 186, 3, 67, "Section",ExpressionUUID->"12fe6a4f-096c-4fd9-9816-60ef83da4210"],
Cell[CellGroupData[{
Cell[218100, 5476, 4473, 132, 244, "Input",ExpressionUUID->"05c62a0a-6c74-4e3e-9b7b-86b2c09c2ff0",
 InitializationCell->True],
Cell[222576, 5610, 456, 8, 34, "Output",ExpressionUUID->"d44ad128-b493-4ffc-b026-1d5499f820cf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[223081, 5624, 153, 3, 67, "Section",ExpressionUUID->"71f22420-829f-4eda-bb67-18067b7f7f63"],
Cell[CellGroupData[{
Cell[223259, 5631, 236, 4, 45, "Subsubsection",ExpressionUUID->"f84cf814-a5ab-4d15-93d7-1eca3df6a32e"],
Cell[CellGroupData[{
Cell[223520, 5639, 1061, 30, 110, "Input",ExpressionUUID->"a0e18c5f-b9bc-48dc-b21a-b475b63095f9",
 InitializationCell->True],
Cell[224584, 5671, 178, 4, 34, "Output",ExpressionUUID->"f2b7f973-9e40-483c-b7a2-48ca67db3a9a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[224811, 5681, 193, 3, 45, "Subsubsection",ExpressionUUID->"2a6edc6c-773c-4eec-ae33-48cf39a2aa33"],
Cell[225007, 5686, 739, 20, 89, "Input",ExpressionUUID->"0fd4aabd-25cb-444c-a153-8d4425ca6dac",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

